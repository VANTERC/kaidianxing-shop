(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[153],{"22c1":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-content-bar",[a("kdx-header-bar",{staticClass:"header"},[a("Button",{attrs:{type:"primary",disabled:e.noManagePerm},on:{click:function(t){e.isShow=!0}}},[e._v("+添加客服")]),a("Form",{ref:"form",staticClass:"form_wraps",attrs:{inline:"","label-width":120},nativeOn:{submit:function(e){e.preventDefault()}}},[a("FormItem",{attrs:{label:"客服名称：",prop:"service_name"}},[a("Input",{attrs:{type:"text",placeholder:"请输入客服名称"},on:{"on-enter":e.handleSearch},model:{value:e.service_name,callback:function(t){e.service_name=t},expression:"service_name"}})],1),a("div",{staticClass:"ivu-form-item-btn"},[a("Button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"content"},[a("div",{staticClass:"table-list"},[a("Table",{ref:"table",attrs:{columns:e.columns,data:e.data,loading:e.loading}})],1),a("div",{staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{current:e.page.page,total:e.total},on:{"on-change":e.handlePageChange}})],1)]),a("kdx-modal-frame",{attrs:{value:e.isShow,title:"创建客服",width:"700","ok-text":e.model.id?"保存":"创建","ok-cancel":"取消"},on:{"on-ok":e.save,"on-cancel":e.hide}},[a("div",{staticClass:"service_modal_wrap"},[a("Form",{ref:"form_modal",staticClass:"form_wraps",attrs:{model:e.model,rules:e.rules,inline:"","label-width":120}},[a("FormItem",{attrs:{label:"选择企业：",prop:"company_id"}},[a("Select",{staticClass:"width-500",model:{value:e.model.company_id,callback:function(t){e.$set(e.model,"company_id",t)},expression:"model.company_id"}},e._l(e.companyList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name)+" ")])})),1)],1),a("FormItem",{attrs:{label:"客服名称：",prop:"name"}},[a("Input",{staticClass:"width-500",attrs:{maxlength:"30","show-word-limit":"",type:"text",placeholder:"请输入企业名称"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),a("FormItem",{attrs:{label:"客服链接：",prop:"link"}},[a("Input",{staticClass:"width-500",attrs:{type:"textarea",placeholder:"请输入客服链接"},model:{value:e.model.link,callback:function(t){e.$set(e.model,"link",t)},expression:"model.link"}}),a("kdx-hint-text",[e._v("请输入正确有效的企业微信客服账号链接，若已经正式对外绑定到商城，更换链接"),a("br"),e._v("时需要重新进行选择")])],1)],1)],1)])],1)},n=[]},9911:function(e,t,a){"use strict";var i=a("23e7"),n=a("857a"),o=a("af03");i({target:"String",proto:!0,forced:o("link")},{link:function(e){return n(this,"a","href",e)}})},"9f60":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("5530"));a("4de4"),a("d3b7"),a("9911"),a("fb6a");var o={name:"servie_manage",props:{},data:function(){var e=this;this.$createElement;return{companyList:[],isShow:!1,service_name:"",model:{company_id:"",name:"",link:"",id:""},columns:[{title:"企业名称",key:"company_name"},{title:"客服名称",key:"name"},{title:"客服链接",key:"link"},{title:"创建时间",key:"create_time"},{title:"操作",key:"action",with:150,render:function(t,a){return t("div",[t("a",{class:e.noManagePerm?"disabled-btn":"btn-item",on:{click:function(){e.noManagePerm||e.editShow(a.row)}}},["编辑"]),t("a",{on:{click:function(){e.noManagePerm||e.delConfirm(a.row.id)}},class:e.noManagePerm?"disabled-btn":"btn-item"},["删除"])])}}],data:[],total:0,page:{pagesize:10,page:1},loading:!1,rules:{company_id:[{required:!0,message:"请选择企业名称"}],name:[{required:!0,message:"请输入客服名称"}],link:[{required:!0,message:"请输入客服链接"}]}}},computed:{noManagePerm:function(){return!this.$getPermMap("wechatCustomerService.customer-service.manage")}},created:function(){this.getList(),this.getCompanyList()},methods:{save:function(){var e=this;this.$refs.form_modal.validate((function(t){t&&(e.model.id?e.editService():e.addService())}))},addService:function(){var e=this;this.$api.customerApi.addService(this.model).then((function(t){var a=t.error;0==a&&(e.$Message.success("创建成功"),e.hide(),e.getList())}))},editShow:function(e){this.isShow=!0;var t=this.companyList.filter((function(t){return t.id==e.company_id}));console.log("hasCom-------------------",e.link.indexOf("?"),e),e.link=e.link.slice(0,e.link.indexOf("?")),t[0]||(e.company_id=""),this.model=(0,n.default)({},e)},editService:function(){var e=this;this.$api.customerApi.editService(this.model).then((function(t){var a=t.error;0==a&&(e.$Message.success("编辑成功"),e.hide(),e.getList())}))},hide:function(){this.isShow=!1,this.$refs.form_modal.resetFields(),this.model={company_id:"",name:"",link:"",id:""}},delConfirm:function(e){var t=this;this.$Modal.confirm({title:"您确定要删除当前客服？",content:"<div style='color:#ff0000c7;'>如果咨询入口已正式对外，建议先下掉咨询入口后再删除账号</div>",onOk:function(){t.del(e)}})},del:function(e){var t=this;this.$api.customerApi.delService({id:e}).then((function(e){var a=e.error;0==a&&(console.log(e),t.getList(),t.$Message.success("删除成功"))}))},handlePageChange:function(e){this.page.page=e.pageNumber,this.page.pagesize=e.pageSize,this.getList()},handleSearch:function(){this.getList()},handleReset:function(){this.service_name="",this.page.page=1,this.getList()},getList:function(){var e=this;console.log("--------------a---");var t=(0,n.default)({name:this.service_name},this.page);this.$api.customerApi.getServiceList(t).then((function(t){var a=t.error,i=t.data,n=i.list,o=i.total;0==a&&(e.data=n,e.total=o)}))},getCompanyList:function(){var e=this,t={only_list:1};this.$api.customerApi.getCompanyList(t).then((function(t){var a=t.error,i=t.data.list;0==a&&(e.companyList=i)}))}}};t.default=o},a34c:function(e,t,a){"use strict";a.r(t);var i=a("22c1"),n=a("b97b");for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);a("f927");var s=a("2877"),r=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,"c1ea912e",null);t["default"]=r.exports},a597:function(e,t,a){},b97b:function(e,t,a){"use strict";a.r(t);var i=a("9f60"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);t["default"]=n.a},f927:function(e,t,a){"use strict";a("a597")}}]);