(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"0065":function(t,e,a){"use strict";a.r(e);var n=a("f235e"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"0d3f1":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"credit-select-goods"},[a("Table",{key:t.refreshkey,attrs:{draggable:"",border:"",columns:t.columns,data:t.componentData.data,size:"small"},on:{"on-drag-drop":t.draggeTable}}),t.componentData.data&&t.componentData.data.length<50?a("div",{staticClass:"add",on:{click:t.addGood}},[t._v("+添加商品("+t._s(t.componentData.data.length)+"/50)")]):t._e(),a("GoodsCreditShopSelector",{attrs:{multiple:"",limit:50,"current-list":t.componentData.data},on:{"on-cancel":t.handleCancel,"on-change":t.handleChange},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}}),a("GoodsCreditShopSelector",{attrs:{current:t.getSingData},on:{"on-cancel":t.singleCancel,"on-change":t.singleChange},model:{value:t.singleShow,callback:function(e){t.singleShow=e},expression:"singleShow"}})],1)},i=[]},2425:function(t,e,a){"use strict";a.r(e);var n=a("0d3f1"),i=a("0065");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("f199");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"67c42761",null);e["default"]=c.exports},7393:function(t,e,a){"use strict";a.r(e);var n=a("d1871"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},8452:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("kdx-modal-frame",{attrs:{value:t.value,title:"商品选择器",width:"1000","ok-text":"保存"},on:{"on-ok":t.handleSave,"on-cancel":t.handleCancel}},[a("div",{staticClass:"goods-preview"},[a("div",{ref:"scrollBox",staticClass:"goods-preview-content"},[a("div",{staticClass:"search"},[a("Input",{staticClass:"width-250",attrs:{search:"","enter-button":"搜索",placeholder:"请输入"},on:{"on-search":t.handleSearch,"on-enter":t.handleSearch},model:{value:t.search.keyword,callback:function(e){t.$set(t.search,"keyword",e)},expression:"search.keyword"}})],1),a("Table",{directives:[{name:"loading",rawName:"v-loading",value:t.table.loading,expression:"table.loading"}],ref:"table",attrs:{columns:t.columns,data:t.table.data},scopedSlots:t._u([{key:"goods",fn:function(e){var n=e.row;return[a("div",{staticClass:"goods"},[a("div",{staticClass:"image"},[a("img",{attrs:{src:t.getThumb(n),alt:""}})]),a("div",{staticClass:"content"},[null!=n.goods_type?[1===+n.has_option?a("span",{staticClass:"mark more"},[t._v("多")]):t._e(),0===+n.goods_type?a("span",{staticClass:"mark real"},[t._v("实")]):1===+n.goods_type?a("span",{staticClass:"mark virtual"},[t._v("虚")]):2===+n.goods_type?a("span",{staticClass:"mark card"},[t._v("密")]):t._e()]:a("span",{staticClass:"mark coupon"},[t._v("券")]),t._v(" "+t._s(n.title||n.coupon_name)+" ")],2)])]}}])})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.table.total>10,expression:"table.total > 10"}],staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:t.table.total},on:{"on-change":t.handlePageChange}})],1)])])},i=[]},a5c6:function(t,e,a){},b090:function(t,e,a){},d1871:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("2909"));a("a9e3"),a("4de4"),a("d3b7"),a("159b"),a("ac1f"),a("841c");var s={name:"goodsSelector",props:{current:{type:[String,Object],default:function(){}},currentList:{type:Array,default:function(){return[]}},value:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},limit:{type:Number},params:{type:Object,default:function(){}}},computed:{columns:function(){var t=this,e=(this.$createElement,[{title:"商品",key:"title",slot:"goods",minWidth:450},{title:"积分价",key:"credit_shop_credit",minWidth:200,render:function(t,e){var a=e.row,n=a.credit_shop_credit,i=a.credit_shop_price,s=a.has_option;if("1"==s){var o,c,r,l,d,u,h,p,f=null===(o=a.rules)||void 0===o||null===(c=o.min)||void 0===c?void 0:c.credit_shop_credit,g=null===(r=a.rules)||void 0===r||null===(l=r.min)||void 0===l?void 0:l.credit_shop_price,m=null===(d=a.rules)||void 0===d||null===(u=d.max)||void 0===u?void 0:u.credit_shop_credit,v=null===(h=a.rules)||void 0===h||null===(p=h.max)||void 0===p?void 0:p.credit_shop_price;return t("div",{class:"price"},[t("span",{class:"credit"},[f,"积分"]),"+",t("span",{class:"credit_price"},[g,"元"]),t("span",["~"]),t("span",{class:"credit"},[m,"积分"]),"+",t("span",{class:""},[v,"元"])])}return t("div",{class:"price"},[t("span",{class:"credit"},[n,"积分"]),"+",t("span",{class:""},[i,"元"])])}},{title:"库存",key:"credit_shop_stock",width:60,render:function(t,e){var a=parseInt(e.row[e.column.key]);return"3"==e.row.type?t("div","-"):t("div",a||0===a?a<=999?a:"999+":"-")}},{title:"操作",key:"action",width:80,render:function(e,a){return e("div",{class:"action"},[e("Button",{class:"default-primary",style:{display:a.row.checked?"none":"block"},on:{click:function(){t.setChecked(a.index,!0)}}},["选择"]),e("Button",{attrs:{type:"primary"},style:{display:a.row.checked?"block":"none"},on:{click:function(){t.setChecked(a.index,!1)}}},["已选"])])}}]);return e}},data:function(){return{search:{keyword:"",group:""},page:{pageSize:10,pageNumber:1},selectRows:[],selectRow:{},table:{data:[],loading:!1,total:0}}},methods:{getThumb:function(t){if("1"==t.type){var e="2"==t.coupon_sale_type?"discount.png":"full-reduction.png";return a("c6ce")("./"+e)}return this.$utils.media(t.thumb)},handleSearch:function(){this.resetPage(),this.getShopList()},resetPage:function(){var t;this.page={pageSize:10,pageNumber:1},null===(t=this.$refs["page"])||void 0===t||t.reset()},handlePageChange:function(t){this.page=t,this.getShopList();try{this.$refs.scrollBox.scrollTop=0}catch(e){console.log(e)}},setChecked:function(t,e){var a=this;if(this.multiple){if(this.limit&&this.selectRows.length===this.limit&&e)return void this.$Message.error("已超出最大可选数量");this.$set(this.table.data[t],"checked",e),0===this.selectRows.length||e?this.selectRows.push(this.table.data[t]):this.selectRows=this.selectRows.filter((function(e){return e.id!==a.table.data[t].id}))}else e?(this.table.data.forEach((function(t,e){a.$set(a.table.data[e],"checked",!1)})),this.$set(this.table.data[t],"checked",!0),this.selectRow=this.table.data[t]):(this.$set(this.table.data[t],"checked",!1),this.selectRow={})},defaultChecked:function(){var t,e=this;this.multiple?this.table.data.forEach((function(t,a){for(var n in e.selectRows)if(e.selectRows[n].id===t.id){e.selectRows[n]=t,e.$set(e.table.data[a],"checked",!0);break}})):null===(t=this.table.data)||void 0===t||t.forEach((function(t,a){e.selectRow&&t.id===e.selectRow.id?(e.selectRow=t,e.$set(e.table.data[a],"checked",!0)):e.$set(e.table.data[a],"checked",!1)}))},getShopList:function(){var t=this;this.table.loading=!0;var e=Object.assign({page:this.page.pageNumber,pagesize:this.page.pageSize,status:"1"},this.search);this.$api.creditShopApi.getList(e).then((function(e){t.table.loading=!1,0===e.error&&(t.table.data=e.list,t.table.total=e.total,t.defaultChecked())})).catch()},handleSave:function(){this.multiple?this.$emit("on-change",this.selectRows):this.$emit("on-change",this.selectRow),this.handleCancel()},handleCancel:function(){this.$emit("on-cancel")},resetSearch:function(){this.search={keyword:"",group:""}},getTime:function(t){return"0000-00-00 00:00:00"===t?"-":t}},watch:{value:{handler:function(t){t&&(this.multiple?this.selectRows=(0,i.default)(this.currentList)||[]:this.selectRow=this.current,this.resetSearch(),this.resetPage(),this.getShopList())},immediate:!0}}};e.default=s},d780:function(t,e,a){"use strict";a("b090")},d817:function(t,e,a){"use strict";a.r(e);var n=a("8452"),i=a("7393");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("d780");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"4d403a53",null);e["default"]=c.exports},f199:function(t,e,a){"use strict";a("a5c6")},f235e:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("5530"));a("ac1f"),a("5319"),a("a434");var s=n(a("aee3")),o=n(a("d817")),c={components:{GoodsCreditShopSelector:o.default},mixins:[s.default],props:{currentInfo:{type:Object,default:function(){}},adapterFun:{type:Function,required:!0}},data:function(){var t=this;this.$createElement;return{componentData:{},refreshkey:"0",show:!1,singleShow:!1,columns:[{key:"thumb",width:94,title:"商品",slot:"goods",align:"left",render:function(e,a){return e("div",{class:"goods-thumb"},[e("i",{class:"iconfont icon-move move-icon"}),e("img",{attrs:{src:t.getThumb(a.row),alt:""},style:{width:"40px",height:"40px",display:"block",margin:"0 10px"}})])}},{key:"title",width:200,align:"center",title:" ",render:function(t,e){var a,n="";e.row.bargain?n="砍":e.row.credit&&(n="积");var i=e.row.goodstype||e.row.type;switch(i){case"0":a={goodsName:"mark real",goodsText:"实"};break;case"1":a={goodsName:"mark virtual",goodsText:"虚"};break;case"2":a={goodsName:"mark secret",goodsText:"密"};break;case"3":a={goodsName:"mark appoint",goodsText:"预"};break;default:a={};break}return t("div",{class:"title"},[t("span",{class:"mark",style:{display:"1"===e.row.has_option?"inline-block":"none"}},["多"]),t("span",{class:a.goodsName,attrs:{styl:!0}},[a.goodsText]),n?t("span",{class:"icon"},[n]):"",e.row.title])}},{title:"积分价",key:"credit_shop_credit",align:"center",render:function(t,e){var a=e.row;return t("div",{class:"price"},[t("span",{class:"credit"},[a.credit_shop_credit,"积分"]),"+",t("span",{class:"credit_price"},[a.credit_shop_price,"元"])])}},{key:"option",title:"操作",align:"center",render:function(e,a){return e("p",{class:"option",style:"text-align:center;"},[e("span",{on:{click:function(){t.replace(a)}}},["替换"]),e("span",{on:{click:function(){t.delete(a)}}},["删除"])])}}],replaceIndex:-1}},computed:{getSingData:function(){return this.componentData.data[this.replaceIndex]||{}}},methods:{draggeTable:function(t,e){var a=(0,i.default)({},this.componentData.data[t]);Object.assign(this.componentData.data[t],this.componentData.data[e]),Object.assign(this.componentData.data[e],a)},handleCancel:function(){this.show=!1},singleCancel:function(){this.singleShow=!1},handleChange:function(t){var e;this.componentData.data.length=0;for(var a=t.length<=50?t.length:50,n=0;n<a;n++)this.componentData.data.push(this.adapterFun(t[n]));this.refreshkey=Math.random(),"goods"==(null===(e=this.errorInfo)||void 0===e?void 0:e.id)&&this.$emit("validateGoodsForm")},singleChange:function(t){t.id?Object.assign(this.componentData.data[this.replaceIndex],this.adapterFun(t)):this.componentData.data.splice(this.replaceIndex,1),this.refreshkey=Math.random()},replace:function(t){this.replaceIndex=t.index,this.singleShow=!0},delete:function(t){this.componentData.data.splice(t.index,1)},addGood:function(){this.show=!0},getThumb:function(t){if("1"==t.act_type){var e="2"==t.coupon_sale_type?"creditShop/discount.png":"creditShop/full.png";return this.$utils.staticImg(e)}return this.$utils.media(t.thumb)}},created:function(){this.componentData=this.currentInfo||this.currentModal},mounted:function(){var t,e,a;null!==(t=this.componentData)&&void 0!==t&&null!==(e=t.defaultData)&&void 0!==e&&e.length&&(this.componentData.data=[],this.handleChange(null===(a=this.componentData)||void 0===a?void 0:a.defaultData))},beforeDestroy:function(){var t=this.componentData.data;this.componentData.defaultData=null!==t&&void 0!==t&&t.length?t:this.componentData.defaultData}};e.default=c}}]);