(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[54],{"003c":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"market-send-coupons-list"},[a("Table",{attrs:{columns:t.columns,data:t.data},scopedSlots:t._u([{key:"stock",fn:function(e){var a=e.row;return[t._v(" "+t._s("0"===a.stock_type?"不限制":parseInt(a.stock)-parseInt(a.get_total))+" ")]}}])})],1)},i=[]},"09db":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"other-set"},[a("Form",{ref:"form",attrs:{model:t.model,"label-width":120,rules:t.rules}},[a("div",{staticClass:"pb-30"},[a("kdx-form-title",[t._v("规则设置")]),a("FormItem",{staticClass:"dayAward",attrs:{label:"日签奖励：",prop:"day_reward"}},[a("div",{staticClass:"flex"},[a("span",{staticClass:"marginR-10"},[t._v("每日签到固定奖励")]),a("div",[a("kdx-rr-input",{staticClass:"width-160",attrs:{type:"text",number:"",fixed:0,"min-value":0,"max-value":999999999,placeholder:"请输入",disabled:t.isDisabled},model:{value:t.model.day_reward,callback:function(e){t.$set(t.model,"day_reward",e)},expression:"model.day_reward"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("积分")])])],1)]),a("kdx-hint-text",[t._v("用户每日签到可以获得的固定奖励")])],1),a("FormItem",{staticClass:"r-form-item-checkbox",attrs:{label:"递增奖励：",prop:"increasing.status"}},[a("RadioGroup",{model:{value:t.model.increasing.status,callback:function(e){t.$set(t.model.increasing,"status",e)},expression:"model.increasing.status"}},[a("Radio",{attrs:{label:"1",disabled:t.isDisabled||t.notChange}},[t._v("开启")]),a("Radio",{attrs:{label:"0",disabled:t.isDisabled||t.notChange}},[t._v("关闭")])],1),a("kdx-hint-text",[t._v(" 用户连续签到的第二天起，开始递增奖励，若断签，需要重新计算 "),a("span",[a("kdx-hint-tooltip",{attrs:{type:"form",hintText:"示例"}},[t._v("举例说明，除了每日签到固定奖励5个积分以外，同时设置从第二天起递增奖励2积分，3天后不再递增。此种情况下，小明第一天签到得固定的奖励5个积分，第二天签到除了5个积分的固定奖励，同时得到递增奖励的2个积分，共7个积分；第三天得5+4个积分，第四天得5+6，第五天不再进行递增，可得奖励5+6个积分，第六天、第七天同理可得5+6个积分。若断签，则重新计算；若活动进行中修改规则，则按照新规则重新发放奖励。")])],1)]),"1"===t.model.increasing.status?a("div",{staticClass:"nest-box"},[a("div",{staticClass:"flex align-center"},[a("span",{staticClass:"marginR-10"},[t._v("第二天起递增奖励")]),a("FormItem",{attrs:{prop:"increasing.integral"}},[a("kdx-rr-input",{staticClass:"width-160",attrs:{type:"text",number:"",fixed:0,"min-value":0,"max-value":999999999,placeholder:"请输入",disabled:t.isDisabled||t.notChange},model:{value:t.model.increasing.integral,callback:function(e){t.$set(t.model.increasing,"integral",e)},expression:"model.increasing.integral"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("积分")])])],1),a("span",{staticClass:"marginR-10 marginL-10"},[t._v("且")])],1),a("div",{staticClass:"flex align-center"},[a("FormItem",{staticClass:"rulesBox",attrs:{prop:"increasing.day"}},[a("kdx-rr-input",{staticClass:"width-160",attrs:{type:"text",number:"",fixed:0,"min-value":0,"max-value":999999999,placeholder:"请输入",disabled:t.isDisabled||t.notChange},model:{value:t.model.increasing.day,callback:function(e){t.$set(t.model.increasing,"day",e)},expression:"model.increasing.day"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("天")])])],1),a("span",{staticClass:"marginR-10 marginL-10"},[t._v("不再递增")])],1)]):t._e()],1),a("FormItem",{attrs:{label:"连续签到奖励：",prop:"continuity.status"}},[a("RadioGroup",{model:{value:t.model.continuity.status,callback:function(e){t.$set(t.model.continuity,"status",e)},expression:"model.continuity.status"}},[a("Radio",{attrs:{label:"1",disabled:t.isDisabled||t.notChange}},[t._v("开启")]),a("Radio",{attrs:{label:"0",disabled:t.isDisabled||t.notChange}},[t._v("关闭")])],1),a("kdx-hint-text",[t._v(" 用户达到指定天数后，将触发额外奖励，签满最长连续天数后，不再赠送连续奖励，若断签则重新计算 "),a("kdx-hint-tooltip",{attrs:{type:"form",hintText:"示例"}},[t._v("举例说明，除了每日签到固定奖励5个积分以外，同时设置连续签到3天得10个积分，连签5天的20个积分，连续签到5天的情况下用户可正常领取奖励；若第四天断签，则第五天签到时仅能领取日签奖励5个积分，且不再触发3天连签奖励（已在第三天领取过），需自第五天起签满5天才可获得5天连签奖励的20个积分。 若断签，则重新计算。活动进行中不可更改连签规则")])],1),1==t.model.continuity.status?a("ul",[t._l(t.model.continuity.info,(function(e,n){return a("li",{key:n},[a("div",{staticClass:"header"},[a("div",{staticClass:"flex formBox"},[a("span",{staticClass:"marginR-10"},[t._v("连续签到")]),a("FormItem",{staticClass:"ruleBox",attrs:{prop:"continuity.info."+n+".day",rules:t.rules.day}},[a("kdx-rr-input",{staticClass:"width-160",attrs:{type:"text",number:"",fixed:0,"min-value":0,"max-value":999999999,placeholder:"请输入",disabled:t.isDisabled||t.notChange},model:{value:e.day,callback:function(a){t.$set(e,"day",a)},expression:"item.day"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("天")])])],1),a("div",{staticClass:"marginR-10 marginL-10"},[t._v("赠送以下奖励")])],1),a("Button",{directives:[{name:"show",rawName:"v-show",value:0!==n,expression:"index !== 0"}],staticStyle:{"margin-top":"6px"},attrs:{type:"text",disabled:t.isDisabled||t.notChange},on:{click:function(e){return t.handleDelete(n)}}},[t._v("删除 ")])],1),a("div",{staticClass:"body",class:{show:e.showFlag}},[a("FormItem",{staticClass:"vertical",attrs:{label:"奖励内容：",prop:"continuity.info."+n+".award.select",rules:t.rules["award.select"]}},[a("CheckboxGroup",{model:{value:e.award.select,callback:function(a){t.$set(e.award,"select",a)},expression:"item.award.select"}},[a("Checkbox",{attrs:{label:"credit",disabled:t.isDisabled||t.notChange}},[t._v("积分")]),a("Checkbox",{attrs:{label:"coupon",disabled:t.isDisabled||t.notChange}},[t._v("优惠券")])],1),e.award&&e.award.select.length?a("div",{staticClass:"next marginT-10"},[new Set(e.award.select).has("credit")?a("FormItem",{attrs:{label:"积分：",prop:"continuity.info."+n+".award.credit",rules:t.rules["award.credit"]}},[a("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",number:"",fixed:0,"min-value":0,"max-value":999999999,disabled:t.isDisabled||t.notChange},model:{value:e.award.credit,callback:function(a){t.$set(e.award,"credit",a)},expression:"item.award.credit"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("积分")])])],1):t._e(),new Set(e.award.select).has("coupon")?a("FormItem",{ref:"coupon_ids_"+n,refInFor:!0,attrs:{label:"优惠券选择：",prop:"continuity.info."+n+".award.coupon",rules:t.rules["award.coupon"]}},[a("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled||t.notChange},on:{click:function(e){return t.showSelector(n)}}},[t._v(" "+t._s(3===e.couponSelector.data.length?"重新选择优惠券":"+添加优惠券("+e.couponSelector.data.length+"/3)")+" ")]),a("hint-alert",{staticStyle:{"margin-top":"10px","margin-bottom":"10px","max-width":"610px","margin-left":"120px"}},[t._v(" 最多可选择3优惠券且优惠券须是在有效期内 ")]),e.couponSelector.data.length>0?a("div",{staticClass:"form-item-bg-box"},[a("div",{staticClass:"coupons-list"},[e.couponSelector.data.length>0?a("coupons-list",{attrs:{data:e.couponSelector.data,showStock:!0,disabled:t.isDisabled||t.notChange},on:{"on-delete":function(e){return t.deleteCoupons(e,n)}}}):t._e()],1)]):t._e()],1):t._e()],1):t._e()],1)],1),a("coupon-selector",{attrs:{multiple:!0,limit:3,pick_way:"4",currentList:e.couponSelector.data},on:{"on-change":t.changeCouponList,"on-cancel":t.cancelSelector},model:{value:e.couponSelector.value,callback:function(a){t.$set(e.couponSelector,"value",a)},expression:"item.couponSelector.value"}})],1)})),a("div",{staticClass:"addReward"},[a("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled||t.notChange},on:{click:t.handleAdd}},[t._v("+添加奖励规则（"+t._s(t.model.continuity.info.length)+" / 7）")])],1)],2):t._e()],1),a("FormItem",{attrs:{label:"补签设置：",prop:"supplementary.status"}},[a("RadioGroup",{model:{value:t.model.supplementary.status,callback:function(e){t.$set(t.model.supplementary,"status",e)},expression:"model.supplementary.status"}},[a("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("开启")]),a("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("关闭")])],1),a("kdx-hint-text",[t._v(" 用户断签后，可以通过补签维持连续签到状态，次数不可超过当前设定周期 "),a("kdx-hint-tooltip",{attrs:{type:"form",hintText:"示例"}},[t._v("举例说明，除了每日签到固定奖励5个积分以外，同时设置连续签到3天得10个积分，连签5天的20个积分。用户在第三天完成签到后发现第2天断签，立即进行补签。补签后先获得日签奖励5积分，后判断已满足连签3天，可领取10积分。 若修改进行中的活动的补签规则，则按照新规则消耗积分和计算次数。")])],1),1==t.model.supplementary.status?a("div",{staticClass:"bg-box"},[a("FormItem",{attrs:{label:"补签次数：",prop:"supplementary.num"}},[a("div",{staticClass:"flex"},[a("div",[a("kdx-rr-input",{staticClass:"width-160",attrs:{type:"text",number:"",fixed:0,"min-value":0,"max-value":999999999,placeholder:"请输入",disabled:t.isDisabled},model:{value:t.model.supplementary.num,callback:function(e){t.$set(t.model.supplementary,"num",e)},expression:"model.supplementary.num"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("次")])])],1)])]),a("FormItem",{staticClass:"rulesBox",attrs:{label:"积分消耗：",prop:"supplementary.consume"}},[a("div",{staticClass:"flex"},[a("span",{staticClass:"marginR-10"},[t._v("每次消耗固定")]),a("div",[a("kdx-rr-input",{staticClass:"width-160",attrs:{type:"text",number:"",fixed:0,"min-value":0,"max-value":999999999,placeholder:"请输入",disabled:t.isDisabled},model:{value:t.model.supplementary.consume,callback:function(e){t.$set(t.model.supplementary,"consume",e)},expression:"model.supplementary.consume"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v("积分")])])],1)])])],1):t._e()],1)],1)])],1)},i=[]},"0d35":function(t,e,a){"use strict";a.r(e);var n=a("bb14"),i=a("6820");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("ea96");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"50bf1baf",null);e["default"]=r.exports},"0e11":function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=n(a("1da1"));a("b0c0"),a("d3b7");var s=n(a("2d1c")),o={name:"ActivityLink",props:{type:{type:String,default:""},pageSetup:{type:Object,default:function(){}},isDisabled:{type:Boolean,default:!1}},components:{MySelectLink:s.default},watch:{pageSetup:{handler:function(t){this.model=t}},model:{handler:function(t){this.$emit("update:pageSetup",t)},deep:!0}},computed:{notChange:function(){return"edit"==this.type}},data:function(){return{show:!1,model:{activity_link:"0",link_name:"",content:"查看",activity_title:"",link_url:""},rules:{link_name:[{required:!0,message:"页面名称必填"}],activity_link:[{required:!0,message:"活动链接必填"}],activity_title:[{required:!0,message:"活动标题必填"}],link_url:[{required:!0,message:"活动链接必填"}],content:[{required:!0,message:"入口文案必填"}]}}},methods:{changeLink:function(t){this.model.wxappid=t.wxappid,this.model.linkurl_name=t.name,this.model.link_url=t.url},handleCancel:function(){this.show=!1},validateForm:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate(function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n?e():a();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}}};e.default=o},"12a02":function(t,e,a){"use strict";a.r(e);var n=a("c582"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"20df":function(t,e,a){},"263f":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spell-group-index"},[a("preview"),a("div",{staticClass:"right"},[a("kdx-content-bar",{scopedSlots:t._u([{key:"btn",fn:function(){return[a("Button",{staticClass:"primary-long",attrs:{type:"primary",disabled:t.isDisabled,loading:t.submitLoading},on:{click:t.handleSave}},[t._v("保存 ")]),a("Button",{staticClass:"default-long",attrs:{to:"/creditSign/manage/index"}},[t._v("取消")])]},proxy:!0}])},[a("div",{staticClass:"content"},[a("basic-info",{ref:"basicInfo",attrs:{data:t.basicInfoData,"is-disabled":t.isDisabled,type:t.type,status:t.status},on:{"update:data":function(e){t.basicInfoData=e}}}),a("rules-info",{ref:"rulesInfo",attrs:{data:t.basicInfoData,award_stage:t.award_stage,type:t.type,status:t.status,"is-disabled":t.isDisabled},on:{"update:award_stage":function(e){t.award_stage=e},handleAdd:t.handleAdd,handleDelete:t.handleDelete}}),a("rule-description",{ref:"ruleDescription",attrs:{"is-disabled":t.isDisabled,data:t.basicInfoData,ruleDescription:t.rule_description},on:{"update:data":function(e){t.basicInfoData=e},"update:ruleDescription":function(e){t.rule_description=e},"update:rule-description":function(e){t.rule_description=e}}}),a("activity-link",{ref:"activityLink",attrs:{"is-disabled":t.isDisabled,pageSetup:t.page_setup,type:t.type},on:{"update:pageSetup":function(e){t.page_setup=e},"update:page-setup":function(e){t.page_setup=e}}})],1)])],1)],1)},i=[]},"2d1c":function(t,e,a){"use strict";a.r(e);var n=a("e8b2"),i=a("e643");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("c4be");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"248352c3",null);e["default"]=r.exports},3173:function(t,e,a){},"339c":function(t,e,a){"use strict";a("3173")},"3e83":function(t,e,a){"use strict";a("6f76")},40021:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"other-set"},[a("Form",{ref:"form",attrs:{model:t.model,"label-width":120,rules:t.rules}},[a("div",{staticClass:"pb-30"},[a("kdx-form-title",[t._v("规则说明")]),a("FormItem",{attrs:{label:"规则说明：",prop:"rule"}},[a("div",{staticClass:"editor"},[a("editor",{ref:"editor",attrs:{plugins:t.plugins,isDisabled:t.isDisabled,height:380},model:{value:t.model.rule,callback:function(e){t.$set(t.model,"rule",e)},expression:"model.rule"}}),a("div",{staticClass:"btn-group"},[a("Button",{staticClass:"goods-btn default-primary",attrs:{disabled:t.isDisabled||""==t.data.end_time},on:{click:t.rest}},[t._v("恢复默认说明")])],1)],1)])],1)])],1)},i=[]},"43d6":function(t,e,a){"use strict";a.r(e);var n=a("7a6d"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"4b0f":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"seckill-basic-info"},[a("Form",{ref:"form",attrs:{model:t.model,"label-width":120,rules:t.rule},nativeOn:{submit:function(t){t.preventDefault()}}},[a("kdx-form-title",[t._v("基本信息")]),a("FormItem",{attrs:{label:"活动名称：",prop:"activity_name"}},[a("Input",{staticClass:"width-390",class:{"input-disabled":t.isDisabled},attrs:{placeholder:"请输入活动名称",maxlength:"20","show-word-limit":"",disabled:t.isDisabled||"edit"==t.type},model:{value:t.model.activity_name,callback:function(e){t.$set(t.model,"activity_name",e)},expression:"model.activity_name"}})],1),a("FormItem",{attrs:{label:"活动期限：",required:""}},[a("div",{staticClass:"flex"},[a("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"start_time"}},[a("DatePicker",{staticClass:"width-250",attrs:{value:t.model.start_time,type:"date",placeholder:"开始时间",options:t.startOptions,disabled:t.isDisabled||t.notStarted},on:{"on-change":t.changeStartTime}})],1),a("div",{staticClass:"marginL-10 marginR-10"},[t._v("~")]),a("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"end_time"}},[a("DatePicker",{staticClass:"width-250",attrs:{value:t.model.end_time,options:t.dateOptions,type:"date",placeholder:"结束时间",disabled:"add"!==t.type&&"edit"!==t.type&&"copy"!==t.type},on:{"on-change":t.changeEndTime}})],1)],1)]),a("FormItem",{attrs:{label:"活动渠道：",prop:"client_type"}},[a("CheckboxGroup",{model:{value:t.model.client_type,callback:function(e){t.$set(t.model,"client_type",e)},expression:"model.client_type"}},[a("Checkbox",{attrs:{label:"20",disabled:t.isDisabled||"edit"==t.type&&"1"==t.status}},[t._v(" 微信公众号 ")]),a("Checkbox",{attrs:{label:"21",disabled:t.isDisabled||"edit"==t.type&&"1"==t.status}},[t._v(" 微信小程序 ")]),a("Checkbox",{attrs:{label:"10",disabled:t.isDisabled||"edit"==t.type&&"1"==t.status}},[t._v(" 手机浏览器H5 ")]),a("Checkbox",{attrs:{label:"30",disabled:t.isDisabled||"edit"==t.type&&"1"==t.status}},[t._v(" 头条/抖音小程序 ")])],1)],1)],1)],1)},i=[]},"4f12":function(t,e,a){"use strict";a.r(e);var n=a("fe58"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"5c77":function(t,e,a){"use strict";a("20df")},"5eb3":function(t,e,a){"use strict";a.r(e);var n=a("aa10"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"61c9":function(t,e,a){},"628f":function(t,e,a){t.exports=a.p+"static/dist/shop/img/preview-1.png"},6309:function(t,e,a){"use strict";a.r(e);var n=a("0e11"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},6654:function(t,e,a){"use strict";a.r(e);var n=a("be69"),i=a("4f12");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("3e83");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"61d418ba",null);e["default"]=r.exports},6820:function(t,e,a){"use strict";a.r(e);var n=a("a7d8"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"69a7":function(t,e,a){},"69c7":function(t,e,a){"use strict";a("859c")},"6f76":function(t,e,a){},7259:function(t,e,a){"use strict";a.r(e);var n=a("c62b"),i=a("6309");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("339c");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"a717c4fa",null);e["default"]=r.exports},"733a":function(t,e,a){},"78ac":function(t,e,a){"use strict";a.r(e);var n=a("09db"),i=a("ebf3");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("f0b9");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"32aba056",null);e["default"]=r.exports},"7a6d":function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("99af"),a("d3b7");var i=n(a("ceb0")),s={name:"RuleDescription",components:{Editor:i.default},props:{isDisabled:{type:Boolean,default:!1},data:{type:Object,default:function(){}},ruleDescription:{type:Object,default:function(){}}},watch:{ruleDescription:{handler:function(t){this.model=t},immediate:!0},model:{handler:function(t){this.$emit("updata:ruleDescription",t)},immediate:!0},"data.start_time":{handler:function(t){if(""!=t){var e=new Date(t).getFullYear(),a=new Date(t).getMonth()+1,n=new Date(t).getDate();this.start_time="".concat(e,"年").concat(a,"月").concat(n,"日")}},immediate:!0},"data.end_time":{handler:function(t){if(this.ifwatch&&""!=t){this.ifwatch=!1;var e=new Date(t).getFullYear(),a=new Date(t).getMonth()+1,n=new Date(t).getDate();this.end_time="".concat(e,"年").concat(a,"月").concat(n,"日"),this.start_time&&!this.ruleDescription.rule&&(this.model.rule='<div style="margin: 30px 0 74px 20px"><div style="font-weight: bold;margin-bottom:6px">活动时间</div>\n                                                    <div style="color: #636669;margin-bottom: 20px">'.concat(this.start_time,"-").concat(this.end_time,'</div>\n                            <div style="font-weight: bold;margin-bottom:6px">签到规则</div><div style="color: #636669;margin-bottom: 6px">·每日签到可以获得日签奖励，活动周期内连续签到可以获得连签奖励，可在签到页面查看具体奖励内容；</div>\n                            <div style="color: #636669;margin-bottom: 6px">·断签后支持补签，可通过积分兑换补签次数；</div><div style="color: #636669;">·活动奖励仅在活动周期内支持领取，最终解释权归商家所有</div></div>'))}}}},computed:{getData:function(){return this.ruleDescription}},data:function(){return{start_time:"",end_time:"",ifwatch:!0,plugins:"lists image media table wordcount link preview paste quickbars noneditable",model:{rule:""},rules:{rule:[{required:!0,message:"规则说明必填"}]}}},mounted:function(){},methods:{rest:function(){var t=new Date(this.data.end_time).getFullYear(),e=new Date(this.data.end_time).getMonth()+1,a=new Date(this.data.end_time).getDate();this.end_time="".concat(t,"年").concat(e,"月").concat(a,"日"),this.model.rule='<div style="margin: 30px 0 74px 20px"><div style="font-weight: bold;margin-bottom:6px">活动时间</div>\n                                                    <div style="color: #636669;margin-bottom: 20px">'.concat(this.start_time,"-").concat(this.end_time,'</div>\n                            <div style="font-weight: bold;margin-bottom:6px">签到规则</div><div style="color: #636669;margin-bottom: 6px">·每日签到可以获得日签奖励，活动周期内连续签到可以获得连签奖励，可在签到页面查看具体奖励内容；</div>\n                            <div style="color: #636669;margin-bottom: 6px">·断签后支持补签，可通过积分兑换补签次数；</div><div style="color: #636669;">·活动奖励仅在活动周期内支持领取，最终解释权归商家所有</div></div>')},validateForm:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate((function(t){t?e():a()}))}))}}};e.default=s},"859c":function(t,e,a){},"88c8":function(t,e,a){"use strict";a.r(e);var n=a("003c"),i=a("ac9f");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("cc09");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"ca8b90fc",null);e["default"]=r.exports},"9c12":function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"CouponsList",props:{data:{type:Array,required:!0},disabled:{type:Boolean,default:!1},showStock:{type:Boolean,default:!1}},data:function(){return{columns:[]}},methods:{deleteCoupons:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"确认删除该优惠券吗?",onOk:function(){e.$emit("on-delete",t)},onCancel:function(){}})}},watch:{showStock:{handler:function(t){var e=this;this.$createElement;this.columns=t?[{title:"优惠券名称",key:"coupon_name",minWidth:180,render:function(t,e){var n,i;return"2"===e.row.coupon_sale_type?i=[t("span","折扣券"),t("img",{attrs:{src:a("e7cd")}})]:"1"===e.row.coupon_sale_type&&(i=[t("span","满减券"),t("img",{attrs:{src:a("626b")}})]),t("div",{class:{"coupons-name":!0}},[t("div",{class:{"coupons-type":!0,deduction:"2"===e.row.coupon_sale_type,"full-reduction":"1"===e.row.coupon_sale_type}},i),t("div",{class:{"coupons-name-content":!0}},[t("p",{class:{name:!0}},e.row[e.column.key]),t("p",{class:{content:!0}},null===(n=e.row)||void 0===n?void 0:n.content)])])}},{title:"库存",slot:"stock",width:80},{title:"操作",key:"action",width:60,render:function(t,a){return t("Button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(){e.deleteCoupons(a.index)}}},["删除"])}}]:[{title:"优惠券名称",key:"coupon_name",minWidth:180,render:function(t,e){var n,i;return"2"===e.row.coupon_sale_type?i=[t("span","折扣券"),t("img",{attrs:{src:a("e7cd")}})]:"1"===e.row.coupon_sale_type&&(i=[t("span","满减券"),t("img",{attrs:{src:a("626b")}})]),t("div",{class:{"coupons-name":!0}},[t("div",{class:{"coupons-type":!0,deduction:"2"===e.row.coupon_sale_type,"full-reduction":"1"===e.row.coupon_sale_type}},i),t("div",{class:{"coupons-name-content":!0}},[t("p",{class:{name:!0}},e.row[e.column.key]),t("p",{class:{content:!0}},null===(n=e.row)||void 0===n?void 0:n.content)])])}},{title:"操作",key:"action",width:60,render:function(t,a){return t("Button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(){e.deleteCoupons(a.index)}}},["删除"])}}]},immediate:!0}}};e.default=n},a7d8:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("2909")),s=n(a("5530")),o=n(a("b85c"));a("a9e3"),a("4de4"),a("d3b7"),a("159b"),a("ac1f"),a("841c");var r={name:"CouponSelector",props:{value:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},current:{type:[String,Object]},currentList:{type:Array},limit:{type:Number},pick_way:{type:[String,Number],default:""},params:{type:Object,default:function(){}}},data:function(){var t=this;this.$createElement;return{search:{keyword:"",coupon_sale_type:""},columns:[{title:"类型",key:"coupon_sale_type",width:80,render:function(t,e){return"2"===e.row.coupon_sale_type?t("div",{class:"coupons-type coupons-type-blue"},[t("span",["折"]),t("img",{class:"coupons-img",attrs:{src:a("e7cd")}})]):t("div",{class:"coupons-type coupons-type-yellow"},[t("span",["减"]),t("img",{class:"coupons-img",attrs:{src:a("626b")}})])}},{title:"名称",key:"coupon_name"},{title:"优惠内容",key:"content"},{title:"剩余数量",key:"surplus",render:function(t,e){return"0"==e.row.stock_type?t("div",["不限制"]):t("div",[e.row[e.column.key]])}},{title:"创建时间",key:"created_at",render:function(t,e){return t("div",{style:"word-break: normal"},[e.row[e.column.key]])}},{title:" ",key:"action",width:100,render:function(e,a){return e("div",{class:"action"},[e("Button",{class:"default-primary",attrs:{disabled:1===a.row.is_select},style:{display:a.row.checked?"none":"block"},on:{click:function(){t.setChecked(a.index,!0)}}},["选择"]),e("Button",{attrs:{type:"primary"},style:{display:a.row.checked?"block":"none"},on:{click:function(){t.setChecked(a.index,!1)}}},["已选"])])}}],data:[],total:0,page:{pageSize:10,pageNumber:1},loading:!1,selectRows:[],selectRow:{}}},methods:{handleSearch:function(){this.resetPage(),this.getCouponList()},handlePageChange:function(t){this.page=t,this.getCouponList();try{this.$refs.scrollBox.scrollTop=0}catch(e){console.log(e)}},resetPage:function(){var t;this.page={pageSize:10,pageNumber:1},null===(t=this.$refs["page"])||void 0===t||t.reset()},setChecked:function(t,e){var a=this;if(this.multiple){if(this.limit&&this.selectRows.length===this.limit&&e)return void this.$Message.error("已超出最大可选数量");this.$set(this.data[t],"checked",e),0===this.selectRows.length||e?this.selectRows.push(this.data[t]):this.selectRows=this.selectRows.filter((function(e){return e.id!==a.data[t].id}))}else e?(this.data.forEach((function(t,e){a.$set(a.data[e],"checked",!1)})),this.$set(this.data[t],"checked",!0),this.selectRow=this.data[t]):(this.$set(this.data[t],"checked",!1),this.selectRow={})},defaultChecked:function(){var t=this;this.multiple?this.data.forEach((function(e,a){var n,i=(0,o.default)(t.selectRows);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.id===e.id){t.$set(t.data[a],"checked",!0);break}}}catch(r){i.e(r)}finally{i.f()}})):this.data.forEach((function(e,a){t.selectRow&&e.id===t.selectRow.id?t.$set(t.data[a],"checked",!0):t.$set(t.data[a],"checked",!1)}))},getCouponList:function(){var t=this;this.loading=!0;var e=Object.assign({},this.search,{pick_way:this.pick_way});e.coupon_sale_type="all"===e.coupon_sale_type?"":e.coupon_sale_type;var a=Object.assign((0,s.default)({pagesize:this.page.pageSize,page:this.page.pageNumber},this.params),e);this.$api.marketApi.getCouponAllList(a).then((function(e){t.loading=!1,0===e.error&&(t.data=e.list,t.total=e.total,t.defaultChecked())}))},handleSave:function(){this.multiple?this.$emit("on-change",this.selectRows):this.$emit("on-change",this.selectRow),this.handleCancel()},handleCancel:function(){this.$emit("on-cancel")},resetSearch:function(){this.search={keyword:"",coupon_sale_type:"all"}}},watch:{value:{handler:function(t){t&&(this.multiple?this.selectRows=(0,i.default)(this.currentList)||[]:this.selectRow=this.current||{},this.resetSearch(),this.resetPage(),this.getCouponList())},immediate:!0}},mounted:function(){this.resetSearch()}};e.default=r},a9cc:function(t,e,a){},aa10:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=n(a("1da1"));a("a9e3"),a("d3b7");var s={name:"BasicInfo",props:{status:{type:[Number,String]},type:{type:String,default:""},data:{type:Object,default:function(){}},isDisabled:{type:Boolean,default:!1}},data:function(){var t=this;return{model:{activity_name:"",start_time:"",end_time:"",client_type:[]},rule:{activity_name:[{required:!0,message:"请填写活动名称"}],start_time:[{required:!0,message:"请选择开始时间"}],end_time:[{required:!0,message:"请选择结束时间"},{validator:function(e,a,n){a?new Date(a).getTime()<=new Date(t.model.start_time).getTime()?n(new Error("结束时间需大于开始时间")):n():n(new Error("结束日期必填"))}}],client_type:[{required:!0,message:"活动渠道必选"}]},dateOptions:{disabledDate:function(e){if("edit"==t.type&&"1"==t.status){if(null!==t&&void 0!==t&&t.isEdit)return new Date(e)<=new Date(t.model.end_time);if(t.model.start_time)return new Date(e).getTime()+863e5<(new Date).getTime()||new Date(e).getTime()+863e5>new Date(t.model.start_time).getTime()+31536e6}else{if(null!==t&&void 0!==t&&t.isEdit)return new Date(e)<=new Date(t.model.end_time);if(t.model.start_time)return new Date(e).getTime()+863e5<(new Date).getTime()||new Date(e).getTime()+863e5<new Date(t.model.start_time).getTime()||new Date(e).getTime()+863e5>new Date(t.model.start_time).getTime()+31536e6}return!0}},startOptions:{disabledDate:function(e){return null!==t&&void 0!==t&&t.isEdit?new Date(e):""!=t.model.start_time&&!t.model.start_time||new Date(e).getTime()+863e5<(new Date).getTime()}}}},computed:{notStarted:function(){var t=!1;return"copy"==this.type?(t=!1,t):"0"!=this.status&&""!=this.status}},watch:{data:{handler:function(t){this.model=t},immediate:!0},model:{handler:function(t){this.$emit("update:data",t)},immediate:!0}},methods:{validateForm:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate(function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n?e():a();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},changeStartTime:function(t){this.model.start_time=t},changeEndTime:function(t){this.model.end_time=t}}};e.default=s},ac9f:function(t,e,a){"use strict";a.r(e);var n=a("9c12"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},aeeb:function(t,e,a){},bb14:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("kdx-modal-frame",{attrs:{value:t.value,title:"优惠券选择器",width:"1000","ok-text":"保存"},on:{"on-ok":t.handleSave,"on-cancel":t.handleCancel}},[a("div",{staticClass:"selector-link-discount-coupon"},[a("div",{ref:"scrollBox",staticClass:"coupon-content"},[a("div",{staticClass:"search"},[a("Input",{staticClass:"width-250",attrs:{search:"","enter-button":"搜索",placeholder:"请输入"},on:{"on-search":t.getCouponList,"on-enter":t.getCouponList},model:{value:t.search.keyword,callback:function(e){t.$set(t.search,"keyword",e)},expression:"search.keyword"}}),a("span",{staticClass:"label"},[t._v("优惠券类型：")]),a("Select",{staticClass:"width-160",on:{"on-change":t.handleSearch},model:{value:t.search.coupon_sale_type,callback:function(e){t.$set(t.search,"coupon_sale_type",e)},expression:"search.coupon_sale_type"}},[a("Option",{attrs:{value:"all"}},[t._v("全部")]),a("Option",{attrs:{value:"1"}},[t._v("满减券")]),a("Option",{attrs:{value:"2"}},[t._v("折扣券")])],1)],1),a("Table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{columns:t.columns,data:t.data}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total>10,expression:"total>10"}],staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:t.total},on:{"on-change":t.handlePageChange}})],1)])])},i=[]},be69:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview-index"},[n("div",{staticClass:"preview-bg"},[n("img",{attrs:{src:a("628f"),alt:""}})])])}]},c1d6:function(t,e,a){"use strict";a.r(e);var n=a("263f"),i=a("12a02");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("69c7");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"19f70486",null);e["default"]=r.exports},c4be:function(t,e,a){"use strict";a("aeeb")},c582:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=n(a("1da1")),s=n(a("5530"));a("e9c4"),a("d81d"),a("ac1f"),a("1276"),a("fb6a"),a("d3b7"),a("159b"),a("6062"),a("3ca3"),a("ddb0"),a("a15b"),a("5319"),a("a434");var o=n(a("6654")),r=n(a("f278")),l=n(a("78ac")),d=n(a("e119")),c=n(a("7259")),u={day_reward:"",increasing:{status:"0",integral:"",day:""},continuity:{status:"0",info:[{showFlag:!0,couponSelector:{data:[],value:!1},day:"",award:{select:["credit"],coupon:"",credit:""}}]},supplementary:{status:"0",num:"",consume:""}},p={name:"index",components:{preview:o.default,basicInfo:r.default,rulesInfo:l.default,ruleDescription:d.default,activityLink:c.default},data:function(){return{basicInfoData:{activity_name:"",start_time:"",end_time:"",client_type:[]},award_stage:JSON.parse(JSON.stringify(u)),page_setup:{link_name:"",activity_link:"",activity_title:"",content:"",link_url:""},rule_description:{rule:""},loading:!1,submitLoading:!1,id:"",type:"",status:""}},created:function(){var t=this.$route.query,e=t.id,a=t.type;this.id=e,this.type=a,this.id&&this.getData()},computed:{isDisabled:function(){return"view"===this.type}},methods:{getData:function(){var t=this;this.$api.creditSignApi.editActivity({id:this.id}).then((function(e){if(0==e.error){t.loading=!0;var a=e.data,n=a.activity_name,i=a.client_type,o=a.end_time,r=a.start_time,l=a.ext_field,d=a.status;e.data.ext_field.continuity.info=e.data.ext_field.continuity.info.map((function(t){return t.award.select=t.award.select.split(","),(0,s.default)({},t)})),i=i.split(","),t.status=d,t.award_stage=l,t.award_stage.continuity.info=t.award_stage.continuity.info.map((function(t){return t.coupon_info?(0,s.default)((0,s.default)({},t),{},{showFlag:!0,couponSelector:{data:t.coupon_info,value:!1}}):(0,s.default)((0,s.default)({},t),{},{showFlag:!0,couponSelector:{data:[],value:!1}})})),t.rule_description.rule=l.rule_description.rule,t.page_setup=l.page_setup,"copy"==t.type?(t.basicInfoData={activity_name:"副本-".concat(n),start_time:"",end_time:"",client_type:i},t.basicInfoData.activity_name=t.basicInfoData.activity_name.slice(0,20),delete e.id,delete e.stop_time,delete e.status,delete e.create_time,delete e.is_delete):(t.basicInfoData={activity_name:n,start_time:r,end_time:o,client_type:i},console.log(t.basicInfoData,"basicInfoData----"))}}))},handleSave:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.basicInfo.validateForm();case 3:return e.next=5,t.$refs.rulesInfo.validateForm();case 5:return e.next=7,t.$refs.ruleDescription.validateForm();case 7:return e.next=9,t.$refs.activityLink.validateForm();case 9:t.handleParams(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),t.submitLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()},handleParams:function(){"0"==this.award_stage.continuity.status&&(this.award_stage.continuity.info=u.continuity.info),"0"==this.award_stage.increasing.status&&(this.award_stage.increasing.integral="",this.award_stage.increasing.day=""),"0"==this.award_stage.supplementary.status&&(this.award_stage.supplementary.num="",this.award_stage.supplementary.consume=""),this.award_stage.continuity.info.forEach((function(t){new Set(t.award.select).has("credit")||(t.award.credit=""),new Set(t.award.select).has("coupon")||(t.award.coupon="")}));var t=(0,s.default)((0,s.default)({},this.basicInfoData),{},{ext_field:JSON.parse(JSON.stringify(this.award_stage))});t.ext_field.page_setup=this.page_setup,t.ext_field.rule_description=this.rule_description,t.ext_field.continuity.info.forEach((function(t){delete t.showFlag,delete t.couponSelector,delete t.coupon_info,t.award.select=t.award.select.join(",")})),t.ext_field=JSON.stringify(t.ext_field),this.id&&"copy"!=this.type?(t.id=this.id,this.editActivity(t)):this.saveActivity(t)},saveActivity:function(t){var e=this;this.submitLoading=!0,this.$api.creditSignApi.addCreditSign(t).then((function(t){0===t.error&&(e.$Message.success("保存成功"),e.$router.replace({path:"/creditSign/manage/index"}))})).finally((function(){e.submitLoading=!1}))},editActivity:function(t){var e=this;this.submitLoading=!0,this.$api.creditSignApi.editCreditSign(t).then((function(t){0===t.error&&(e.$Message.success("修改成功"),e.$router.replace({path:"/creditSign/manage/index"}))})).finally((function(){e.submitLoading=!1}))},handleAdd:function(){this.award_stage.continuity.info.length>=7||this.award_stage.continuity.info.push({showFlag:!0,couponSelector:{data:[],value:!1},day:"",award:{select:["credit"],coupon:"",credit:""}})},handleDelete:function(t){this.award_stage.continuity.info.splice(t,1)}}};e.default=p},c62b:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"other-set"},[a("Form",{ref:"form",attrs:{model:t.model,"label-width":120,rules:t.rules}},[a("div",{staticClass:"pb-30"},[a("kdx-form-title",[t._v("页面设置")]),a("FormItem",{attrs:{label:"页面名称：",prop:"link_name"}},[a("Input",{staticClass:"width-340",attrs:{placeholder:"请输入页面名称",maxlength:"6","show-word-limit":"",disabled:t.isDisabled||t.notChange},model:{value:t.model.link_name,callback:function(e){t.$set(t.model,"link_name",e)},expression:"model.link_name"}})],1),a("FormItem",{staticClass:"r-form-item-checkbox",attrs:{label:"活动链接：",prop:"activity_link"}},[a("RadioGroup",{model:{value:t.model.activity_link,callback:function(e){t.$set(t.model,"activity_link",e)},expression:"model.activity_link"}},[a("Radio",{attrs:{label:"1",disabled:t.isDisabled||t.notChange}},[t._v("开启")]),a("Radio",{attrs:{label:"0",disabled:t.isDisabled||t.notChange}},[t._v("关闭")])],1),1==t.model.activity_link?a("div",{staticClass:"bg-box"},[a("FormItem",{staticClass:"title",attrs:{label:"活动标题：",prop:"activity_title"}},[a("Input",{staticClass:"width-340",attrs:{placeholder:"请输入活动标题",maxlength:"10","show-word-limit":"",disabled:t.isDisabled||t.notChange},model:{value:t.model.activity_title,callback:function(e){t.$set(t.model,"activity_title",e)},expression:"model.activity_title"}})],1),a("FormItem",{staticClass:"marginL-53 vertical",attrs:{label:"入口文案：",prop:"content"}},[a("Input",{staticClass:"width-340",attrs:{placeholder:"请输入入口文案",maxlength:"4","show-word-limit":"",disabled:t.isDisabled||t.notChange},model:{value:t.model.content,callback:function(e){t.$set(t.model,"content",e)},expression:"model.content"}})],1),a("FormItem",{staticClass:"vertical",attrs:{label:"跳转链接：",prop:"link_url"}},[a("MySelectLink",{staticClass:"mb-0",staticStyle:{width:"340px"},attrs:{value:{name:t.model.linkurl_name,url:t.model.link_url,wxappid:t.model.wxappid},enabled:"edit"!=t.type&&"view"!=t.type},on:{change:t.changeLink}})],1)],1):t._e()],1)],1)])],1)},i=[]},cc09:function(t,e,a){"use strict";a("a9cc")},d584:function(t,e,a){"use strict";a("61c9")},d944:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("2909"));a("a9e3"),a("ac1f"),a("1276"),a("e9c4"),a("d81d"),a("a15b"),a("a434"),a("d3b7");var s=n(a("88c8")),o=n(a("0d35")),r={name:"RulesInfo",components:{CouponsList:s.default,CouponSelector:o.default},props:{status:{type:[Number,String]},type:{type:String,default:""},isDisabled:{type:Boolean,default:!1},data:{type:Object,default:function(){}},award_stage:{type:Object,default:function(){}}},data:function(){var t=this,e=function(e,a,n){var i=(new Date(t.data.end_time).getTime()-new Date(t.data.start_time).getTime())/864e5,s=(new Date(t.data.end_time).getTime()-(new Date).getTime())/864e5;a?(a<1&&n(new Error("递增天数不能为0")),"edit"==t.type&&"1"==t.status?a>s&&n(new Error("递增奖励天数必须小于剩余活动周期")):a>i&&n(new Error("递增奖励天数必须小于活动周期")),n()):n()};return{oldData:{},date:(new Date(this.data.end_time).getTime()-new Date(this.data.start_time).getTime())/864e5,levelIndex:"",level:{list:[]},model:{},list:[],rules:{day_reward:[{required:!0,message:"每日签到固定奖励必填"}],"increasing.status":[{required:!0,message:"递增奖励必填"}],"increasing.day":[{validator:e}],"increasing.integral":[{validator:function(t,e,a){e?e<1?a(new Error("递增奖励不可为0")):a():a(new Error("递增奖励必填"))}}],"continuity.status":[{required:!0,message:"连续签到奖励必填"}],"supplementary.status":[{required:!0,message:"补签设置必填"}],day:[{required:!0,validator:function(e,a,n){var i=e.field.split(".")[2],s=(new Date(t.data.end_time).getTime()-new Date(t.data.start_time).getTime())/864e5,o=(new Date(t.data.end_time).getTime()-(new Date).getTime())/864e5;if(a){if(a<=0&&n("连续签到天数不可低于1天"),i>0){var r,l,d,c=null===(r=t.model.continuity.info)||void 0===r?void 0:r[i-1].day,u=null===(l=t.model.continuity.info)||void 0===l||null===(d=l[i+1])||void 0===d?void 0:d.day;(c&&100*c>=100*a||u&&100*u<=100*a)&&n("奖励条件必须递增")}"edit"==t.type&&"1"==t.status?a>o&&n(new Error("连续奖励天数必须小于剩余活动周期")):a>s&&n(new Error("最大不可超过活动周期的天数")),n()}else n(new Error("连续签到天数必填"))}}],"supplementary.num":[{validator:function(e,a,n){var i=(new Date(t.data.end_time).getTime()-new Date(t.data.start_time).getTime())/864e5,s=(new Date(t.data.end_time).getTime()-(new Date).getTime())/864e5;a?("edit"==t.type&&"1"==t.status?(a>s&&n(new Error("补签次数不可超过当前剩余活动周期")),a<1?n(new Error("补签次数设置次数最小不可低于1次")):n()):a>i&&n(new Error("补签次数不可超过当前设定周期")),a<1?n(new Error("补签次数设置次数最小不可低于1次")):n()):n(new Error("补签次数必填"))}}],"supplementary.consume":[{validator:function(t,e,a){e?e<1?a(new Error("积分消耗不可为0")):a():a(new Error("积分消耗必填"))}}],"award.credit":[{validator:function(t,e,a){e?e<1?a(new Error("积分不可为0")):a():a(new Error("积分必填"))}}],"award.select":[{validator:function(t,e,a){e&&0!=e.length?a():(console.log("----"),a(new Error("奖励内容必填")))}}],"award.coupon":[{validator:function(t,e,a){e?a():a(new Error("优惠券必填"))}}]}}},computed:{getData:function(){return this.award_stage},notChange:function(){var t=!1;return"edit"==this.type&&"1"==this.status&&(t=!0),t}},watch:{data:{handler:function(t){this.oldData=JSON.parse(JSON.stringify(t))}},award_stage:{immediate:!0,handler:function(t){this.model=t,this.updateData()},deep:!0}},created:function(){},mounted:function(){},methods:{updateData:function(){this.$emit("update:award_stage",this.model)},handleAdd:function(){this.$emit("handleAdd")},handleDelete:function(t){this.$emit("handleDelete",t)},showSelector:function(t){this.levelIndex=t,this.model.continuity.info[this.levelIndex].couponSelector.value=!0},cancelSelector:function(){this.model.continuity.info[this.levelIndex].couponSelector.value=!1},changeCouponList:function(t){this.model.continuity.info[this.levelIndex].couponSelector.data=(0,i.default)(t);var e=this.model.continuity.info[this.levelIndex].couponSelector.data.map((function(t){return t.id}));this.model.continuity.info[this.levelIndex].award.coupon=e.join(","),this.$refs["coupon_ids_".concat(this.levelIndex)].validateState="",this.cancelSelector()},deleteCoupons:function(t,e){this.model.continuity.info[e].couponSelector.data.splice(t,1);var a=this.model.continuity.info[e].couponSelector.data.map((function(t){return t.id}));this.model.continuity.info[e].award.coupon=a.join(",")},addLevel:function(){var t=this;this.$nextTick((function(){t.$refs["level_modal"].setValue()}))},changeLevel:function(t){var e=t.map((function(t){return t.id}));this.level.list=t,this.model.level_id=e.join(","),this.$refs.form.validateField("level_id")},validateForm:function(){var t=this;return new Promise((function(e,a){t.$refs["form"].validate((function(t){t?e():a()}))}))}}};e.default=r},e119:function(t,e,a){"use strict";a.r(e);var n=a("40021"),i=a("43d6");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("5c77");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"1d69c528",null);e["default"]=r.exports},e643:function(t,e,a){"use strict";a.r(e);var n=a("f3be"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},e8b2:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"select-link",staticStyle:{"margin-bottom":"10px"},on:{mouseenter:t.mouseenter}},[a("div",{staticClass:"body"},[t.linkInfo.url||t.linkInfo.keyLink?a("Input",{staticClass:"input",staticStyle:{"border-left":"0",flex:"1"},attrs:{disabled:"",value:t.linkInfo.name,"enter-button":"修改"}},[a("i",{class:[t.icon],attrs:{slot:"prepend"},slot:"prepend"}),t.enabled?a("span",{staticStyle:{padding:"4px 16px"},attrs:{slot:"append"},on:{click:t.selectLink},slot:"append"},[t._v("修改")]):t._e()]):t._e(),t.linkInfo.url||t.linkInfo.keyLink?t._e():a("i-button",{staticStyle:{padding:"4px 6px",width:"100%","text-align":"left",flex:"1"},attrs:{icon:t.btnIcon},on:{click:t.selectLink}},[t._v(t._s(t.btnText)+" ")])],1),t.loadSelector&&t.enabled?a("union-selector",{attrs:{"tab-name":t.chooseTabs,current:t.linkInfo},on:{"on-cancel":t.handleCancel,"on-change":t.changeLink},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}}):t._e()],1)},i=[]},ea96:function(t,e,a){"use strict";a("69a7")},ebf3:function(t,e,a){"use strict";a.r(e);var n=a("d944"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},f0b9:function(t,e,a){"use strict";a("733a")},f278:function(t,e,a){"use strict";a.r(e);var n=a("4b0f"),i=a("5eb3");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("d584");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"3d246256",null);e["default"]=r.exports},f3be:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("58bb")),s={inject:{chooseTab:{default:"LinkStorePageLink,LinkCouponLink,LinkCustomPageLink,LinkCustomLink,LinkCreditShopLink,LinkGoodsClassifyLink,LinkGoodsGroupLink,LinkGoodsLink,LinkLiverLink,LinkMarketingPage,LinkMerchants,LinkWxAppLink,LinkApplicationPlug,LinkVideoLiveLink,LinkVideoRamLink,LinkCustomerServiceLink"}},components:{UnionSelector:i.default},props:{enabled:{type:Boolean,default:!0},showSelector:{type:Boolean,default:!0},value:{type:Object,default:function(){}},btnText:{type:String,default:"选择链接"},icon:{type:String,default:"ivu-icon ivu-icon-ios-link"},tabName:{type:String,default:"LinkStorePageLink,LinkCouponLink,LinkCustomPageLink,LinkCustomLink,LinkCreditShopLink,LinkGoodsClassifyLink,LinkGoodsGroupLink,LinkGoodsLink,LinkLiverLink,LinkMarketingPage,LinkWxAppLink,LinkApplicationPlug"},btnIcon:{type:String,default:"ios-link"}},watch:{value:{immediate:!0,handler:function(){this.linkInfo=this.value}}},data:function(){return{show:!1,linkInfo:{url:"",name:""},loadSelector:!1,chooseTabs:""}},created:function(){this.chooseTabs=this.chooseTab?this.chooseTab:this.tabName},methods:{mouseenter:function(){this.loadSelector=!0},handleCancel:function(){this.show=!1},changeLink:function(t){this.linkInfo=t,this.show=!1,this.$emit("change",t)},selectLink:function(){var t=this;this.showSelector?this.$nextTick((function(){setTimeout((function(){t.show=!0}))})):this.$emit("click")}}};e.default=s},fe58:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"Preview",components:{},props:{},data:function(){return{}},watch:{},computed:{},created:function(){},mounted:function(){},methods:{}};e.default=a}}]);