(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[46],{"0659":function(t,e,i){"use strict";i.r(e);var a=i("f859"),s=i("6da0");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("a308");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"535a0aa6",null);e["default"]=r.exports},"0733":function(t,e,i){"use strict";i.r(e);var a=i("3c5a"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},1448:function(t,e,i){"use strict";i("1f66")},"1b58":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("ac1f"),i("1276"),i("a9e3"),i("d3b7"),i("fb6a"),i("d81d");var s=a(i("3d60")),o={name:"RulesGoods",components:{specificationsRules:s.default},props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:""},isDisabled:{type:Boolean,default:!1}},data:function(){var t=this,e=this.$createElement;return{page:{pageSize:10,pageNumber:1},total:0,specificationsData:{rulesModal:!1,goodsId:"",spaceRules:[]},form:{goodsList:[]},columns:[{title:"商品",slot:"shop",minWidth:220},{title:"售卖价",slot:"price",minWidth:130},{title:"现库存",slot:"stock",minWidth:80},{slot:"rules",minWidth:450,renderHeader:function(){return e("div",{class:"flex"},[e("p",{class:"table-title"},["拼团库存"]),e("p",{class:"table-title"},["拼团价格"]),e("p",{class:"table-title"},["团长价(非必填)"])])}},{title:"操作",key:"action",width:80,render:function(e,i){return e("Button",{attrs:{type:"text",disabled:t.isDisabled},class:"action-btn",on:{click:function(){t.handleDelete(i.index)}}},["删除"])}}],rules:{activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?0===Number(i)?a(new Error("拼团库存不能为0")):Number(t.form.goodsList[s].stock)<Number(i)?a(new Error("拼团库存大于现库存")):a():a(new Error("拼团库存不能为空"))}}],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?Number(t.form.goodsList[s].price)<=Number(i)?a(new Error("拼团价格需小于售卖价")):a():a(new Error("拼团价格不能为空"))}}],leader_price:[{validator:function(e,i,a){var s,o,n=e.field.split(".")[1],r=null===(s=t.form.goodsList[n])||void 0===s?void 0:s.price,l=(null===(o=t.form.goodsList[n])||void 0===o?void 0:o.activity_price)||r;i&&(Number(r)<=Number(i)?a(new Error("团长价格需小于售售卖价")):Number(l)<=Number(i)&&a(new Error("团长价格需小于拼团价格"))),a()}}]}}},watch:{value:{handler:function(){var t=this;this.$nextTick((function(){t.reset()}))},immediate:!0}},created:function(){},mounted:function(){},methods:{validateForm:function(){var t=this;return new Promise((function(e,i){t.form.goodsList.some((function(t){return 1!=t.has_option}))?t.$refs["goodsForm"].validate((function(t){t?e():i()})):(t.form.goodsList.some((function(t){return!t.rules}))&&(t.$Message.error("每个商品必须有一个规格参加活动"),i()),e())}))},reset:function(){var t;null===(t=this.$refs["page"])||void 0===t||t.reset(),this.page={pageSize:10,pageNumber:1},this.getPageData()},getPageData:function(){this.total=this.value.length;var t=this.page.pageSize*(this.page.pageNumber-1),e=this.page.pageSize*this.page.pageNumber;this.form.goodsList=this.value.slice(t,e)},changePage:function(t){this.page=t,this.getPageData()},handleDelete:function(t){var e=(this.page.pageNumber-1)*this.page.pageSize+t;this.$emit("delete",e)},handleSelectOption:function(t){var e=this;this.specificationsData.rulesModal=!0,this.specificationsData.goodsId=t,this.form.goodsList.map((function(i){var a;i.id==t&&(null===i||void 0===i||null===(a=i.rules)||void 0===a?void 0:a.length)>0&&(e.specificationsData.spaceRules=i.rules)}))},handleSpaceGoods:function(t){var e=this.value.map((function(e){return e.id==t.id&&(e.goods_id=e.id,e.rules=t.rules),e}));this.$emit("input",e)},isSetRules:function(t){var e,i;return(null===(e=t.rules)||void 0===e?void 0:e.length)>0&&(null===(i=t.rules)||void 0===i?void 0:i.some((function(t){return"1"==t.is_join})))},goodsType:function(t){var e={goodsName:"",goodsText:""};switch(t){case"0":e={goodsName:"real",goodsText:"实"};break;case"1":e={goodsName:"virtual",goodsText:"虚"};break;case"2":e={goodsName:"secret",goodsText:"密"};break;case"3":e={goodsName:"appoint",goodsText:"预"};break;case"5":e={goodsName:"verifyCount",goodsText:"次"};break;case"6":e={goodsName:"netRecharge",goodsText:"充"};break;case"7":e={goodsName:"medicine",goodsText:"药"};break;default:e={goodsName:"",goodsText:""};break}return e}}};e.default=o},"1da0":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spell-group-index"},[i("preview",{attrs:{activityData:t.activityData}}),i("div",{staticClass:"right"},[i("kdx-content-bar",{scopedSlots:t._u([{key:"btn",fn:function(){return[i("Button",{staticClass:"primary-long",attrs:{type:"primary",disabled:t.isSaveBtnDisabled,loading:t.submitLoading},on:{click:t.handleSave}},[t._v("保存")]),i("Button",{staticClass:"default-long",attrs:{to:"/groups/activity/list"}},[t._v("取消")])]},proxy:!0}])},[i("div",{staticClass:"content"},[i("basic-info",{ref:"basicInfo",attrs:{type:t.type,data:t.basicInfoData,status:t.status,"is-disabled":t.isDisabled},on:{"update:data":function(e){t.basicInfoData=e}}}),i("rules-info",{ref:"rulesInfo",attrs:{type:t.type,activityData:t.activityData,"basic-info":t.basicInfoData,id:t.id,"is-disabled":t.isDisabled},on:{"update:activityData":function(e){t.activityData=e},"update:activity-data":function(e){t.activityData=e}}})],1)])],1)],1)},s=[]},"1f11":function(t,e,i){"use strict";i.r(e);var a=i("f031"),s=i("a02b");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("8d54");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"1dc6293e",null);e["default"]=r.exports},"1f66":function(t,e,i){},2472:function(t,e,i){},"2e1d":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("2909")),o=a(i("5530")),n=a(i("b85c"));i("a9e3"),i("a434"),i("4de4"),i("d3b7"),i("159b"),i("ac1f"),i("841c");var r={name:"goodsSelector",props:{current:{type:[String,Object],default:function(){}},currentList:{type:Array,default:function(){return[]}},value:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},limit:{type:Number},isStore:{type:Boolean,default:!1},params:{type:Object,default:function(){}},type:{type:String,default:""},flag:{type:String,default:""},status:{type:Number,default:5},show_activity:{type:[Number],default:0},is_shopping_reward:{type:[Number],default:0}},computed:{columns:function(){var t=this,e=(this.$createElement,[{title:"商品",key:"shop",minWidth:450,render:function(e,i){var a;switch(i.row.type){case"0":a={goodsText:"实"};break;case"1":a={goodsText:"虚"};break;case"2":a={goodsText:"密"};break;case"3":a={goodsText:"预"};break}return e("div",{class:{"shop-box":!0}},[e("div",{class:{image:!0}},[e("img",{attrs:{src:t.$media(i.row.thumb)},on:{error:function(e){t.replaceImage(e)}}})]),e("div",{class:{content:!0}},[e("div",{class:{"content-text":!0}},[e("span",{class:{mark:!0},style:{display:"1"===i.row.has_option?"inline-block":"none"}},"多"),e("span",{class:{mark:!0,real:"0"===i.row.type,virtual:"1"===i.row.type,secret:"2"===i.row.type}},a.goodsText),e("span",{class:{text:!0}},i.row.title)])])])}},{title:"价格",key:"price",minWidth:60,render:function(t,e){return"1"===e.row.has_option?t("div",{class:"price"},[t("span",["￥",e.row.min_price," ~ ￥",e.row.max_price])]):t("div",{class:"price"},[t("span",["￥",e.row[e.column.key]])])}},{title:"库存",key:"stock",width:60,render:function(t,e){var i=parseInt(e.row[e.column.key]);return"3"==e.row.type?t("div","-"):t("div",i||0===i?i<=999?i:"999+":"-")}},{title:"操作",key:"action",width:80,render:function(e,i){return e("div",{class:"action"},[e("Button",{class:"default-primary",attrs:{disabled:1===i.row.is_select},style:{display:i.row.checked?"none":"block"},on:{click:function(){t.setChecked(i.index,!0)}}},["选择"]),e("Button",{attrs:{type:"primary"},style:{display:i.row.checked?"block":"none"},on:{click:function(){t.setChecked(i.index,!1)}}},["已选"])])}}]);return this.show_activity&&e.splice(-1,0,{title:"营销活动",key:"is_activity_goods",width:130,render:function(e,i){return e("div",{class:1===i.row.is_activity_goods?"brand-color pointer":"pointer",on:{click:function(){t.viewActivity(i.row)}}},[1===i.row.is_activity_goods?"查看参与的活动":"未参与活动"])}}),e}},data:function(){var t=this.$createElement;return{search:{keywords:"",group:""},goodsGroup:[],page:{pageSize:10,pageNumber:1},selectRows:[],selectRow:{},table:{data:[],loading:!1,total:0},activity:{show:!1,columns:[{title:"活动名称",key:"title"},{title:"活动状态",key:"status",slot:"status"},{title:"活动时间",key:"time",slot:"date"},{title:"活动类型",key:"type_text"},{title:"活动来源",key:"sub_shop_id",render:function(){return t("div",["平台"])}}],data:[]}}},created:function(){this.activity.columns=this.activity.columns.filter((function(t){return"sub_shop_id"!==t.key}))},methods:{handleSearch:function(){this.resetPage(),this.getShopList()},resetPage:function(){var t;this.page={pageSize:10,pageNumber:1},null===(t=this.$refs["page"])||void 0===t||t.reset()},handlePageChange:function(t){this.page=t,this.getShopList();try{this.$refs.scrollBox.scrollTop=0}catch(e){console.log(e)}},setChecked:function(t,e){var i=this;if(this.multiple){if(this.limit&&this.selectRows.length===this.limit&&e)return void this.$Message.error("已超出最大可选数量");this.$set(this.table.data[t],"checked",e),0===this.selectRows.length||e?this.selectRows.push(this.table.data[t]):this.selectRows=this.selectRows.filter((function(e){return e.id!==i.table.data[t].id}))}else e?(this.table.data.forEach((function(t,e){i.$set(i.table.data[e],"checked",!1)})),this.$set(this.table.data[t],"checked",!0),this.selectRow=this.table.data[t]):(this.$set(this.table.data[t],"checked",!1),this.selectRow={})},defaultChecked:function(){var t,e=this,i=this.isStore?"broadcast_goods_id":"id",a=this.isStore?"broadcast_goods_id":"id";this.multiple?this.table.data.forEach((function(t,s){var o,r=(0,n.default)(e.selectRows);try{for(r.s();!(o=r.n()).done;){var l=o.value;if(l[a]===t[i]){e.$set(e.table.data[s],"checked",!0);break}}}catch(d){r.e(d)}finally{r.f()}})):null===(t=this.table.data)||void 0===t||t.forEach((function(t,s){e.selectRow&&t[i]===e.selectRow[a]?e.$set(e.table.data[s],"checked",!0):e.$set(e.table.data[s],"checked",!1)}))},getShopList:function(){var t=this;if(this.isStore)this.getGoodsStore();else{this.table.loading=!0;var e=Object.assign((0,o.default)({page:this.page.pageNumber,pagesize:this.page.pageSize,status:-1===this.status?"":this.status,type:this.type,flag:this.flag,show_activity:this.show_activity,is_shopping_reward:this.is_shopping_reward},this.params),this.search);this.$api.goodsApi.goodsList(e).then((function(e){t.table.loading=!1,0===e.error&&(t.table.data=e.list,t.table.total=e.total,t.defaultChecked())})).catch()}},getGoodsStore:function(){var t=this;this.table.loading=!0;var e=Object.assign({page:this.page.pageNumber,pagesize:this.page.pageSize,bro_goods_status:2},{title:this.search.keywords});this.$api.liverApi.getGoodsStore(e).then((function(e){t.table.loading=!1,0===e.error&&(t.table.data=e.list,t.table.total=e.total,t.defaultChecked())})).catch()},goodGroupList:function(){var t=this;this.$api.goodsApi.goodGroupList({pager:0}).then((function(e){0===e.error?t.goodsGroup=e.list:t.$Message.error("商品组获取失败")}))},handleSave:function(){this.multiple?this.$emit("on-change",this.selectRows):this.$emit("on-change",this.selectRow),this.handleCancel()},handleCancel:function(){this.$emit("on-cancel"),this.activity.show=!1},resetSearch:function(){this.search={keywords:"",group:""}},viewActivity:function(t){console.log(t,"data>>>>>>>>viewActivity"),t.is_activity_goods&&(this.activity.show=!0,this.activity.data=t.join_activity)},getTime:function(t){return"0000-00-00 00:00:00"===t?"-":t}},watch:{value:{handler:function(t){t&&(this.multiple?this.selectRows=(0,s.default)(this.currentList)||[]:this.selectRow=this.current,this.resetSearch(),this.resetPage(),this.getShopList())},immediate:!0}}};e.default=r},3084:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXcAAAAUCAYAAAB2132+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAe7SURBVHgB7Zw3bBRNFMfHH4aOJCiAgihoAUFNEIiKDC25oCLTkinJ0CCRaxChJIjUgkiunO3GjbNdWt5vfk9+q7n17nG2D3t9ej9pdbuTdu/mzX/evFm7KvI4wzAMo5KI/nOGYRhGxWHibhiGUYFMqLg/efLE/fz5MzO/ubk5NZ80jk+fPrnu7m5nGIZhFFLtxgnE+PXr1wVpiPvixYvdhg0bCtJ37NjhVq1a5Z4+fSoC//jx44L8sJ3Pnz+7CxcuOKPyYOLmwEYMwxgZZRX32bNny2C8deuWO3HiREEe6Qg1vHr1SsRbRZ1r8vU6zRs/dOhQfM5EQRna4JN7zZo1a1gd8n79+iUH55RZuXKlW79+vTPyS1dXl9u7d69M3IC4v3jxQvquGNjXpk2bXEtLizt//rwcwDsDZ86ccXfu3HEHDx50Dx48yGwDh+LIkSNiU9evX4/Tm5qa3PLly8Xmvn37llrnb20b+eRvTgR2hXYkNUY1pRT6+vok0tDW1ubKwZw5c9yWLVvc9OnTM8uUVdxVlNPEGeHWH48fBIFWj3vjxo3uwIEDMjiAchp6oS0+8fJPnjwpdXWiYKBlPcfly5fds2fPUp+FNlgdnDt3zrzCnIEQnz171v3+/dt9+PBB+gpR3rx5s6urq5NrRJ/VG+Ktg4t6V65cGdYeEwV1SxmItIHNUI7PUNwVHAXurw6C1jHyDXrBBMzEX19fH6dfunTJ3b17VxwH8t6/fx9rgtZR8Uej1GFAX7CDqqoqsRN1PEjv6ekZZjtv376Vdrdt2+bKwffv3+X+W7duzS4UjQHvoUcXL16Mfvz4EQ29UikHaWn4L5d6+MFU8Ak+FBOncU67Hz9+jLwHJdd+IpDzly9fFtzDrwIiP6vJcerUqcjPlpEf4JLHJ9eHDx+OpkyZEi1dulTKG/lhcHBQ+mXPnj1xWmNjY1RdXR3dvn1b8v0qTq61XwHbII2y9K0ftJKOjWAHnZ2d0q4frJn3pixtYFN8YivhM9AuduVXBwV11JaKtW1MHPQR/bN79+5o2bJlcTo2wzV2hF1hJ9q3XKMTakfYD2WxCfLmzp0r6X7VFvc79wnbD7l//77UQ9NUJ0d7LFmyJG6zCINj2lDFk/ZCPiyWXgzi5/5HlXM/iOTAU9JzBS+eY+fOnbFHT2jGfzGZGZlVWeYk7/3mzRu3aNEiWTrfuHFD0vCs1JMn7+HDh66hoSEub+SPcMWFt+yNVTwrPKVHjx5J/4ZeOx5W2kqMa+yglOWz2g6runXr1olHl+TYsWPiMfF80dBqAS/eVoD5BbthFUjfKfQd/b1//36xDewK+9G+5UAvjh8/LuUJOXMe6oXa6IwZM0SPWCHi+RdDQ9NjIdlG1kspIwrLeM9JvpBueI4G4pPE2Ilpahucr169OhbxLJgUCOFQj7g+bSVj+wg3z8gEQPxV47bK6dOnZXlFR7K0KTVmZowPDDIGETFy+k9DdPQTfaqE8XcEVuuNFgY79o190Rbifu/evYJwDukI+ZcvXyRUhFjgYLBUt9BMftEQWlIUcRpCm6GfmdyZDLAHzkN94Bpxxw6uXbvm/OpSztlnwQZpayImeRxcnjN57xF57qPx1JPwA+mbMHjhHAwqhD1to5PBxQACfXja0Lg7nn0SvijPSOcx8Nrb293AwIB463hx5Gls1cgfTNi6gTpz5kz3/PlzSV+4cKF80vc6aRNTR2gpy8BTkdXYeKlQnkGN4+GX1vF+TVK0Gczbt28Xr14HOt6fUTlkvV6NLSo4iKwG8NTVm8cOsBdsabxJWxEU9dzL4akn0Y1V2r5586ak+ViXpCPaim6kMtj4Ubk/13wJ6iPMTDZZG2XMorrkUqGn/TDdyCeINf2qYTUcAbx2Jn88KkJsiCsbrFxjH7oBryDs2Ekpb0bRBu1hH7rJHw29YcPATa4IsB88NfJ1g82YfOjLGSHYGemEWsKVouYlQY+w13fv3rk1a9aI6HPNhup4vpWXps9FxR3xLFZ5LPCjMGghbabk7RgGG6EYzrk/kwATAjvcgPBrWzpRhKiws3wK05isjPyCh074jAlZ+xCB1cFC/+Ex60pO908AUZ46daqUH4nwsjokJBN64djV1atXh9kn8VdCMuThxRuTDw2xff36VQQZWLnhKLAKjIb+5Za+GaUx+rC/SdM4O/VoE5vDLsM3qsr93BwhR48eTXVWx+2PmELw0kMx5kdQT10fUicWnQR4z5i8Xbt2SVlEn3PCRMk/cgpBCPjB8fb4NGHPP4TaGDB40/R1Uqixl6yBowMsmU864Z5wdai0trbKAE+GV3gO6jHoqcc+jdanLeroBMN5uGw38s++ffvc2rVrxdPGoWA1pjagG6yszvDCEWsO0kBXdpTHBnQy0HAgezYh06ZNc/39/aJV2NNY4H69vb3SJsybNy+1XFUUZf9XyGRYZqTXSRBsYutpeXjnOtslN1bx0DW2zjmTA0Kvwl/KX6j+q5nUMIzJAaKqq0BFwyrk4ZWrF68QQ9cNy/BtrKy2mCDw/JOhvD9//riamhq3YsUKVw5qa2ulLUJBGURFxd0wDMMoD4h/R0eHKwfz5893CxYsKFbExN0wDKMCsf/nbhiGUYmYuBuGYVQgE/K2jGEYRs6otPB09D97EUjdPXcM3QAAAABJRU5ErkJggg=="},"30d5":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("2909"));i("ac1f"),i("1276"),i("a9e3"),i("fb6a"),i("d81d"),i("99af"),i("d3b7"),i("a434");var o=a(i("d050")),n={name:"RulesGoods",components:{LadderSpecificationsRules:o.default},props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:""},isDisabled:{type:Boolean,default:!1},ladderNum:{type:Array,default:function(){return[]}}},data:function(){var t=this;this.$createElement;return{page:{pageSize:10,pageNumber:1},specificationsData:{rulesModal:!1,goodsId:"",spaceRules:[]},form:{goodsList:[]},columns:[],defaultColumns:[{title:"商品",slot:"shop",minWidth:220},{title:"售卖价",slot:"price",minWidth:130},{title:"现库存",slot:"stock",minWidth:80}],actionColumns:{title:"操作",key:"action",width:80,render:function(e,i){return e("Button",{attrs:{type:"text",disabled:t.isDisabled},class:"action-btn",on:{click:function(){t.handleDelete(i.index)}}},["删除"])}},rules:{activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?0===Number(i)?a(new Error("拼团库存不能为0")):Number(t.form.goodsList[s].stock)<Number(i)?a(new Error("拼团库存大于现库存")):a():a(new Error("拼团库存不能为空"))}}],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1];i?Number(t.form.goodsList[s].price)<=Number(i)?a(new Error("拼团价格需小于售卖价")):a():a(new Error("拼团价格不能为空"))}}],activity_price1:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=parseFloat(o.price);i?(i=parseFloat(i),n<=i&&a(new Error("拼团价格需小于售卖价"))):a(new Error("拼团价格不能为空")),a()}}],activity_price2:[{validator:function(e,i,a){console.log("rule------");var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=parseFloat(n.price);if(console.log("value",i),i){i=parseFloat(i),r<=i&&a(new Error("拼团价格需小于售卖价"));var l=n["activity_price".concat(o)];l&&parseFloat(l)<=i&&a(new Error("阶梯拼团价要比上一阶梯小")),a()}else a(new Error("拼团价格不能为空"))}}],activity_price3:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=parseFloat(n.price);if(i){i=parseFloat(i),r<=i&&a(new Error("拼团价格需小于售卖价"));var l=n["activity_price".concat(o)];l&&parseFloat(l)<=i&&a(new Error("阶梯拼团价要比上一阶梯小")),a()}else a(new Error("拼团价格不能为空"))}}],leader_price:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=null===o||void 0===o?void 0:o.price,r=null===o||void 0===o?void 0:o["activity_price".concat(t.ladderNum.length)];i&&(Number(n)<=Number(i)?a(new Error("团长价格需小于售售卖价")):Number(r)<=Number(i)&&a(new Error("团长价格需小于拼团价格"))),a()}}]}}},computed:{total:function(){var t;return(null===(t=this.form.goodsList)||void 0===t?void 0:t.length)||0}},watch:{value:{handler:function(t){this.form.goodsList=t},immediate:!0},ladderNum:{handler:function(){this.setColumns()},immediate:!0,deep:!0}},created:function(){},mounted:function(){},methods:{setColumns:function(){var t=this,e=this.$createElement,i=300+150*this.ladderNum.length,a={slot:"rules",minWidth:i,renderHeader:function(){return e("div",{class:"flex"},[e("p",{class:"table-title"},["拼团库存"]),t.ladderNum.map((function(t){return e("p",{class:"table-title"},[t.num,"人拼团价"])})),e("p",{class:"table-title"},["团长价(非必填)"])])}};this.columns=[].concat((0,s.default)(this.defaultColumns),[a,this.actionColumns])},validateForm:function(){var t=this;return new Promise((function(e,i){t.form.goodsList.some((function(t){return 1!=t.has_option}))?t.$refs["goodsForm"].validate((function(t){t?e():i()})):(t.form.goodsList.some((function(t){return!t.rules}))&&(t.$Message.error("每个商品必须有一个规格参加活动"),i()),e())}))},changePage:function(t){this.page=t},handleDelete:function(t){this.form.goodsList.splice(t,1),this.$emit("input",this.form.goodsList)},handleSelectOption:function(t){var e=this;this.specificationsData.rulesModal=!0,this.specificationsData.goodsId=t,this.form.goodsList.map((function(i){var a;i.id==t&&(null===i||void 0===i||null===(a=i.rules)||void 0===a?void 0:a.length)>0&&(e.specificationsData.spaceRules=i.rules)}))},handleSpaceGoods:function(t){this.form.goodsList=this.form.goodsList.map((function(e){return e.id==t.id&&(e.goods_id=e.id,e.rules=t.rules),e})),this.$emit("input",this.form.goodsList)},isSetRules:function(t){var e,i;return(null===(e=t.rules)||void 0===e?void 0:e.length)>0&&(null===(i=t.rules)||void 0===i?void 0:i.some((function(t){return"1"==t.is_join})))},goodsType:function(t){var e={goodsName:"",goodsText:""};switch(t){case"0":e={goodsName:"real",goodsText:"实"};break;case"1":e={goodsName:"virtual",goodsText:"虚"};break;case"2":e={goodsName:"secret",goodsText:"密"};break;case"3":e={goodsName:"appoint",goodsText:"预"};break;case"5":e={goodsName:"verifyCount",goodsText:"次"};break;case"6":e={goodsName:"netRecharge",goodsText:"充"};break;case"7":e={goodsName:"medicine",goodsText:"药"};break;default:e={goodsName:"",goodsText:""};break}return e}}};e.default=n},3210:function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("4de4"),i("d3b7"),i("159b");var s=a(i("5530")),o={name:"Preview",components:{},props:{activityData:{type:Object,default:function(){}}},data:function(){return{data:{}}},watch:{activityData:{handler:function(t){var e;if(null!==t&&void 0!==t&&null!==(e=t.goods_info)&&void 0!==e&&e.length){var i,a,o,n=(0,s.default)({},null===t||void 0===t?void 0:t.goods_info[0]);if(1==n.has_option){var r,l,d,c,u,p=null===(r=n)||void 0===r||null===(l=r.rules)||void 0===l?void 0:l.filter((function(t){return 1==t.is_join}))[0],f=null===p||void 0===p?void 0:p.activity_stock,m=null===p||void 0===p?void 0:p.activity_price;if(1==t.inner_type)m=null===p||void 0===p||null===(u=p.ladder_price)||void 0===u?void 0:u[t.group_num_list.length];var v=null===(d=n)||void 0===d||null===(c=d.rules)||void 0===c?void 0:c.filter((function(t){return 1==t.is_join}));v&&v.length&&(f=0,v.forEach((function(t){f+=parseInt(t.activity_stock)}))),n=(0,s.default)((0,s.default)({},n),{},{activity_price:m||10,activity_stock:f||100})}if(1==t.inner_type)if(1==n.has_option)n.activity_price=(null===(a=n.rules)||void 0===a||null===(o=a[0])||void 0===o?void 0:o.ladder_price[t.group_num_list.length])||"2000",n.original_price=n.min_price,n.price=n.min_price;else n.activity_price=n["activity_price".concat(t.group_num_list.length)];var h=(null===t||void 0===t||null===(i=t.rules)||void 0===i?void 0:i.single_buy)||1;this.data=(0,s.default)((0,s.default)({},t),{},{single_buy:h,goods_info:n})}else this.data=(0,s.default)((0,s.default)({},t),{},{goods_info:{thumb:this.$utils.staticImg("decorate/default_goods3.jpg"),price:"334.00",title:"衬衫男女长袖夏季日系ins风文艺薄款亚麻港风男士女士小清新棉麻条纹白衬女士",has_option:0,activity_price:10,activity_stock:100,stock:100,sales:45,group_num:2,min_price:"334.00",single_buy:1,sub_title:"条纹棉麻衬衫，慵随性饭，自然、舒适、透气、吸湿散湿快，可单穿当外套搭配T恤都很好看，整个风格"}})},deep:!0,immediate:!0}},computed:{},created:function(){},mounted:function(){},methods:{}};e.default=o},3791:function(t,e,i){"use strict";i("b31a")},"39ac":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf"),i("a434"),i("d3b7"),i("e9c4"),i("159b"),i("d81d"),i("a15b");var s=a(i("1da1")),o=a(i("5530")),n=i("2f62"),r=a(i("0659")),l=a(i("1f11")),d=a(i("c80d")),c=a(i("84187")),u={name:"RulesInfo",components:{GoodsSelector:r.default,RulesGoods:l.default,LadderGroupNum:d.default,LadderRulesGoods:c.default},props:{type:{type:String,default:""},activityData:{type:Object,default:function(){}},basicInfo:{type:Object,default:function(){}},isDisabled:{type:Boolean,default:!1},id:{type:String}},data:function(){var t=this;return{model:{is_commission:"0",limit_type:"0",limit_num1:null,limit_num2:null,is_preheat:"0",preheat_time:""},rule:{goods_info:[{required:!0,type:"array",min:1,message:"请选择商品"}],"rules.limit_num1":[{validator:function(e,i,a){"1"!=t.model.rules.limit_type||i||0===i?a():a(new Error("请填写数量"))}}],"rules.limit_num2":[{validator:function(e,i,a){"2"!=t.model.rules.limit_type||i||0===i?a():a(new Error("请填写数量"))}}],preheat_time:[{required:!0,validator:function(e,i,a){var s,o,n=null===(s=t.basicInfo)||void 0===s||null===(o=s.activity_time)||void 0===o?void 0:o[0];i?n&&i>n?a(new Error("预热时间不能大于开始时间")):a():a(new Error("请设置预热时间"))}}],hour:[{required:!0,message:"拼团有效期必填"}],minute:[{required:!0,message:"拼团有效期，分钟必填"},{validator:function(e,i,a){0==t.model.hour&&0==i&&a("拼团有效期不可为0"),a()}}],"rules.success_num":[{required:!0,message:"成团人数必填"}],"rules.virtual_success_num":[{validator:function(e,i,a){if(i||a(new Error("虚拟成团人数必填")),i=parseFloat(i),0==t.model.inner_type){var s=t.model.rules.success_num||2;s<=i&&a(new Error("虚拟成团人数要小于成团人数"))}else{var o,n=(null===(o=t.model.group_num_list[t.model.group_num_list.length-1])||void 0===o?void 0:o.num)||2;n<=i&&a(new Error("虚拟成团人数要小于成团人数"))}a()}}]},goodsSelector:{value:!1},cache:{goodsList:[],ladderGoodsList:[]}}},computed:(0,o.default)((0,o.default)((0,o.default)({},(0,n.mapGetters)("config",["getAppPermMap"])),(0,n.mapState)("config",["apps"])),{},{disabledPreheat:function(){var t;return(null===(t=this.activityData)||void 0===t?void 0:t.status)&&this.activityData.status<0||"view"==this.$route.query.type},isShowGoodsList:function(){var t,e;return null===(t=this.model)||void 0===t||null===(e=t.goods_info)||void 0===e?void 0:e.length}}),created:function(){},watch:{activityData:{handler:function(t){this.model=t},immediate:!0},model:{handler:function(t){this.$emit("update:activityData",t)},deep:!0}},methods:{handleDelete:function(t){this.model.goods_info.splice(t,1)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["rules_form"].validate(function(){var a=(0,s.default)(regeneratorRuntime.mark((function a(s){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!s){a.next=16;break}if(!t.id){a.next=4;break}return e(),a.abrupt("return");case 4:if(0!=t.model.inner_type){a.next=9;break}return a.next=7,t.$refs["goods_rule"].validateForm();case 7:a.next=13;break;case 9:return a.next=11,t.$refs["ladder_group_num"].validateForm();case 11:return a.next=13,t.$refs["goods_ladder_goods"].validateForm();case 13:e(),a.next=17;break;case 16:i();case 17:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}())}))},changeTime:function(t){this.model.preheat_time=t},addGoods:function(){this.goodsSelector.value=!0},changeGoods:function(t){this.model.goods_info=t},cancelGoods:function(){this.goodsSelector.value=!1},changeType:function(t){1==t?(this.cache.goodsList=JSON.parse(JSON.stringify(this.model.goods_info)),this.model.goods_info=this.cache.ladderGoodsList):(this.cache.ladderGoodsList=JSON.parse(JSON.stringify(this.model.goods_info)),this.model.goods_info=this.cache.goodsList)},getParams:function(){var t=this.getGoodsInfoParams(),e=Object.assign({},{rules:JSON.parse(JSON.stringify(this.model.rules))},t);return e.rules.limit_time=60*this.model.hour+1*this.model.minute,e.is_preheat=this.model.is_preheat,1==e.is_preheat&&(e.preheat_time=this.model.preheat_time||""),e.inner_type=this.model.inner_type,e.rules.virtual_success_num=0==e.rules.vitrual_success?"0":e.rules.virtual_success_num,0==e.rules.limit_type?delete e.rules.limit_num:e.rules.limit_num=1==e.rules.limit_type?e.rules.limit_num1||"":e.rules.limit_num2||"",1==this.model.inner_type&&(e.rules.success_num={},this.model.group_num_list.forEach((function(t,i){e.rules.success_num[i+1]=t.num}))),delete e.rules.limit_num1,delete e.rules.limit_num2,e.rules=JSON.stringify(e.rules),console.log("params--------",e),e},getGoodsInfoParams:function(){var t=this,e=[],i=[],a=this.model.goods_info.map((function(a){e.push(a.id);var s={};return 1==a.has_option?(a.rules.forEach((function(t){i.push(t.option_id)})),s={goods_id:a.id,has_option:"1",rules:a.rules}):(s={goods_id:a.id,option_id:"0",has_option:"0",activity_stock:a.activity_stock,leader_price:a.leader_price||"-1"},0==t.model.inner_type?s.activity_price=a.activity_price:(s.activity_price="0",s.ladder_price={},t.model.group_num_list.forEach((function(t,e){s.ladder_price[e+1]=a["activity_price".concat(e+1)]})))),s}));return{goods_ids:e.join(","),option_ids:i.join(","),goods_info:a}}}};e.default=u},"3c5a":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var s=a(i("1da1"));i("d3b7"),i("a15b");var o={name:"BasicInfo",props:{data:{type:Object,default:function(){}},isDisabled:{type:Boolean,default:!1},status:{type:String,default:""},type:{type:String,default:""}},data:function(){var t=this;return{old_end_time:"",model:{title:"",client_type:[],start_time:"",end_time:""},rule:{title:[{required:!0,message:"请填写活动名称"}],client_type:[{required:!0,message:"请选择活动渠道"}],start_time:[{required:!0,message:"请选择活动开始日期"}],end_time:[{required:!0,message:"请选择活动结束日期"},{validator:function(e,i,a){i?new Date(i)<new Date(t.model.start_time)?a(new Error("结束日期不能小于开始日期")):a():a(new Error("请选择活动结束日期"))}}]},dateOptions:{disabledDate:function(e){return t.editabled?new Date(e)<=new Date(t.old_end_time):!t.model.start_time||new Date(e).getTime()+863e5<new Date(t.model.start_time).getTime()}}}},computed:{editabled:function(){return("0"==this.status||"1"==this.status)&&"edit"==this.type||"view"==this.type}},watch:{data:{handler:function(t){this.editabled&&(this.old_end_time=t.end_time),this.model=Object.assign({},t)}}},methods:{validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["form"].validate(function(){var t=(0,s.default)(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a?e():i();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},getParams:function(){return{title:this.model.title,client_type:this.model.client_type.join(","),start_time:this.model.start_time,end_time:this.model.end_time}},changeStartTime:function(t){this.model.start_time=t},changeEndTime:function(t){this.model.end_time=t}}};e.default=o},"3d60":function(t,e,i){"use strict";i.r(e);var a=i("5550"),s=i("9231");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("1448");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"24879236",null);e["default"]=r.exports},"52be":function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("ac1f"),i("1276"),i("a434"),i("d3b7");var a={name:"LadderGroupNum",props:{isDisabled:{type:Boolean,default:!1},data:{type:Array,default:function(){return[{num:2}]}}},data:function(){var t=this;return{model:{list:[]},list:[],item:{},rules:{num:[{validator:function(e,i,a){var s=e.field.split(".")[1];if(i){if(i=parseInt(i),s>0){var o,n,r=t.model.list[s-1].num,l=null===(o=t.model.list)||void 0===o||null===(n=o[s+1])||void 0===n?void 0:n.num;r&&r>=i?a("要大于上一阶梯人数"):l&&l<=i&&a("要比下一阶梯的小")}a()}else a(new Error("拼团人数不能为空"))}}]}}},mounted:function(){var t;this.model.list=null!==(t=this.data)&&void 0!==t&&t.length?this.data:[{num:2}]},watch:{},methods:{handleAdd:function(){this.model.list.push({num:""}),this.updateData()},changeNum:function(t,e){this.model.list[t].num=e.target.value,this.updateData()},handleDelete:function(){this.model.list.splice(this.model.list.length-1,1),this.updateData()},updateData:function(){this.$emit("update:data",this.model.list)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["form"].validate((function(t){t?e():i()}))}))}}};e.default=a},5550:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("kdx-modal-frame",{attrs:{title:"设置拼团商品信息",value:t.modal,width:"1020","mask-closable":!1,loading:t.loading,footerHide:t.isDisabled},on:{"on-cancel":t.handleCancel,"on-ok":t.handleOK}},[i("div",{staticClass:"multi-specification"},[i("div",{staticClass:"setting flex"},[i("span",[t._v("批量设置：")]),i("div",{staticClass:"setting-input flex"},[i("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},on:{"on-change":t.changeSeckill},model:{value:t.allSeckill,callback:function(e){t.allSeckill=e},expression:"allSeckill"}},[t._v("参与拼团 ")]),i("kdx-rr-input",{attrs:{type:"text",placeholder:"拼团库存",number:"",fixed:0,disabled:t.isDisabled,maxValue:999999999},model:{value:t.batchData.activity_stock,callback:function(e){t.$set(t.batchData,"activity_stock",e)},expression:"batchData.activity_stock"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])]),i("kdx-rr-input",{attrs:{type:"text",placeholder:"拼团价格",number:"",fixed:2,disabled:t.isDisabled,maxValue:9999999.99},model:{value:t.batchData.activity_price,callback:function(e){t.$set(t.batchData,"activity_price",e)},expression:"batchData.activity_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])]),i("kdx-rr-input",{attrs:{type:"text",placeholder:"团长价(非必填)",number:"",fixed:2,disabled:t.isDisabled,maxValue:9999999.99},model:{value:t.batchData.leader_price,callback:function(e){t.$set(t.batchData,"leader_price",e)},expression:"batchData.leader_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])]),i("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled},on:{click:t.handleBatchChange}},[t._v("应用")])],1)]),i("div",{staticClass:"table-list"},[i("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[i("Table",{ref:"table",attrs:{columns:t.columns,data:t.form.goodsList,"span-method":t.handleSpan},scopedSlots:t._u([{key:"is_join",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".is_join",rules:t.rules.is_join}},[i("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},model:{value:t.form.goodsList[a].is_join,callback:function(e){t.$set(t.form.goodsList[a],"is_join",e)},expression:"form.goodsList[index].is_join"}},[t._v("参与 ")])],1)]}},{key:"activity_stock",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".activity_stock",rules:t.rules.activity_stock}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[a].activity_stock,callback:function(e){t.$set(t.form.goodsList[a],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)]}},{key:"activity_price",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".activity_price",rules:t.rules.activity_price}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a].activity_price,callback:function(e){t.$set(t.form.goodsList[a],"activity_price",e)},expression:"form.goodsList[index].activity_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)]}},{key:"leader_price",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".leader_price",rules:t.rules.leader_price}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a].leader_price,callback:function(e){t.$set(t.form.goodsList[a],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)]}}])})],1)],1)])])},s=[]},"5d96":function(t,e,i){},"5f88":function(t,e,i){"use strict";i("68f5")},"623a":function(t,e,i){"use strict";i("c0b3")},"62fb":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("kdx-modal-frame",{attrs:{title:"设置拼团商品信息",value:t.modal,width:"1500","mask-closable":!1,loading:t.loading,footerHide:t.isDisabled},on:{"on-cancel":t.handleCancel,"on-ok":t.handleOK}},[i("div",{staticClass:"multi-specification"},[i("div",{staticClass:"setting flex"},[i("span",[t._v("批量设置：")]),i("div",{staticClass:"setting-input flex"},[i("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},on:{"on-change":t.changeSeckill},model:{value:t.allSeckill,callback:function(e){t.allSeckill=e},expression:"allSeckill"}},[t._v("参与拼团 ")]),i("kdx-rr-input",{attrs:{type:"text",placeholder:"拼团库存",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.batchData.activity_stock,callback:function(e){t.$set(t.batchData,"activity_stock",e)},expression:"batchData.activity_stock"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])]),t.ladderNum.length?t._l(t.ladderNum,(function(e,a){return i("kdx-rr-input",{key:a,attrs:{type:"text",placeholder:e.num+"人拼团价",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.batchData["activity_price"+(a+1)],callback:function(e){t.$set(t.batchData,"activity_price"+(a+1),e)},expression:"batchData[`activity_price${index + 1}`]"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])})):t._e(),i("kdx-rr-input",{attrs:{type:"text",placeholder:"团长价(非必填)",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.batchData.leader_price,callback:function(e){t.$set(t.batchData,"leader_price",e)},expression:"batchData.leader_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])]),i("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled},on:{click:t.handleBatchChange}},[t._v("应用")])],2)]),i("div",{staticClass:"table-list"},[i("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[i("Table",{ref:"table",attrs:{columns:t.columns,data:t.form.goodsList,"span-method":t.handleSpan},scopedSlots:t._u([{key:"is_join",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".is_join",rules:t.rules.is_join}},[i("Checkbox",{attrs:{"true-value":"1","false-value":"0",disabled:t.isDisabled},model:{value:t.form.goodsList[a].is_join,callback:function(e){t.$set(t.form.goodsList[a],"is_join",e)},expression:"form.goodsList[index].is_join"}},[t._v("参与 ")])],1)]}},{key:"activity_stock",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".activity_stock",rules:t.rules.activity_stock}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[a].activity_stock,callback:function(e){t.$set(t.form.goodsList[a],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)]}},{key:"activity_price",fn:function(e){var a=e.index;return[i("div",{staticClass:"flex"},[t.ladderNum.length?t._l(t.ladderNum,(function(e,s){return i("div",{key:s,staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+a+".activity_price"+(s+1),rules:t.rules["activity_price"+(s+1)]}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a]["activity_price"+(s+1)],callback:function(e){t.$set(t.form.goodsList[a],"activity_price"+(s+1),e)},expression:"form.goodsList[index][`activity_price${i+1}`]"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)})):t._e()],2)]}},{key:"leader_price",fn:function(e){var a=e.index;return[i("FormItem",{attrs:{prop:"goodsList."+a+".leader_price",rules:t.rules.leader_price}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[a].leader_price,callback:function(e){t.$set(t.form.goodsList[a],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)]}}])})],1)],1)])])},s=[]},"68f5":function(t,e,i){},"6bc4":function(t,e,i){"use strict";i.r(e);var a=i("a347"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},"6da0":function(t,e,i){"use strict";i.r(e);var a=i("2e1d"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},"7a6b":function(t,e,i){"use strict";i.r(e);var a=i("e323"),s=i("0733");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("623a");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"771f6f13",null);e["default"]=r.exports},"7f2a":function(t,e,i){"use strict";i.r(e);var a=i("d1dc"),s=i("82f4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("9eea");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"3e68ca4c",null);e["default"]=r.exports},"82f4":function(t,e,i){"use strict";i.r(e);var a=i("3210"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},84187:function(t,e,i){"use strict";i.r(e);var a=i("ea0d"),s=i("ae22");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("5f88");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"c49d3ed0",null);e["default"]=r.exports},"86c2":function(t,e,i){},"8d54":function(t,e,i){"use strict";i("2472")},"8fa0":function(t,e,i){"use strict";i.r(e);var a=i("52be"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},9231:function(t,e,i){"use strict";i.r(e);var a=i("9fd4"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},"9eea":function(t,e,i){"use strict";i("5d96")},"9fd4":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var s=a(i("1da1")),o=a(i("2909")),n=a(i("5530"));i("a9e3"),i("ac1f"),i("1276"),i("d3b7"),i("d81d"),i("99af"),i("4e82"),i("159b");var r={name:"SpecificationsRules",components:{},props:{value:{type:Boolean,default:!1},goodsId:{type:[String,Number],default:""},type:{type:String,default:""},spaceRules:{type:Array,default:function(){return[]}},isDisabled:{type:Boolean,default:!1}},data:function(){var t=this;this.$createElement;return{loading:!1,modal:!1,specs:[],form:{goodsList:[]},colspan:{0:1,1:1,2:1},batchData:{activity_stock:"",activity_price:"",leader_price:"",is_join:"0"},submitValid:!1,columns:[],defaultColumns:[{title:"售卖价",key:"price",render:function(t,e){return t("div",["￥"+e.row.price])}},{title:"总库存",key:"stock",width:80,render:function(t,e){return t("div",[e.row.stock])}},{title:"参与拼团",slot:"is_join",width:100},{title:"拼团库存",slot:"activity_stock"},{title:"拼团价格",slot:"activity_price"},{title:"团长价(非必填)",slot:"leader_price"}],rules:{is_join:[],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.price,r=o.is_join;if("1"!=r)return a();Number(n)<=Number(i)?a(new Error("拼团价格需小于售价")):"1"!=r||i?a():a(new Error("拼团价格不能为空"))}}],activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.stock,r=o.is_join;if("1"!=r)return a();Number(n)<Number(i)?a(new Error("拼团库存大于库存")):i?0===Number(i)?a(new Error("拼团库存不能为0")):a():a(new Error("拼团库存不能为空"))}}],leader_price:[{validator:function(e,i,a){var s,o;i=Number(i);var n=e.field.split(".")[1],r=t.form.goodsList[n].is_join,l=Number(null===(s=t.form.goodsList[n])||void 0===s?void 0:s.price),d=Number((null===(o=t.form.goodsList[n])||void 0===o?void 0:o.activity_price)||l);1==r&&i&&(l<=i?a(new Error("团长价格需小于售售卖价")):d<=i&&a(new Error("团长价格需小于拼团价格"))),a()}}]}}},watch:{goodsId:{handler:function(t){t&&this.getGoodsData(t)},immediate:!0},value:function(t){this.getGoodsData(this.goodsId),this.handleColumns(),this.refreshInput(),this.modal=t}},computed:{allSeckill:{get:function(){return this.form.goodsList.every((function(t){return"1"==t.is_join}))?"1":"0"},set:function(t){this.batchData.is_join=t}}},methods:{getGoodsData:function(t){var e=this;this.loading=!0,this.$api.goodsApi.getGoodInformation({id:t}).then((function(t){if(0===t.error){e.specs=t.data.spec;var i=t.data.options.map((function(t){return e.spaceRules.length>0?e.spaceRules.map((function(i){var a=e.isDisabled?"id":"option_id";t.id==i[a]&&(t.activity_stock=(null===i||void 0===i?void 0:i.activity_stock)||"",t.activity_price=(null===i||void 0===i?void 0:i.activity_price)||"",t.is_join=(null===i||void 0===i?void 0:i.is_join)||"0",t.leader_price=-1==(null===i||void 0===i?void 0:i.leader_price)?"":null===i||void 0===i?void 0:i.leader_price)})):(t.activity_stock="",t.activity_price="",t.is_join="0",t.leader_price=""),(0,n.default)({},t)}));e.handleColumns(),e.initTable(i),e.initColspan(),e.loading=!1}}))},handleColumns:function(){this.initColumns(this.defaultColumns)},initColumns:function(t){this.$createElement;var e=this.specs.map((function(t,e){return{title:t.title,key:"",render:function(t,i){return t("div",[i.row.childSpecVal[e]])}}}));this.columns=[].concat((0,o.default)(e),(0,o.default)(t))},initTable:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>1?this.form.goodsList=e.sort((function(t,e){for(var i=t.specs.split(",").map((function(t){return parseInt(t)})),a=e.specs.split(",").map((function(t){return parseInt(t)})),s=Math.min(i.length,a.length),o=0;o<s;o++)if(i[o]!==a[o])return i[o]-a[o]})):this.form.goodsList=e,this.form.goodsList.forEach((function(e){var i=[];t.specs.forEach((function(t){t.items.forEach((function(t){e.specs.indexOf(t.id)>-1&&i.push(t.title)}))})),e.childSpecVal=i}))},initColspan:function(){var t={0:1,1:1,2:1};this.specs.forEach((function(e,i){e.items.length>0&&(t[i]=e.items.length)})),t[0]=t[1]*(t[2]||1)||1,t[1]=t[2]||1,t[2]=t[2]?1:0,this.colspan=t},handleSpan:function(t){var e=t.rowIndex,i=t.columnIndex,a={rowspan:0,colspan:1};return i<this.specs.length?(e%this.colspan[i]==0&&(a={rowspan:this.colspan[i],colspan:1}),a):[1,1]},handleCancel:function(){this.modal=!1,this.$emit("input",this.modal)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["goodsForm"].validate((function(a){t.submitValid=!1,a?t.form.goodsList.some((function(t){return"1"==t.is_join}))?e():(t.$Message.error("请至少选择一个规格参加活动"),i()):i()}))}))},handleOK:function(){var t=this;return(0,s.default)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.submitValid=!0,e.next=3,t.validateForm();case 3:i={id:t.goodsId,rules:t.form.goodsList.map((function(t){return{option_id:t.id,activity_stock:t.activity_stock,activity_price:t.activity_price,leader_price:t.leader_price||"-1",is_join:t.is_join}}))},t.$emit("spaceGoods",i),t.handleCancel();case 6:case"end":return e.stop()}}),e)})))()},changeSeckill:function(t){this.form.goodsList.map((function(e){e.is_join=t}))},handleBatchChange:function(){var t=this;this.form.goodsList.forEach((function(e){t.batchData.activity_price&&(e.activity_price=t.batchData.activity_price),t.batchData.activity_stock&&(e.activity_stock=t.batchData.activity_stock),e.leader_price=t.batchData.leader_price}))},refreshInput:function(){this.batchData=(0,n.default)((0,n.default)({},this.batchData),{},{activity_stock:"",activity_price:"",leader_price:""})}}};e.default=r},a02b:function(t,e,i){"use strict";i.r(e);var a=i("1b58"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},a0a4:function(t,e,i){"use strict";i.r(e);var a=i("fe8a"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},a308:function(t,e,i){"use strict";i("c792")},a347:function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf"),i("ac1f"),i("1276"),i("d3b7"),i("5319"),i("d81d"),i("b64b"),i("159b");var s=a(i("1da1")),o=a(i("5530")),n=a(i("15fd")),r=a(i("7f2a")),l=a(i("7a6b")),d=a(i("d63a")),c=["title","client_type","start_time","end_time","preheat_time","rules","goods_info"],u={name:"index",components:{preview:r.default,basicInfo:l.default,rulesInfo:d.default},data:function(){return{activityData:{inner_type:"0",hour:"",minute:"",is_preheat:"0",preheat_time:"",rules:{success_num:2,virtual_success:"0",virtual_success_num:"",is_commission:"0",use_coupon:"0",limit_type:"0",single_buy:"1",use_platform_coupon:"0"},goods_info:[],group_num_list:[{num:2}]},basicInfoData:{title:"",client_type:[],start_time:"",end_time:""},loading:!1,submitLoading:!1,id:"",type:"",status:""}},created:function(){var t=this.$route.query,e=t.id,i=t.type;this.id=e,this.type=i,this.id&&this.getGroupsActivityDetail()},computed:{isDisabled:function(){return"add"!==this.type&&"copy"!==this.type},isSaveBtnDisabled:function(){var t,e;return"copy"!=this.type&&(-1===+(null===(t=this.activityData)||void 0===t?void 0:t.status)||-2===+(null===(e=this.activityData)||void 0===e?void 0:e.status)||"view"==this.type)}},methods:{getGroupsActivityDetail:function(){var t=this,e={id:this.id};"copy"==this.type&&(e.copy=1),this.loading=!0,this.$api.groupsApi.getGroupsActivityDetail(e).then((function(e){if(t.loading=!1,0===e.error){"copy"==t.type&&(e.data.title="副本-".concat(e.data.title));var i=e.data,a=i.title,s=i.client_type,r=i.start_time,l=i.end_time,d=i.preheat_time,u=i.rules,p=i.goods_info,f=(0,n.default)(i,c);"0000-00-00 00:00:00"==d&&(d=""),u.limit_num1="",u.limit_num2="",1==u.limit_type?u.limit_num1=u.limit_num:2==u.limit_type&&(u.limit_num2=u.limit_num),t.activityData=(0,o.default)((0,o.default)({rules:u},f),{},{preheat_time:d,goods_info:p}),t.activityData.hour=Math.floor(t.activityData.rules.limit_time/60),t.activityData.minute=t.activityData.rules.limit_time%60,t.formatLadderInfo(),t.status=f.status,t.basicInfoData={title:a,client_type:(null===s||void 0===s?void 0:s.split(","))||[],start_time:r,end_time:l}}}))},handleSave:function(){var t=this;return(0,s.default)(regeneratorRuntime.mark((function e(){var i,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.id){e.next=4;break}return e.next=4,t.$refs.basicInfo.validateForm();case 4:return e.next=6,t.$refs.rulesInfo.validateForm();case 6:i=t.$refs.basicInfo.getParams(),a=t.$refs.rulesInfo.getParams(),t.id&&"copy"!=t.type?(s={id:t.id,is_preheat:a.is_preheat,preheat_time:1==a.is_preheat?a.preheat_time:"",end_time:i.end_time},t.editActivity(s)):(o=Object.assign(i,a),t.saveActivity(o)),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),t.submitLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},saveActivity:function(t){var e=this;this.submitLoading=!0,this.$api.groupsApi.addGroupsActivity(t).then((function(t){0===t.error&&(e.$Message.success("保存成功"),e.$router.replace({path:"/groups/activity/list"}))})).finally((function(){e.submitLoading=!1}))},editActivity:function(t){var e=this;this.submitLoading=!0,this.$api.groupsApi.editGroupsActivity(t).then((function(t){0===t.error&&(e.$Message.success("编辑成功"),e.$router.replace({path:"/groups/activity/list"}))})).finally((function(){e.submitLoading=!1}))},formatLadderInfo:function(){var t=this,e=this.activityData.rules,i=this.activityData.goods_info;1==this.activityData.inner_type&&(this.activityData.group_num_list=Object.keys(e.success_num).map((function(t){return{num:e.success_num[t]}}))),i.forEach((function(e){e.has_option||(e.leader_price=-1==e.leader_price?"":e.leader_price,1==t.activityData.inner_type&&Object.keys(e.ladder_price).forEach((function(t){e["activity_price".concat(t)]=e.ladder_price[t]})))}))}}};e.default=u},a6f8:function(t,e,i){},ac33:function(t,e,i){},ae22:function(t,e,i){"use strict";i.r(e);var a=i("30d5"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},b31a:function(t,e,i){},bb47:function(t,e){t.exports="data:image/png;base64,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"},bbb4:function(t,e,i){"use strict";i.r(e);var a=i("39ac"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},bdc3:function(t,e,i){"use strict";i("86c2")},c0b3:function(t,e,i){},c792:function(t,e,i){},c80d:function(t,e,i){"use strict";i.r(e);var a=i("d85c"),s=i("8fa0");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("3791");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"8ab7505e",null);e["default"]=r.exports},c867:function(t,e,i){"use strict";i("ac33")},d050:function(t,e,i){"use strict";i.r(e);var a=i("62fb"),s=i("a0a4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("c867");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"aedcb7de",null);e["default"]=r.exports},d1dc:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview-index"},[a("div",{staticClass:"preview-title"},[t._v("拼团预览")]),a("div",{staticClass:"preview-box"},[a("div",{staticClass:"img"},[a("img",{attrs:{src:i("3084"),alt:""}})]),a("div",{staticClass:"img"},[a("img",{attrs:{src:i("bb47"),alt:""}})]),a("div",{staticClass:"goods-img"},[a("img",{attrs:{src:t.$utils.media(t.data.goods_info.thumb),alt:""},on:{error:t.replaceImage}})]),a("div",{staticClass:"detail-activity"},[a("div",{staticClass:"activity-detail-content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"price"},[a("span",{staticClass:"unit"},[t._v("￥")]),a("span",{staticClass:"price-num"},[t._v(t._s(Number(t.data.goods_info.activity_price)||20))])]),a("div",{staticClass:"group-price"},[a("div",{staticClass:"group-num"},[0==t.data.group_type?[t._v(" "+t._s(t.data.group_num)+"人拼团价 ")]:[t._v(" 人多更优惠 ")]],2),a("div",{staticClass:"del-price"},[t._v(" ￥"+t._s(t.data.goods_info.original_price||100)+" ")])]),a("span",{staticClass:"iconfont icon-pintuan2-1"})]),t._m(0)])]),a("div",{staticClass:"detail_info"},[a("div",{staticClass:"container"},[a("div",{staticClass:"title-floor floor flex"},[a("p",{staticClass:"title"},[t._v(t._s(t.data.goods_info.title))]),"1"==t.data.is_commission?a("div",{staticClass:"share-commission"},[t._m(1)]):t._e()]),t.data.goods_info.sub_title?a("div",{staticClass:"desc-floor floor"},[t._v(" "+t._s(t.data.goods_info.sub_title)+" ")]):t._e()])]),a("div",{staticClass:"detail_navbar van-hairline--top"},[t._m(2),t._m(3),a("div",{staticClass:"navbar-btn"},[1==t.data.rules.single_buy?a("div",{staticClass:"left-btn"},[a("div",{staticClass:"left-btn-desc"},[t._v("¥"+t._s(t.data.goods_info.price||999))]),a("div",{staticClass:"left-btn-label"},[t._v("单独购买")])]):t._e(),a("div",{staticClass:"right-btn"},[a("div",{staticClass:"left-btn-desc"},[t._v("¥"+t._s(t.data.goods_info.activity_price||999))]),a("span",{staticClass:"right-btn-text"},[t._v("我要开团")])])])])])])},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"right"},[i("div",{staticClass:"seckill-surplus"},[t._v("活动剩余时间")]),i("div",{staticClass:"seckill-count"},[i("span",{staticClass:"text orange"},[t._v("2天")]),i("span",{staticClass:"time"},[t._v("23")]),i("span",{staticClass:"colon orange"},[t._v(":")]),i("span",{staticClass:"time"},[t._v("23")]),i("span",{staticClass:"colon orange"},[t._v(":")]),i("span",{staticClass:"time"},[t._v("23")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"commission"},[i("p",{staticClass:"word"},[t._v("预计返利")]),i("p",{staticClass:"money"},[i("span",{staticClass:"money-unit"},[t._v("￥")]),i("span",{staticClass:"num"},[t._v("5")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btn-shop"},[i("span",{staticClass:"iconfont-m- icon-m-iconfontshop"}),i("span",{staticClass:"text"},[t._v("店铺")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btn-shop"},[i("span",{staticClass:"iconfont-m- icon-m-xingxingkongxin"}),i("span",{staticClass:"text"},[t._v("收藏")])])}]},d43d:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"groups-rules-info"},[i("Form",{ref:"rules_form",attrs:{model:t.model,"label-width":120,rules:t.rule}},[i("kdx-form-title",[t._v("规则设置")]),"1"==t.model.inner_type?i("FormItem",{attrs:{label:"成团人数："}},[i("ladder-group-num",{ref:"ladder_group_num",attrs:{data:t.model.group_num_list,"is-disabled":t.isDisabled},on:{"update:data":function(e){return t.$set(t.model,"group_num_list",e)}}})],1):t._e(),i("FormItem",{ref:"goods_info",attrs:{label:"拼团商品：",prop:"goods_info"}},[i("div",{staticClass:"next-box"},[i("Button",{staticClass:"default-primary",attrs:{disabled:t.isDisabled},on:{click:t.addGoods}},[t._v("选择拼团商品")]),i("kdx-hint-text",[t._v("提示：拼团库存不得大于商品库存，用户付款成功即扣除库存；拼团不支持会员折扣")]),t.model.goods_info&&t.model.goods_info.length>0?i("div",{staticClass:"goods-box"},["1"==t.model.inner_type?i("ladder-rules-goods",{ref:"goods_ladder_goods",attrs:{"is-disabled":t.isDisabled,type:t.type,"ladder-num":t.model.group_num_list},model:{value:t.model.goods_info,callback:function(e){t.$set(t.model,"goods_info",e)},expression:"model.goods_info"}}):i("rules-goods",{ref:"goods_rule",attrs:{"is-disabled":t.isDisabled,type:t.type},on:{delete:t.handleDelete},model:{value:t.model.goods_info,callback:function(e){t.$set(t.model,"goods_info",e)},expression:"model.goods_info"}})],1):t._e()],1)]),i("div",{staticClass:"validity"},[i("div",{staticClass:"flex"},[i("FormItem",{attrs:{label:"拼团有效期：",prop:"hour"}},[i("kdx-rr-input",{staticClass:"width-100",attrs:{placeholder:"请输入",number:"","min-value":0,maxValue:999999999,fixed:0,disabled:t.isDisabled},model:{value:t.model.hour,callback:function(e){t.$set(t.model,"hour",e)},expression:"model.hour"}}),i("span",{staticClass:"form-item-explain"},[t._v("时")])],1),i("FormItem",{attrs:{prop:"minute","label-width":0}},[i("kdx-rr-input",{staticClass:"width-100",attrs:{placeholder:"请输入",number:"","min-value":0,fixed:0,"max-value":59,disabled:t.isDisabled},model:{value:t.model.minute,callback:function(e){t.$set(t.model,"minute",e)},expression:"model.minute"}}),i("span",{staticClass:"form-item-explain"},[t._v("分")])],1)],1),i("kdx-hint-text",[t._v("用户需在有效期内成团，超时则拼团失败")])],1),"0"==t.model.inner_type?i("FormItem",{attrs:{label:"成团人数：",prop:"rules.success_num"}},[i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入2-100",number:"",fixed:0,"min-value":2,"max-value":100,disabled:t.isDisabled},model:{value:t.model.rules.success_num,callback:function(e){t.$set(t.model.rules,"success_num",e)},expression:"model.rules.success_num"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("人")])])],1):t._e(),i("FormItem",{attrs:{label:"模拟成团："}},[i("RadioGroup",{model:{value:t.model.rules.virtual_success,callback:function(e){t.$set(t.model.rules,"virtual_success",e)},expression:"model.rules.virtual_success"}},[i("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("开启")]),i("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("关闭")])],1),i("kdx-hint-text",[t._v("开启模拟成团后，拼团有效期内人数未满的团，系统将会模拟“匿名买家”凑满人数，使该团成团。")]),i("kdx-hint-text",{staticStyle:{"padding-top":"0"}},[t._v("你只需要对已付款参团的真实买家发货。建议合理开启，以提高成团率。")]),1==t.model.rules.virtual_success?i("FormItem",{staticClass:"marginB-0 paddingT-10",attrs:{label:"最多支持虚拟",prop:"rules.virtual_success_num"}},[i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入1-100",number:"",fixed:0,"min-value":1,"max-value":100,disabled:t.isDisabled},model:{value:t.model.rules.virtual_success_num,callback:function(e){t.$set(t.model.rules,"virtual_success_num",e)},expression:"model.rules.virtual_success_num"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("人")])])],1):t._e()],1),i("FormItem",{attrs:{label:"分销："}},[i("RadioGroup",{model:{value:t.model.rules.is_commission,callback:function(e){t.$set(t.model.rules,"is_commission",e)},expression:"model.rules.is_commission"}},[i("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("参与")]),i("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不参与")])],1),i("kdx-hint-text",{staticStyle:{"max-width":"610px"}},[t._v("默认不参与分销，分销开启后才能生效，如果活动内包含未设置分销的商品，选择后也不会产生分佣 ")])],1),i("FormItem",{attrs:{label:"优惠券："}},[i("RadioGroup",{model:{value:t.model.rules.use_coupon,callback:function(e){t.$set(t.model.rules,"use_coupon",e)},expression:"model.rules.use_coupon"}},[i("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("支持")]),i("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不支持")])],1),i("kdx-hint-text",[t._v("开启支持叠加使用优惠券则该活动商品支持使用平台内满足条件的优惠券")])],1),i("FormItem",{staticClass:"limit-type",attrs:{label:"限购次数："}},[i("RadioGroup",{attrs:{vertical:""},model:{value:t.model.rules.limit_type,callback:function(e){t.$set(t.model.rules,"limit_type",e)},expression:"model.rules.limit_type"}},[i("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不限制")]),i("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[i("FormItem",{staticClass:"radio-item limit1",attrs:{prop:"rules.limit_num1"}},[i("div",{staticClass:"flex"},[i("span",[t._v("活动期内每人最多购买")]),i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",number:"",fixed:0,"max-value":999999999,"min-value":1,disabled:t.isDisabled},model:{value:t.model.rules.limit_num1,callback:function(e){t.$set(t.model.rules,"limit_num1",e)},expression:"model.rules.limit_num1"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1),i("kdx-hint-text",[t._v("若开启，活动期间内每人每件商品最多支持购买数量，如商品A活动期间最多支持购买200件")])],1)],1),i("Radio",{attrs:{label:"2",disabled:t.isDisabled}},[i("FormItem",{staticClass:"radio-item limit2",attrs:{prop:"rules.limit_num2"}},[i("div",{staticClass:"flex"},[i("span",[t._v("活动期内每人每天最多购买")]),i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",number:"",fixed:0,"max-value":999999999,"min-value":1,disabled:t.isDisabled},model:{value:t.model.rules.limit_num2,callback:function(e){t.$set(t.model.rules,"limit_num2",e)},expression:"model.rules.limit_num2"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1),i("kdx-hint-text",[t._v("若开启，活动期间内每人每天针对单个商品最多购买数量，如每人每天最多购买商品A200件")])],1)],1)],1)],1),i("FormItem",{attrs:{label:"商品单购：",prop:"rules.single_buy"}},[i("RadioGroup",{model:{value:t.model.rules.single_buy,callback:function(e){t.$set(t.model.rules,"single_buy",e)},expression:"model.rules.single_buy"}},[i("Radio",{attrs:{label:"1",disabled:t.isDisabled}},[t._v("支持")]),i("Radio",{attrs:{label:"0",disabled:t.isDisabled}},[t._v("不支持")])],1),i("kdx-hint-text",[t._v("开启后，商品详情展示单独购买按钮，支持用户单独购买")])],1),i("FormItem",{attrs:{label:"活动预热：",prop:"is_preheat"}},[i("RadioGroup",{model:{value:t.model.is_preheat,callback:function(e){t.$set(t.model,"is_preheat",e)},expression:"model.is_preheat"}},[i("Radio",{attrs:{label:"1",disabled:t.disabledPreheat}},[t._v("开启")]),i("Radio",{attrs:{label:"0",disabled:t.disabledPreheat}},[t._v("不开启")])],1),i("kdx-hint-text",[t._v("开启后，商品详情展示未开始的拼团活动，但活动开始前用户无法拼团购买。")]),"1"===t.model.is_preheat?i("div",{staticClass:"next-box"},[i("FormItem",{attrs:{label:"预热时间：",prop:"preheat_time"}},[i("DatePicker",{staticClass:"width-340",attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择预热时间",disabled:t.disabledPreheat,value:t.model.preheat_time},on:{"on-change":t.changeTime}})],1)],1):t._e()],1)],1),i("goods-selector",{attrs:{multiple:!0,"current-list":t.model.goods_info,flag:"presell",show_activity:1,is_prescription:1},on:{"on-change":t.changeGoods,"on-cancel":t.cancelGoods},model:{value:t.goodsSelector.value,callback:function(e){t.$set(t.goodsSelector,"value",e)},expression:"goodsSelector.value"}})],1)},s=[]},d63a:function(t,e,i){"use strict";i.r(e);var a=i("d43d"),s=i("bbb4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("db70");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"cccdeda6",null);e["default"]=r.exports},d85c:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ladder-group-num"},[t._m(0),i("div",{staticClass:"content"},[i("Form",{ref:"form",attrs:{model:t.model,rules:t.rules},nativeOn:{submit:function(t){t.preventDefault()}}},t._l(t.model.list,(function(e,a){return i("div",{key:a,staticClass:"content-item"},[i("div",{staticClass:"name"},[t._v(" 第 "+t._s(a+1)+" 阶梯 ")]),i("div",{staticClass:"group-num"},[i("FormItem",{attrs:{prop:"list."+a+".num",rules:t.rules.num}},[i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",value:e.num,number:"",fixed:0,"min-value":1,"max-value":100,disabled:t.isDisabled},on:{"on-change":function(e){return t.changeNum(a,e)}}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("人")])])],1)],1),i("div",{staticClass:"btn-del"},[i("Button",{directives:[{name:"show",rawName:"v-show",value:0!==a&&t.model.list.length==a+1,expression:"index !== 0 && model.list.length == index+1"}],attrs:{type:"text",disabled:t.isDisabled},on:{click:t.handleDelete}},[t._v("删除")])],1)])})),0)],1),t.model.list.length<3?i("div",{staticClass:"add"},[i("Button",{attrs:{type:"text",disabled:t.isDisabled},on:{click:t.handleAdd}},[t._v(" +添加拼团阶梯( "+t._s(t.model.list.length)+" / 3) ")])],1):t._e()])},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header"},[i("div",{staticClass:"name"},[t._v(" 阶梯 ")]),i("div",{staticClass:"group-num"},[t._v(" 拼团人数 ")]),i("div",{staticClass:"btn-del"})])}]},db70:function(t,e,i){"use strict";i("a6f8")},df95:function(t,e,i){"use strict";i.r(e);var a=i("1da0"),s=i("6bc4");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("bdc3");var n=i("2877"),r=Object(n["a"])(s["default"],a["a"],a["b"],!1,null,"2d29f38e",null);e["default"]=r.exports},e323:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"seckill-basic-info"},[i("Form",{ref:"form",attrs:{model:t.model,"label-width":120,rules:t.rule},nativeOn:{submit:function(t){t.preventDefault()}}},[i("kdx-form-title",[t._v("基本信息")]),i("FormItem",{attrs:{label:"活动名称：",prop:"title"}},[i("Input",{staticClass:"width-340",class:{"input-disabled":t.isDisabled},attrs:{placeholder:"请输入活动名称",maxlength:"20","show-word-limit":"",disabled:t.isDisabled},model:{value:t.model.title,callback:function(e){t.$set(t.model,"title",e)},expression:"model.title"}})],1),i("FormItem",{attrs:{label:"活动期限：",required:""}},[i("div",{staticClass:"flex"},[i("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"start_time"}},[i("DatePicker",{staticClass:"width-250",attrs:{value:t.model.start_time,type:"datetime",placeholder:"开始时间",disabled:t.editabled},on:{"on-change":t.changeStartTime}})],1),i("div",{staticClass:"marginL-10 marginR-10"},[t._v("~")]),i("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"end_time"}},[i("DatePicker",{staticClass:"width-250",attrs:{value:t.model.end_time,options:t.dateOptions,type:"datetime",placeholder:"结束时间",disabled:"view"==t.type},on:{"on-change":t.changeEndTime}})],1)],1)]),i("FormItem",{staticClass:"r-form-item-checkbox",attrs:{label:"活动渠道：",prop:"client_type"}},[i("CheckboxGroup",{model:{value:t.model.client_type,callback:function(e){t.$set(t.model,"client_type",e)},expression:"model.client_type"}},[i("Checkbox",{attrs:{label:"20",disabled:t.isDisabled}},[t._v(" 微信公众号 ")]),i("Checkbox",{attrs:{label:"21",disabled:t.isDisabled}},[t._v(" 微信小程序 ")]),i("Checkbox",{attrs:{label:"10",disabled:t.isDisabled}},[t._v(" 手机浏览器H5 ")]),i("Checkbox",{attrs:{label:"30",disabled:t.isDisabled}},[t._v(" 头条/抖音小程序 ")])],1)],1)],1)],1)},s=[]},ea0d:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rules-goods-table"},[i("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[i("Table",{attrs:{columns:t.columns,data:t.form.goodsList},scopedSlots:t._u([{key:"shop",fn:function(e){var a=e.row;return[i("div",{staticClass:"shop-box"},[i("div",{staticClass:"image"},[i("img",{attrs:{src:t.$media(a.thumb)},on:{error:t.replaceImage}})]),i("div",{staticClass:"title-content"},[i("div",{staticClass:"content-text"},[i("span",{staticClass:"mark",style:1==a.has_option?"display:inline-block":"display:none"},[t._v("多")]),i("span",{staticClass:"mark",class:t.goodsType(a.type).goodsName},[t._v(t._s(t.goodsType(a.type).goodsText))]),i("span",{staticClass:"text"},[t._v(t._s(a.title))])])])])]}},{key:"price",fn:function(e){var a=e.row;return[i("div",{staticClass:"price"},[1==a.has_option?i("div",{staticClass:"flex-wrap"},[i("div",[t._v("￥"+t._s(a.min_price))]),i("div",[t._v("~")]),i("div",[t._v("￥"+t._s(a.max_price))])]):i("span",[t._v("￥"+t._s(a.price))])])]}},{key:"stock",fn:function(e){var a=e.row;return[i("div",[t._v(t._s(parseInt(a.stock)>999?"999+":parseInt(a.stock)))])]}},{key:"rules",fn:function(e){var a=e.row,s=e.index;return[1==a.has_option?i("div",{staticClass:"deposit-btn"},[t.isSetRules(a)?i("Button",{staticClass:"default-primary on-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("已设置（可点击修改） ")]):i("Button",{staticClass:"default-primary off-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("未设置拼团库存及价格 ")])],1):i("div",{staticClass:"flex"},[i("div",{staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+s+".activity_stock",rules:t.rules.activity_stock}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[s].activity_stock,callback:function(e){t.$set(t.form.goodsList[s],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)],1),t.ladderNum.length?t._l(t.ladderNum,(function(e,a){return i("div",{key:a,staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+s+".activity_price"+(a+1),rules:t.rules["activity_price"+(a+1)]}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s]["activity_price"+(a+1)],callback:function(e){t.$set(t.form.goodsList[s],"activity_price"+(a+1),e)},expression:"form.goodsList[index][`activity_price${i+1}`]"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)})):t._e(),i("div",{staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+s+".leader_price",rules:t.rules.leader_price}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s].leader_price,callback:function(e){t.$set(t.form.goodsList[s],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)],2)]}}])})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.form.goodsList&&t.form.goodsList.length>0,expression:"form.goodsList && form.goodsList.length > 0"}],staticClass:"footer-page"},[i("page-component",{ref:"page",attrs:{total:t.total},on:{"on-change":t.changePage}})],1),i("ladder-specifications-rules",{attrs:{goodsId:t.specificationsData.goodsId,type:t.type,"is-disabled":t.isDisabled,"ladder-num":t.ladderNum,spaceRules:t.specificationsData.spaceRules},on:{spaceGoods:t.handleSpaceGoods},model:{value:t.specificationsData.rulesModal,callback:function(e){t.$set(t.specificationsData,"rulesModal",e)},expression:"specificationsData.rulesModal"}})],1)},s=[]},f031:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rules-goods-table"},[i("Form",{ref:"goodsForm",attrs:{model:t.form,rules:t.rules}},[i("Table",{attrs:{columns:t.columns,data:t.form.goodsList},scopedSlots:t._u([{key:"shop",fn:function(e){var a=e.row;return[i("div",{staticClass:"shop-box"},[i("div",{staticClass:"image"},[i("img",{attrs:{src:t.$media(a.thumb)},on:{error:t.replaceImage}})]),i("div",{staticClass:"title-content"},[i("div",{staticClass:"content-text"},[i("span",{staticClass:"mark",style:1==a.has_option?"display:inline-block":"display:none"},[t._v("多")]),i("span",{staticClass:"mark",class:t.goodsType(a.type).goodsName},[t._v(t._s(t.goodsType(a.type).goodsText))]),i("span",{staticClass:"text"},[t._v(t._s(a.title))])])])])]}},{key:"price",fn:function(e){var a=e.row;return[i("div",{staticClass:"price"},[1==a.has_option?i("div",{staticClass:"flex-wrap"},[i("div",[t._v("￥"+t._s(a.min_price))]),i("div",[t._v("~")]),i("div",[t._v("￥"+t._s(a.max_price))])]):i("span",[t._v("￥"+t._s(a.price))])])]}},{key:"stock",fn:function(e){var a=e.row;return[i("div",[t._v(t._s(parseInt(a.stock)>999?"999+":parseInt(a.stock)))])]}},{key:"rules",fn:function(e){var a=e.row,s=e.index;return[1==a.has_option?i("div",{staticClass:"deposit-btn"},[t.isSetRules(a)?i("Button",{staticClass:"default-primary on-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("已设置（可点击修改） ")]):i("Button",{staticClass:"default-primary off-set",on:{click:function(e){return t.handleSelectOption(a.id)}}},[t._v("未设置拼团库存及价格 ")])],1):i("div",{staticClass:"flex"},[i("div",{staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+s+".activity_stock",rules:t.rules.activity_stock}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:0,maxValue:999999999,disabled:t.isDisabled},model:{value:t.form.goodsList[s].activity_stock,callback:function(e){t.$set(t.form.goodsList[s],"activity_stock",e)},expression:"form.goodsList[index].activity_stock"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("件")])])],1)],1),i("div",{staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+s+".activity_price",rules:t.rules.activity_price}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s].activity_price,callback:function(e){t.$set(t.form.goodsList[s],"activity_price",e)},expression:"form.goodsList[index].activity_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1),i("div",{staticClass:"table-input"},[i("FormItem",{attrs:{prop:"goodsList."+s+".leader_price",rules:t.rules.leader_price}},[i("kdx-rr-input",{attrs:{type:"text",number:"",fixed:2,maxValue:9999999.99,disabled:t.isDisabled},model:{value:t.form.goodsList[s].leader_price,callback:function(e){t.$set(t.form.goodsList[s],"leader_price",e)},expression:"form.goodsList[index].leader_price"}},[i("span",{attrs:{slot:"append"},slot:"append"},[t._v("元")])])],1)],1)])]}}])})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.form.goodsList&&t.form.goodsList.length>0,expression:"form.goodsList && form.goodsList.length > 0"}],staticClass:"footer-page"},[i("kdx-page-component",{ref:"page",attrs:{size:"small",total:t.total},on:{"on-change":t.changePage}})],1),i("specifications-rules",{attrs:{goodsId:t.specificationsData.goodsId,type:t.type,"is-disabled":t.isDisabled,spaceRules:t.specificationsData.spaceRules},on:{spaceGoods:t.handleSpaceGoods},model:{value:t.specificationsData.rulesModal,callback:function(e){t.$set(t.specificationsData,"rulesModal",e)},expression:"specificationsData.rulesModal"}})],1)},s=[]},f859:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("kdx-modal-frame",{attrs:{value:t.value,title:"商品选择器",width:"1000","ok-text":"保存"},on:{"on-ok":t.handleSave,"on-cancel":t.handleCancel},scopedSlots:t._u([{key:"footer",fn:function(){return[t.activity.show?i("div",{staticClass:"btn-group"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.activity.show=!1}}},[t._v("返回选择商品")])],1):t._e()]},proxy:!0}])},[i("div",{staticClass:"goods-preview"},[i("div",{ref:"scrollBox",staticClass:"goods-preview-content"},[t.activity.show?t._e():i("div",{staticClass:"search"},[i("Input",{staticClass:"width-250",attrs:{search:"","enter-button":"搜索",placeholder:"请输入"},on:{"on-search":t.handleSearch,"on-enter":t.handleSearch},model:{value:t.search.keywords,callback:function(e){t.$set(t.search,"keywords",e)},expression:"search.keywords"}})],1),t.activity.show?t._e():i("Table",{directives:[{name:"loading",rawName:"v-loading",value:t.table.loading,expression:"table.loading"}],ref:"table",attrs:{columns:t.columns,data:t.table.data}}),t.activity.show?i("Table",{ref:"activityTable",attrs:{columns:t.activity.columns,data:t.activity.data},scopedSlots:t._u([{key:"status",fn:function(e){var a=e.row;return[1===+a.status?i("kdx-status-text",{attrs:{type:"success"}},[t._v("进行中")]):t._e(),-1===+a.status?i("kdx-status-text",{attrs:{type:"danger"}},[t._v("已停止")]):t._e(),-2===+a.status?i("kdx-status-text",{attrs:{type:"danger"}},[t._v("手动停止")]):t._e(),0===+a.status?i("kdx-status-text",{attrs:{type:"warning"}},[t._v("未开始")]):t._e()]}},{key:"date",fn:function(e){var a=e.row;return[i("div",{staticClass:"time"},[t._v("起："+t._s(t.getTime(a.start_time)))]),i("div",{staticClass:"time"},[t._v("止："+t._s(t.getTime(a.end_time)))])]}}],null,!1,940490386)}):t._e()],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.table.total>10&&!t.activity.show,expression:"table.total > 10&&!activity.show"}],staticClass:"footer-page"},[i("kdx-page-component",{ref:"page",attrs:{total:t.table.total},on:{"on-change":t.handlePageChange}})],1)])])},s=[]},fe8a:function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var s=a(i("1da1")),o=a(i("2909")),n=a(i("5530"));i("a9e3"),i("ac1f"),i("1276"),i("fb6a"),i("d3b7"),i("d81d"),i("159b"),i("99af"),i("4e82");var r={name:"SpecificationsRules",components:{},props:{value:{type:Boolean,default:!1},goodsId:{type:[String,Number],default:""},type:{type:String,default:""},spaceRules:{type:Array,default:function(){return[]}},isDisabled:{type:Boolean,default:!1},ladderNum:{type:Array,default:function(){return[]}}},data:function(){var t=this;this.$createElement;return{loading:!1,modal:!1,specs:[],form:{goodsList:[]},colspan:{0:1,1:1,2:1},batchData:{activity_stock:"",activity_price1:"",activity_price2:"",activity_price3:"",leader_price:"",is_join:"0"},submitValid:!1,columns:[],specColumns:[],defaultColumns:[{title:"售卖价",key:"price",render:function(t,e){return t("div",["￥"+e.row.price])}},{title:"总库存",key:"stock",width:80,render:function(t,e){return t("div",[e.row.stock])}},{title:"参与拼团",slot:"is_join",width:100},{title:"拼团库存",slot:"activity_stock"}],ladderColumns:{},headColumn:{title:"团长价(非必填)",slot:"leader_price"},rules:{is_join:[],activity_price:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.price,r=o.is_join;if("1"!=r)return a();Number(n)<=Number(i)?a(new Error("拼团价格需小于售价")):i?a():a(new Error("拼团价格不能为空"))}}],activity_stock:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.stock,r=o.is_join;if("1"!=r)return a();Number(n)<Number(i)?a(new Error("拼团库存大于库存")):i?0===Number(i)?a(new Error("拼团库存不能为0")):a():a(new Error("拼团库存不能为空"))}}],activity_price1:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.is_join,r=parseFloat(o.price);1==n&&(i?(i=parseFloat(i),r<=i&&a(new Error("拼团价格需小于售卖价"))):a(new Error("拼团价格不能为空"))),a()}}],activity_price2:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=n.is_join,l=parseFloat(n.price);if(1==r)if(i){i=parseFloat(i),l<i&&a(new Error("拼团价格需小于售卖价"));var d=n["activity_price".concat(o)];d&&parseFloat(d)<=i&&a(new Error("阶梯拼团价要比上一阶梯小"))}else a(new Error("拼团价格不能为空"));a()}}],activity_price3:[{validator:function(e,i,a){var s=e.field.split(".")[1],o=e.field.slice(-1)-1,n=t.form.goodsList[s],r=n.is_join,l=parseFloat(n.price);if(1==r)if(i){i=parseFloat(i),l<i&&a(new Error("拼团价格需小于售卖价"));var d=n["activity_price".concat(o)];d&&d<=i&&a(new Error("阶梯拼团价要比上一阶梯小"))}else a(new Error("拼团价格不能为空"));a()}}],leader_price:[{validator:function(e,i,a){i=Number(i);var s=e.field.split(".")[1],o=t.form.goodsList[s],n=o.is_join,r=Number(null===o||void 0===o?void 0:o.price),l=Number((null===o||void 0===o?void 0:o["activity_price".concat(t.ladderNum.length)])||r);1==n&&i?r<=i?a(new Error("团长价格需小于售售卖价")):l<=i&&a(new Error("团长价格需小于拼团价格")):a(),a()}}]}}},watch:{goodsId:{handler:function(t){t&&this.getGoodsData(t)},immediate:!0},value:function(t){this.getGoodsData(this.goodsId),this.initColumns(),this.refreshInput(),this.modal=t},ladderNum:{handler:function(){this.setColumns()},immediate:!0,deep:!0}},computed:{allSeckill:{get:function(){return this.form.goodsList.every((function(t){return"1"==t.is_join}))?"1":"0"},set:function(t){this.batchData.is_join=t}}},methods:{getGoodsData:function(t){var e=this;this.loading=!0,this.$api.goodsApi.getGoodInformation({id:t}).then((function(t){if(0===t.error){e.specs=t.data.spec;var i=t.data.options.map((function(t){return e.spaceRules.length>0?e.spaceRules.map((function(i){var a=e.isDisabled?"id":"option_id";t.id==i[a]&&(t.activity_stock=(null===i||void 0===i?void 0:i.activity_stock)||"",t.is_join=(null===i||void 0===i?void 0:i.is_join)||"0",t.leader_price=-1==(null===i||void 0===i?void 0:i.leader_price)?"":null===i||void 0===i?void 0:i.leader_price,e.ladderNum.forEach((function(e,a){t["activity_price".concat(a+1)]=i.ladder_price[a+1]})))})):(t.activity_stock="",t.is_join="0",t.leader_price="",e.ladderNum.forEach((function(e,i){t["activity_price".concat(i+1)]=""}))),(0,n.default)({},t)}));e.initColumns(),e.initTable(i),e.initColspan(),e.loading=!1}}))},setColumns:function(){var t=this,e=this.$createElement,i=150*this.ladderNum.length;this.ladderColumns={slot:"activity_price",minWidth:i,renderHeader:function(){return e("div",{class:"flex"},[t.ladderNum.map((function(t){return e("p",{class:"table-title"},[t.num,"人拼团价"])}))])}},this.concatColumns()},initColumns:function(){this.$createElement;this.specColumns=this.specs.map((function(t,e){return{title:t.title,key:"",render:function(t,i){return t("div",[i.row.childSpecVal[e]])}}})),this.concatColumns()},concatColumns:function(){this.columns=[].concat((0,o.default)(this.specColumns),(0,o.default)(this.defaultColumns),[this.ladderColumns,this.headColumn])},initTable:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>1?this.form.goodsList=e.sort((function(t,e){for(var i=t.specs.split(",").map((function(t){return parseInt(t)})),a=e.specs.split(",").map((function(t){return parseInt(t)})),s=Math.min(i.length,a.length),o=0;o<s;o++)if(i[o]!==a[o])return i[o]-a[o]})):this.form.goodsList=e,this.form.goodsList.forEach((function(e){var i=[];t.specs.forEach((function(t){t.items.forEach((function(t){e.specs.indexOf(t.id)>-1&&i.push(t.title)}))})),e.childSpecVal=i}))},initColspan:function(){var t={0:1,1:1,2:1};this.specs.forEach((function(e,i){e.items.length>0&&(t[i]=e.items.length)})),t[0]=t[1]*(t[2]||1)||1,t[1]=t[2]||1,t[2]=t[2]?1:0,this.colspan=t},handleSpan:function(t){var e=t.rowIndex,i=t.columnIndex,a={rowspan:0,colspan:1};return i<this.specs.length?(e%this.colspan[i]==0&&(a={rowspan:this.colspan[i],colspan:1}),a):[1,1]},handleCancel:function(){this.modal=!1,this.$emit("input",this.modal)},validateForm:function(){var t=this;return new Promise((function(e,i){t.$refs["goodsForm"].validate((function(a){t.submitValid=!1,a?t.form.goodsList.some((function(t){return 1==t.is_join}))?e():(t.$Message.error("请至少选择一个规格参加活动"),i()):i()}))}))},handleOK:function(){var t=this;return(0,s.default)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.submitValid=!0,e.next=3,t.validateForm();case 3:i={id:t.goodsId,rules:t.form.goodsList.map((function(e){var i={option_id:e.id,activity_price:"0",activity_stock:e.activity_stock,leader_price:e.leader_price||-1,is_join:e.is_join,ladder_price:{}};return t.ladderNum.forEach((function(t,a){i.ladder_price[a+1]=e["activity_price".concat(a+1)]})),i}))},t.$emit("spaceGoods",i),t.handleCancel();case 6:case"end":return e.stop()}}),e)})))()},changeSeckill:function(t){this.form.goodsList.map((function(e){e.is_join=t}))},handleBatchChange:function(){var t=this;this.form.goodsList.forEach((function(e){t.batchData.activity_price1&&(e.activity_price1=t.batchData.activity_price1),t.batchData.activity_price2&&(e.activity_price2=t.batchData.activity_price2),t.batchData.activity_price3&&(e.activity_price3=t.batchData.activity_price3),t.batchData.activity_stock&&(e.activity_stock=t.batchData.activity_stock),e.leader_price=t.batchData.leader_price}))},refreshInput:function(){this.batchData=(0,n.default)((0,n.default)({},this.batchData),{},{activity_stock:"",activity_price1:"",activity_price2:"",activity_price3:"",leader_price:""})}}};e.default=r}}]);