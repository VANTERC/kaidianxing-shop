(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[100],{"0022":function(t,e,a){"use strict";a.r(e);var n=a("2fd2"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},1045:function(t,e,a){"use strict";a("f941")},"1a8b":function(t,e,a){"use strict";a.r(e);var n=a("f1bf"),i=a("0022");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("e238");var r=a("2877"),o=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,"36fef32e",null);e["default"]=o.exports},"243f":function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("a9e3"),a("d81d");var n={name:"TableList",props:{data:{type:Array,default:function(){return[]}},total:{type:[String,Number],default:0}},data:function(){var t=this;this.$createElement;return{columns:[{type:"selection",width:40,align:"center"},{title:"等级",key:"level",render:function(t,e){return"1"==e.row.is_default?t("div",["默认"]):t("div",[e.row.level])}},{title:"等级名称",key:"level_name"},{title:"升级条件",key:"update_text"},{title:"可享折扣权益",key:"discount",render:function(t,e){return t("div",[0==e.row.is_discount?"无":Number(e.row.discount)+"折"])}},{title:"会员数量",key:"member_count"},{title:"状态",key:"state",render:function(t,e){return t("div",[1==e.row.state?t("span",{class:"success-color"},["已启用"]):t("span",{class:"danger-color"},["未启用"])])}},{title:"操作",key:"action",width:200,render:function(e,a){return"1"==a.row.is_default?e("div",{class:"action"},[e("Button",{attrs:{type:"text"},on:{click:function(){t.lookVipStatistics(a.row)}}},["会员统计"]),e("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(){t.$router.push({path:"/member/grade/edit",query:{id:a.row.id}})}}},["编辑"])]):(n=0==a.row.state?e("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(){t.handleUsing(a.row)}}},["启用"]):e("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(){t.handleUsing(a.row)}}},["禁用"]),e("div",{class:"action"},[n,e("Button",{attrs:{type:"text"},on:{click:function(){t.lookVipStatistics(a.row)}}},["会员统计"]),e("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(){t.$router.push({path:"/member/grade/edit",query:{id:a.row.id}})}}},["编辑"]),e("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(){t.handleDelete(a.row.id)}}},["删除"])]));var n}}],selectRows:[],isSelectAll:!1}},computed:{getTableData:function(){var t=this;return this.data.map((function(e){return e._disabled=t.noManagePerm,e}))},noManagePerm:function(){return!this.$getPermMap("member.level.manage")},isDisabled:function(){return 0===this.selectRows.length}},methods:{reset:function(t){this.$refs.page.reset(t)},selectChange:function(t){this.selectRows=t,this.isSelectAll=this.selectRows.length===this.data.length},checkboxChange:function(t){this.$refs["table"].selectAll(t)},handleUsing:function(t){var e=this,a=0;a=1==t.state?0:1,this.$api.memberApi.setLevelState({state:a,id:t.id}).then((function(t){0==t.error&&(e.$Message.success("修改成功"),e.$emit("getList"))}))},handleDelete:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"确认删除？",onOk:function(){e.$api.memberApi.deleteLevel({id:t}).then((function(t){0==t.error&&(e.$Message.success("删除成功"),e.$emit("getList"))}))},onCancel:function(){}})},lookVipStatistics:function(t){this.$router.push({path:"/member/list",query:{level_id:t.id}})},changePage:function(t){this.$emit("on-page-change",t),this.initFooterData()},initFooterData:function(){this.isSelectAll=!1,this.selectRows=[]},handleBatchDelete:function(){var t=this;this.$Modal.confirm({title:"提示",content:"确认批量删除？",onOk:function(){var e=t.selectRows.map((function(t){return t.id}));t.$api.memberApi.deleteLevel({id:e}).then((function(e){0==e.error&&(t.$Message.success("删除成功"),t.$emit("getList"))}))},onCancel:function(){}})}}};e.default=n},"2fd2":function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("5530"));a("ac1f"),a("841c");var s=n(a("cb77")),r={name:"index",inject:["returnToTop"],components:{TableList:s.default},data:function(){return{search:{state:"all",keyword:""},grade:[{value:"all",name:"全部"},{value:"1",name:"启用"},{value:"0",name:"禁用"}],list:[],total:0,page:{pageSize:10,pageNumber:1},loading:!1}},computed:{noManagePerm:function(){return!this.$getPermMap("member.level.manage")}},created:function(){},mounted:function(){var t=this;this.$history.setRoute(this.$route).getData((function(e){t.$nextTick((function(){t.search=e.search||{state:"all",keyword:""},t.page=t.$utils.deepCopy(e.page)||{pageSize:10,pageNumber:1},t.$refs.tableList.reset(t.page),t.getList()}))}))},methods:{handleChange:function(t){this.search.state=t},toAddGrade:function(){this.$router.push({path:"/member/grade/add"})},getList:function(){var t=this;this.returnToTop(),this.loading=!0;var e=(0,i.default)((0,i.default)({},this.search),{},{state:"all"==this.search.state?"":this.search.state,pagesize:this.page.pageSize,page:this.page.pageNumber});this.$history.setData({search:this.$utils.deepCopy(this.search),page:this.page}),this.$api.memberApi.getLevelList(e).then((function(e){t.loading=!1,0==e.error&&(t.list=e.list,t.total=e.total)}))},addLabelGrade:function(){},handleSearch:function(){this.getList()},handleReset:function(){this.search={state:"",keyword:""},this.getList()},changePage:function(t){this.page=t,this.getList()}}};e.default=r},"59cd":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"good-group-table-list"},[a("Table",{ref:"table",attrs:{columns:t.columns,data:t.getTableData},on:{"on-selection-change":t.selectChange}}),a("div",{staticClass:"footer-action"},[a("Checkbox",{attrs:{disabled:t.noManagePerm},on:{"on-change":t.checkboxChange},model:{value:t.isSelectAll,callback:function(e){t.isSelectAll=e},expression:"isSelectAll"}}),a("Button",{attrs:{disabled:t.isDisabled||t.noManagePerm},on:{click:t.handleBatchDelete}},[t._v("删除")])],1),a("div",{staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:t.total},on:{"on-change":t.changePage}})],1)],1)},i=[]},b5aa:function(t,e,a){"use strict";a.r(e);var n=a("243f"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},cb77:function(t,e,a){"use strict";a.r(e);var n=a("59cd"),i=a("b5aa");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("1045");var r=a("2877"),o=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,"730bce81",null);e["default"]=o.exports},e238:function(t,e,a){"use strict";a("e4be")},e4be:function(t,e,a){},f1bf:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vip-grade"},[a("kdx-header-bar",{attrs:{type:"little"},scopedSlots:t._u([{key:"header",fn:function(){return[a("div",{staticClass:"flex space-between"},[a("Button",{attrs:{type:"primary",disabled:t.noManagePerm},on:{click:t.toAddGrade}},[t._v("+添加会员等级")]),a("div",{staticClass:"flex"},[a("Form",{ref:"form",attrs:{model:t.search,"label-width":100,inline:""},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"等级名称："}},[a("Input",{staticClass:"width-160",attrs:{type:"text",placeholder:"关键词查询"},on:{"on-enter":t.handleSearch},model:{value:t.search.keyword,callback:function(e){t.$set(t.search,"keyword",e)},expression:"search.keyword"}})],1),a("FormItem",{attrs:{label:"等级状态："}},[a("Select",{staticClass:"width-160",attrs:{value:t.search.state},on:{"on-change":t.handleChange}},t._l(t.grade,(function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1),a("div",{staticClass:"btn"},[a("Button",{staticClass:"mL-20",attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("搜索")]),a("Button",{staticClass:"mL-20",attrs:{type:"text"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)]},proxy:!0}])}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-list"},[a("table-list",{ref:"tableList",attrs:{data:t.list,total:t.total},on:{getList:t.getList,"on-page-change":t.changePage}})],1),t._t("default")],2)},i=[]},f941:function(t,e,a){}}]);