(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{1294:function(t,e,a){"use strict";a("e0e3")},"1b08":function(t,e,a){var s=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var n=s(a("5530")),i=s(a("1da1")),r=a("2f62"),l={props:["type"],data:function(){return{showModalFlag:!1,modalTitle:"",modalType:"",modelValue:0,deliveryType:{express:0}}},computed:{noManagePerm:function(){return!this.$getPermMap("order.dispatch.manage")}},created:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getDispatchEnable();case 2:a=e.sent,t.deliveryType=(0,n.default)({},a),"ordinaryExpress"===t.type&&(t.modelValue=(null===a||void 0===a?void 0:a.express)||0);case 5:case"end":return e.stop()}}),e)})))()},methods:(0,n.default)((0,n.default)({},(0,r.mapActions)("goodAddEdit",["getDispatchEnable"])),{},{showModal:function(){this.modalTitle="运费模板说明",this.modalType="description",this.showModalFlag=!0},handleChange:function(t){var e=this;if("ordinaryExpress"===this.type){if(0===t&&0===this.deliveryType.intracity)return this.modalTitle="系统提示",this.modalType="tips",this.showModalFlag=!0,void this.$nextTick((function(){e.modelValue=1}));this.enableExpress()}},enableExpress:function(){var t=this;this.$api.orderApi.enableExpress({enable:this.modelValue}).then((function(e){0===e.error&&t.$Message.success("修改成功")}))}})};e.default=l},"1c1e":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return n}));var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("kdx-header-bar",{attrs:{type:"little"},scopedSlots:t._u([{key:"header",fn:function(){return[a("Button",{attrs:{disabled:t.noManagePerm,type:"primary",to:"/order/ordinary-express/add"}},[t._v("+添加快递模版")])]},proxy:!0}])},[a("Form",{attrs:{"label-width":100,model:t.model,inline:""},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"关键词："}},[a("Input",{staticClass:"width-340",attrs:{type:"text",placeholder:"模板名称"},on:{"on-enter":t.handleSearch},model:{value:t.model.keyword,callback:function(e){t.$set(t.model,"keyword",e)},expression:"model.keyword"}})],1),a("FormItem",{attrs:{label:"状态："}},[a("Select",{staticClass:"width-160",model:{value:t.model.state,callback:function(e){t.$set(t.model,"state",e)},expression:"model.state"}},t._l(t.optionData.status,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),a("div",{staticClass:"ivu-form-item-btn"},[a("Button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("搜索")]),a("Button",{attrs:{type:"text"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)},n=[]},"203d":function(t,e,a){"use strict";a.r(e);var s=a("3be7"),n=a.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(i);e["default"]=n.a},2859:function(t,e,a){"use strict";a.r(e);var s=a("1c1e"),n=a("203d");for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);var r=a("2877"),l=Object(r["a"])(n["default"],s["a"],s["b"],!1,null,null,null);e["default"]=l.exports},2970:function(t,e,a){"use strict";a.r(e);var s=a("3a5a"),n=a.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(i);e["default"]=n.a},"3a5a":function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("a9e3"),a("b680"),a("d81d"),a("d3b7"),a("159b");var s={name:"TableList",props:{data:{type:Array,default:function(){return[]}},total:{type:Number,default:0}},data:function(){var t=this;this.$createElement;return{updateShopNameIndex:-1,columns:[{type:"selection",width:40,align:"center"},{title:"排序",key:"sort",width:80},{title:"名称",key:"dispatch_name",minWidth:120,render:function(t,e){var a;return"1"==e.row.is_default&&(a=t("kdx-tag-label",{attrs:{type:"info",size:"small"}},["默认"])),t("div",{class:"ordinary-express-name"},[t("span",[e.row[e.column.key]]),a])}},{title:"计费方式",key:"calculate_type",minWidth:100,render:function(t,e){return"0"==e.row[e.column.key]?t("kdx-tag-label",{attrs:{type:"warning",size:"small"}},["按重计费"]):"1"==e.row[e.column.key]?t("kdx-tag-label",{attrs:{type:"success",size:"small"}},["按件计费"]):void 0}},{title:"首(重/件)价格",key:"first_price",minWidth:90,render:function(t,e){var a;return"0"==e.row.calculate_type?a=e.row.start_weight_price:"1"==e.row.calculate_type&&(a=e.row.start_num_price),a=a?"￥".concat(parseFloat(a).toFixed(2)):"-",t("div",[a])}},{title:"续(重/件)价格",key:"price",minWidth:90,render:function(t,e){var a;return"0"==e.row.calculate_type?a=e.row.add_weight_price:"1"==e.row.calculate_type&&(a=e.row.add_num_price),a=a?"￥".concat(parseFloat(a).toFixed(2)):"-",t("div",[a])}},{title:"状态",key:"state",minWidth:80,render:function(t,e){return"0"==e.row[e.column.key]?t("kdx-status-text",{attrs:{type:"disabled"}},["未启用"]):"1"==e.row[e.column.key]?t("kdx-status-text",{attrs:{type:"success"}},["启用"]):void 0}},{title:"操作",key:"action",minWidth:120,render:function(e,a){var s,n;return n="1"!=a.row.is_default?e("Button",{attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.setDefault(a.row.id,"1")}}},["设置默认"]):e("Button",{attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.setDefault(a.row.id,"0")}}},["取消默认"]),"0"==a.row.state?s=e("Button",{attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.setStatus({id:a.row.id,type:"start",status:"1"})}}},["启用"]):"1"==a.row.state&&(s=e("Button",{attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.setStatus({id:a.row.id,type:"close",status:"0"})}}},["禁用"])),e("div",{class:"action"},[n,s,e("Button",{attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.$router.push({path:"/order/ordinary-express/edit",query:{id:a.row.id}})}}},["编辑"]),e("Button",{attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.handleDelete({id:a.row.id})}}},["删除"])])}}],selectRows:[],isSelectAll:!1}},computed:{getData:function(){var t=this;return this.data.map((function(e){return e._disabled=t.noManagePerm,e}))},selectDisabled:function(){return 0===this.selectRows.length},noManagePerm:function(){return!this.$getPermMap("order.dispatch.manage")}},methods:{handlePageChange:function(t){this.$emit("on-page-change",t)},selectChange:function(t){this.selectRows=t,this.isSelectAll=this.selectRows.length===this.data.length},checkboxChange:function(t){var e=this;this.$refs["table"].selectAll(t),this.data.forEach((function(a,s){e.$set(e.data[s],"_checked",t)})),this.selectRows=t?this.data:[]},handleDelete:function(t){var e=this,a=t.type,s=t.id;this.$Modal.confirm({title:"提示",content:"确认彻底删除此快递模版？",onOk:function(){var t;t=a&&"multiple"===a?e.selectRows.map((function(t){return t.id})):[s],e.$api.orderApi.deleteExpressStyle({ids:t}).then((function(t){0===t.error&&(e.$Message.success("快递模板删除成功"),e.$emit("on-refresh"))}))},onCancel:function(){}})},setStatus:function(t){var e,a,s=t.type,n=t.status,i=t.id;"start"===s?e="确认启用模板？":"close"===s&&(e="确认禁用模板?"),a=i?[i]:this.selectRows.map((function(t){return t.id})),this.setTemplateStatus(a,n,e)},setTemplateStatus:function(t,e,a){var s=this;this.$Modal.confirm({title:"提示",content:a,onOk:function(){s.$api.orderApi.setExpressStyleState({ids:t,state:e}).then((function(t){0===t.error&&(s.$Message.success("快递模板状态修改成功"),s.$emit("on-refresh"))}))},onCancel:function(){}})},setDefault:function(t,e){var a=this;this.$api.orderApi.setExpressStyleDefault({id:t,is_default:e}).then((function(t){0===t.error&&(a.$Message.success("快递模板默认设置成功"),a.$emit("on-refresh"))}))},reset:function(t){this.$refs["page"].reset(t),this.initFooterData()},initFooterData:function(){this.isSelectAll=!1,this.selectRows=[]}}};e.default=s},"3be7":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"SearchHeader",data:function(){return{model:{state:"all",keyword:""},optionData:{status:[{id:"all",name:"全部"},{id:"1",name:"启用"},{id:"0",name:"禁用"}]}}},computed:{noManagePerm:function(){return!this.$getPermMap("order.dispatch.manage")}},methods:{handleSearch:function(){var t=Object.assign({},this.model);t.state="all"===t.state?"":t.state,this.$emit("on-search",t)},handleReset:function(){this.$emit("on-search",{}),this.reset()},reset:function(t){this.model={state:(null===t||void 0===t?void 0:t.state)||"all",keyword:(null===t||void 0===t?void 0:t.keyword)||""}}}};e.default=a},4089:function(t,e,a){"use strict";a.r(e);var s=a("aeca"),n=a("d7e8");for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a("f7a40");var r=a("2877"),l=Object(r["a"])(n["default"],s["a"],s["b"],!1,null,"1952f5f3",null);e["default"]=l.exports},"4f9e":function(t,e,a){},"6ad9":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return n}));var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ordinary-express"},[a("delivery-type",{attrs:{type:"ordinaryExpress"}}),a("search-header",{ref:"search_header",on:{"on-search":t.handleSearch}}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.table.loading,expression:"table.loading"}],staticClass:"table-list"},[a("table-list",{ref:"table",attrs:{data:t.table.data,total:t.table.total},on:{"on-page-change":t.changePage,"on-refresh":t.refreshTable}})],1),t._t("default")],2)},n=[]},7353:function(t,e,a){"use strict";a.r(e);var s=a("7aa3"),n=a("2970");for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a("9446");var r=a("2877"),l=Object(r["a"])(n["default"],s["a"],s["b"],!1,null,null,null);e["default"]=l.exports},"7aa3":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return n}));var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"good-list-table-list"},[a("Table",{ref:"table",attrs:{columns:t.columns,data:t.getData},on:{"on-selection-change":t.selectChange}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.data.length>0,expression:"data.length > 0"}],staticClass:"footer-action"},[a("Checkbox",{attrs:{disabled:t.noManagePerm},on:{"on-change":t.checkboxChange},model:{value:t.isSelectAll,callback:function(e){t.isSelectAll=e},expression:"isSelectAll"}}),a("Button",{attrs:{disabled:t.selectDisabled},on:{click:function(e){return t.setStatus({type:"start",status:"1"})}}},[t._v("启用")]),a("Button",{attrs:{disabled:t.selectDisabled},on:{click:function(e){return t.setStatus({type:"close",status:"0"})}}},[t._v("禁用")]),a("Button",{attrs:{disabled:t.selectDisabled},on:{click:function(e){return t.handleDelete({type:"multiple"})}}},[t._v("删除")])],1),a("div",{staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:t.total},on:{"on-change":t.handlePageChange}})],1)],1)},n=[]},"7ef0":function(t,e,a){"use strict";a.r(e);var s=a("6ad9"),n=a("8308");for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a("1294");var r=a("2877"),l=Object(r["a"])(n["default"],s["a"],s["b"],!1,null,"e4a61e4e",null);e["default"]=l.exports},8308:function(t,e,a){"use strict";a.r(e);var s=a("8767"),n=a.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(i);e["default"]=n.a},8767:function(t,e,a){var s=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("ac1f"),a("841c"),a("4e82");var n=s(a("2859")),i=s(a("7353")),r=s(a("4089")),l={name:"index",inject:["returnToTop"],components:{SearchHeader:n.default,TableList:i.default,DeliveryType:r.default},data:function(){return{search:{},table:{data:[],total:0,loading:!1},page:{pageSize:10,pageNumber:1}}},methods:{handleSearch:function(t){this.search=t,this.refreshTable()},getList:function(){var t=this;this.returnToTop(),this.table.loading=!0;var e=Object.assign({pagesize:this.page.pageSize,page:this.page.pageNumber},this.search,this.sort);this.$history.setData({page:this.page,search:this.search}),this.$api.orderApi.getExpressStyleList(e).then((function(e){t.table.loading=!1,0===e.error&&(t.table.data=e.list,t.table.total=e.total)}))},refreshTable:function(t){var e;t||(this.page={pageSize:10,pageNumber:1}),null===(e=this.$refs["table"])||void 0===e||e.reset(t),this.getList()},changePage:function(t){this.page=t,this.getList()}},mounted:function(){var t=this;this.$history.setRoute(this.$route).getData((function(e){var a=e.page,s=e.search;t.search=s||{},t.page=a,t.refreshTable(a),t.$nextTick((function(){t.$refs["search_header"].reset(t.search)}))}))}};e.default=l},9446:function(t,e,a){"use strict";a("4f9e")},aeca:function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return n}));var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comp-delivery-type"},[a("div",{staticClass:"flex align-center space-between"},[a("div",{staticClass:"left"},[a("div",{staticClass:"flex left-box"},["ordinaryExpress"===t.type?a("div",{staticClass:"name"},[t._v(" 普通快递 ")]):t._e(),a("div",{staticClass:"right",staticStyle:{"margin-left":"16px"}},[a("i-switch",{attrs:{"true-value":1,"false-value":0,disabled:t.noManagePerm},on:{"on-change":t.handleChange},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}}),a("div",{staticClass:"text",class:{active:1===t.modelValue}},[t._v(" "+t._s(1===t.modelValue?"已开启":"已关闭")+" ")])],1)]),"ordinaryExpress"===t.type?a("div",{staticClass:"tips"},[t._v(" 启用后，买家下单可以选择快递发货，由商家安排快递送货上门。 "),a("span",{on:{click:t.showModal}},[t._v(" 【运费计算规则】 ")])]):t._e()])]),a("kdx-modal-frame",{attrs:{title:t.modalTitle,footerHide:!0},on:{"on-cancel":function(e){t.showModalFlag=!1}},model:{value:t.showModalFlag,callback:function(e){t.showModalFlag=e},expression:"showModalFlag"}},["description"===t.modalType?a("div",{staticClass:"modal-frame-content"},[a("div",{staticClass:"title"},[t._v("组合运费")]),a("ul",[a("li",[a("div",{staticClass:"item-title"},[t._v(" 1. 不同商品设置同一运费模板： "),a("span",[t._v("【相关所有商品按该模板设置的规则计算】")])]),a("div",{staticClass:"item-content"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"left note"},[t._v("注意")]),a("div",{staticClass:"right"},[t._v(" 不足续件或者续重的数目的时候，仍然按照续件或者续重的数目进行计算 ")])]),a("div",{staticClass:"flex"},[a("div",{staticClass:"left example"},[t._v("例子")]),a("div",{staticClass:"right"},[t._v(" 商品A，B都是用模板M（首3件10块，续2件5块）"),a("br"),t._v(" 同时购买商品2件A和2件B"),a("br"),t._v(" 运费=模板M的运费=10+5=15元 ")])])])]),a("li",[a("div",{staticClass:"item-title"},[t._v(" 2. 多种商品，分别设置不同金额的统一运费： "),a("span",[t._v("【以最高运费金额收取】")])]),a("div",{staticClass:"item-content"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"left note"},[t._v("注意")]),a("div",{staticClass:"right"},[t._v(" 不足续件或者续重的数目的时候，仍然按照续件或者续重的数目进行计算 ")])]),a("div",{staticClass:"flex"},[a("div",{staticClass:"left example"},[t._v("例子")]),a("div",{staticClass:"right"},[t._v(" 商品E，F，G的统一运费分别为1元，2元和3元"),a("br"),t._v(" 同时购买E，F，G商品 ， 运费=最大统一运费=3元 ")])])])]),a("li",[a("div",{staticClass:"item-title"},[t._v(" 3. 不同商品设置不同的运费模板： "),a("span",[t._v("【先计算Max首费模板运费+其他模板续费】")])]),a("div",{staticClass:"item-content"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"left note"},[t._v("注意")]),a("div",{staticClass:"right"},[a("span",[t._v("Max首费计算规则")]),a("br"),t._v(" 1.先对比首费，取最大首费模板"),a("br"),t._v(" 2.首费一样时对比首费平均值，取最大首费平均值"),a("br"),t._v(" 3.首费平均值一样时，对比续费，取最大续费"),a("br"),t._v(" 4.续费一样时对比续费平均值，取最大续费平均值 ")])]),a("div",{staticClass:"flex"},[a("div",{staticClass:"left example"},[t._v("例子")]),a("div",{staticClass:"right"},[t._v(" 商品C（1kg）使用用模板N（首1kg，10块，续2kg，5块），商品D（0.5kg）使用模板O（首2kg，12块，续1kg，5块），"),a("br"),t._v(" 同时购买商品（2kg）C和（1kg）D ，运费=模板O的运费+模板N的续费=（12）+（5）=17元 ")])])])]),a("li",[a("div",{staticClass:"item-title"},[t._v(" 4. 统一运费商品和运费模板商品一同结算： "),a("span",[t._v(" 【单独计算统一运费商品应收运费，再累加运费模板应收运费】 ")])]),a("div",{staticClass:"item-content"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"left example"},[t._v("例子")]),a("div",{staticClass:"right"},[t._v(" 同时购买商品2件A和2件B + （2kg）C和（1kg）D + E，F，G"),a("br"),t._v(" 运费=最大统一运费+模板O的运费+模板N的续费+模板M的续费=3+（12）+（5）+（5*2）=30元 ")])])])])])]):t._e(),"tips"===t.modalType?a("div",{staticClass:"modal-frame-content"},[a("div",{staticClass:"modal-frame-content-tips"},[t._v(" 需要开启快递发货店铺才能正常运营。 ")])]):t._e()])],1)},n=[]},d7e8:function(t,e,a){"use strict";a.r(e);var s=a("1b08"),n=a.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(i);e["default"]=n.a},d895:function(t,e,a){},e0e3:function(t,e,a){},f7a40:function(t,e,a){"use strict";a("d895")}}]);