(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[102],{1836:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"good-label"},[a("kdx-header-bar",{scopedSlots:t._u([{key:"header",fn:function(){return[a("Button",{attrs:{type:"primary",disabled:t.noManagePerm},on:{click:t.toAdd}},[t._v("添加广告图")])]},proxy:!0}])}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.table.loading,expression:"table.loading"}],staticClass:"table-list"},[a("table-list",{ref:"table_list",attrs:{data:t.getTableData,total:t.table.total},on:{"on-refresh":t.getList,"on-page-change":t.changePage,tableEdit:t.tableEdit}})],1),a("kdx-modal-frame",{attrs:{value:t.modalShow,title:t.modalTitle,width:"750","ok-text":"保存"},on:{"on-ok":t.handleSave,"on-cancel":t.handleCancel}},[a("Form",{ref:"form",staticClass:"content",attrs:{model:t.model,rules:t.rules,"label-width":140}},[a("div",{staticClass:"modal-box"},[a("FormItem",{attrs:{label:"banner名称：",prop:"name"}},[a("Input",{staticClass:"width-300",attrs:{disabled:t.noManagePerm,placeholder:"请输入",maxlength:"10","show-word-limit":""},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}})],1),a("FormItem",{attrs:{label:"广告图片：",prop:"img"}},[a("kdx-image-video",{staticClass:"bannerImg",attrs:{type:"image",current:t.model.img},on:{"on-change":function(e){return t.changeThumb(e,"img")}}})],1),a("FormItem",{attrs:{label:"图片跳转链接：",prop:"url"}},[a("Input",{staticClass:"width-300",attrs:{placeholder:"请填写跳转pc页面的访问路径"},model:{value:t.model.url,callback:function(e){t.$set(t.model,"url",e)},expression:"model.url"}})],1),a("FormItem",{attrs:{label:"广告排序：",prop:"sort_order"}},[a("Input",{staticClass:"width-300",attrs:{type:"number",placeholder:"请输入"},model:{value:t.model.sort_order,callback:function(e){t.$set(t.model,"sort_order",e)},expression:"model.sort_order"}})],1)],1)])],1),t._t("default")],2)},r=[]},"1d09":function(t,e,a){"use strict";a.r(e);var n=a("3ce3"),r=a("5f1d");for(var o in r)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("6de8");var i=a("2877"),l=Object(i["a"])(r["default"],n["a"],n["b"],!1,null,"cbfdef4c",null);e["default"]=l.exports},"3ce3":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"good-group-table-list"},[a("Table",{ref:"table",attrs:{columns:t.columns,data:t.getTableData},scopedSlots:t._u([{key:"showImg",fn:function(e){var n=e.row;return[a("img",{staticClass:"advImg",attrs:{src:t.$media(n.img),alt:""}})]}}])}),a("div",{staticClass:"footer-page"})],1)},r=[]},"5b95":function(t,e,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("a9e3"),a("d81d"),a("d3b7");var n={name:"TableList",props:{data:{type:Array,default:function(){return[]}},total:{type:Number,default:0}},data:function(){var t=this;this.$createElement;return{columns:[{title:"排序",key:"sort_order",width:100},{title:"展示图片",key:"img",slot:"showImg"},{title:"跳转链接",key:"url"},{title:"创建时间",key:"created_at"},{title:"操作",key:"action",width:200,render:function(e,a){return e("div",{class:"action"},[e("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(){t.$emit("tableEdit",a.row)}}},["编辑"]),e("Button",{attrs:{type:"text",disabled:t.noManagePerm||"1"==a.row.is_default},on:{click:function(){t.handleDelete(a.row)}}},["删除"])])}}]}},computed:{getTableData:function(){var t=this;return this.data.map((function(e){return e._disabled=t.noManagePerm,e}))},noManagePerm:function(){return!this.$getPermMap("pc.home-ads.manage")},isDisabled:function(){return 0===this.selectRows.length},selectHasDefault:function(){return this.selectRows.some((function(t){return"1"==t.is_default}))}},methods:{handleDelete:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"是否确认删除？",onOk:function(){e.$api.homeApi.advertiseDelete({id:t.id}).then((function(t){0===t.error&&(e.$Message.success("删除成功"),e.$emit("on-refresh"))})).catch()}})},initFooterData:function(){this.isSelectAll=!1,this.selectRows=[]}}};e.default=n},"5f1d":function(t,e,a){"use strict";a.r(e);var n=a("5b95"),r=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},"643a":function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(a("ade3")),o=n(a("5530"));a("d81d"),a("d3b7"),a("e9c4"),a("ac1f"),a("841c");var i=n(a("1d09")),l={name:"list",inject:["returnToTop"],components:{TableList:i.default},computed:{noManagePerm:function(){return!this.$getPermMap("pc.home-ads.manage")},getTableData:function(){var t=this;return this.table.data.map((function(e){return e._disabled=t.noManagePerm,e}))}},data:function(){return{modalShow:!1,modalTitle:"添加广告图",model:{name:"",img:"",url:"",sort_order:""},category:[],table:{data:[],loading:!1,total:0},rules:{name:[{required:!0,message:"请输入轮播名称"}],img:[{required:!0,message:"请输上传图片"}],url:[{required:!0,message:"请输入跳转链接"}],sort_order:[{required:!0,validator:function(t,e,a){e.length>4?a(new Error("最多为4位数")):e?a():a(new Error("请输入商品组排序"))}}]},optionData:{status:[{value:"all",name:"全部"},{value:"1",name:"启用"},{value:"0",name:"禁用"}]},page:{pageSize:20,pageNumber:1}}},methods:{changeThumb:function(t,e){this.$set(this.model,e,t)},validate:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise((function(a){t.$refs["form"].validate((function(n){a(n),e(n),t.$nextTick((function(){if(!n)for(var e in t.cacheError)if(!t.cacheError[e]){t.$focusError(e);break}}))}))}))},handleSave:function(){var t=this;console.log(this.model,"model"),this.validate((function(e){if(e){var a="advertiseAdd";"编辑广告图"===t.modalTitle&&(a="advertiseEdit"),t.$api.homeApi[a](t.model).then((function(e){0===e.error&&(t.handleCancel(),t.$Message.success("操作成功"),t.getList())}))}}))},showSelect:function(){},onValidate:function(t,e){this.cacheError=(0,o.default)((0,o.default)({},this.cacheError),{},(0,r.default)({},t,e))},toAdd:function(){this.modalTitle="添加广告图",this.model={name:"",img:"",url:"",sort_order:""},this.$refs.form.resetFields(),this.modalShow=!0},tableEdit:function(t){this.modalTitle="编辑广告图",this.model=JSON.parse(JSON.stringify(t)),this.modalShow=!0},handleCancel:function(){this.modalShow=!1},setStatus:function(t){this.search.status=t},handleSearch:function(){this.refreshTable()},refreshTable:function(t){t||(this.page={pageSize:10,pageNumber:1}),this.getList()},changePage:function(t){this.page=t,this.getList()},getList:function(){var t=this;this.returnToTop(),this.table.loading=!0,this.$api.homeApi.advertiseList({}).then((function(e){t.table.loading=!1,0===e.error&&(t.table.data=e.list,t.table.total=e.total)})).catch()}},mounted:function(){var t=this;this.$history.setRoute(this.$route).getData((function(e){var a=e.search,n=e.page;t.search=t.$utils.deepCopy(a)||t.search,t.page=n,t.$nextTick((function(){t.refreshTable(t.page)}))}))}};e.default=l},6798:function(t,e,a){},"6de8":function(t,e,a){"use strict";a("6798")},"9dff":function(t,e,a){},a278:function(t,e,a){"use strict";a("9dff")},b1fa:function(t,e,a){"use strict";a.r(e);var n=a("643a"),r=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},f61f:function(t,e,a){"use strict";a.r(e);var n=a("1836"),r=a("b1fa");for(var o in r)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("a278");var i=a("2877"),l=Object(i["a"])(r["default"],n["a"],n["b"],!1,null,"4c3137f2",null);e["default"]=l.exports}}]);