(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[108],{"002d":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("kdx-modal-frame",{attrs:{title:"商品组选择器",width:850},on:{"on-ok":t.handleOk,"on-cancel":t.handleCancel},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("div",{staticClass:"goods-group-selector"},[a("div",{ref:"scrollBox",staticClass:"goods-group-content"},[a("div",{staticClass:"search"},[a("Input",{staticClass:"width-250",attrs:{search:"","enter-button":"搜索",placeholder:"请输入"},on:{"on-search":t.handleSearch},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),a("Table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{columns:t.columns,data:t.data}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total>10,expression:"total > 10"}],staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:t.total},on:{"on-change":t.handlePageChange}})],1)])])},i=[]},"37c9":function(t,e,a){"use strict";a.r(e);var n=a("002d"),i=a("78c5");for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("cb10");var s=a("2877"),r=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"4c6c20d0",null);e["default"]=r.exports},"655c":function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("b85c"));a("ac1f"),a("841c"),a("4de4"),a("d3b7"),a("159b");var o={name:"GoodsGroupSelector",props:{current:{type:[String,Object],default:function(){}},currentList:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1}},data:function(){var t=this;this.$createElement;return{value:!1,search:{name:""},columns:[{title:"商品分组",key:"name"},{title:"操作",key:"action",width:80,render:function(e,a){return e("div",{class:"action"},[e("Button",{class:"default-primary",style:{display:a.row.checked?"none":"block"},on:{click:function(){t.setChecked(a.index,!0)}}},["选择"]),e("Button",{attrs:{type:"primary"},style:{display:a.row.checked?"block":"none"},on:{click:function(){t.setChecked(a.index,!1)}}},["已选"])])}}],data:[],total:0,page:{pageSize:10,pageNumber:1},selectRow:{},selectRows:[],loading:!1}},methods:{setValue:function(){this.value=!this.value,this.value&&(this.resetSearch(),this.resetPage(),this.getList())},handleSearch:function(){this.resetPage(),this.getList()},resetSearch:function(){this.search={name:""}},resetPage:function(){var t;this.page={pageSize:10,pageNumber:1},null===(t=this.$refs["page"])||void 0===t||t.reset()},setChecked:function(t,e){var a=this;this.multiple?(this.$set(this.data[t],"checked",e),0===this.selectRows.length||e?this.selectRows.push(this.data[t]):this.selectRows=this.selectRows.filter((function(e){return e.id!==a.data[t].id}))):(this.data.forEach((function(t,e){a.$set(a.data[e],"checked",!1)})),this.$set(this.data[t],"checked",e),this.selectRow=e?this.data[t]:{})},defaultChecked:function(){var t=this;this.multiple?(this.selectRows=this.currentList,this.data.forEach((function(e,a){var n,o=(0,i.default)(t.currentList);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.id===e.id){t.$set(t.data[a],"checked",!0);break}}}catch(r){o.e(r)}finally{o.f()}}))):(this.selectRow=this.current,this.data.forEach((function(e,a){t.current&&e.id===t.current.id?t.$set(t.data[a],"checked",!0):t.$set(t.data[a],"checked",!1)})))},handlePageChange:function(t){this.page=t,this.getList();try{this.$refs.scrollBox.scrollTop=0}catch(e){console.log(e)}},handleOk:function(){this.multiple?this.$emit("on-change",this.selectRows):this.$emit("on-change",this.selectRow),this.setValue()},handleCancel:function(){this.setValue()},getList:function(){var t=this;this.loading=!0;var e=Object.assign({pagesize:this.page.pageSize,page:this.page.pageNumber,status:"1",pager:1},this.search);this.$api.goodsApi.goodGroupList(e).then((function(e){0===e.error&&(t.data=e.list,t.total=e.total,t.defaultChecked(),t.loading=!1)}))}}};e.default=o},"78c5":function(t,e,a){"use strict";a.r(e);var n=a("655c"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},"9ef5":function(t,e,a){"use strict";a("da64")},b971:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"select-good-type"},[a("div",{staticClass:"type-table"},[a("Table",{attrs:{border:"",columns:t.columns,data:t.getCate,size:"small"}}),t.getCate.length?t._e():a("div",{staticClass:"add",on:{click:t.selectLink}},[t._v("+添加分组")])],1),a("group-selector",{ref:"groupSelector",attrs:{current:t.getCate[0]},on:{"on-change":t.selectGroup}})],1)},i=[]},b9f9:function(t,e,a){"use strict";a.r(e);var n=a("f52f"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},bd35:function(t,e,a){"use strict";a.r(e);var n=a("b971"),i=a("b9f9");for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("9ef5");var s=a("2877"),r=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"2859a056",null);e["default"]=r.exports},c2a6:function(t,e,a){},cb10:function(t,e,a){"use strict";a("c2a6")},da64:function(t,e,a){},f52f:function(t,e,a){var n=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("b0c0"),a("d81d");var i=n(a("53ca")),o=n(a("37c9")),s={components:{GroupSelector:o.default},props:["currentInfo"],data:function(){var t=this;this.$createElement;return{componentData:{params:{groupid:"",groupname:"",goodssort:0},data:[]},columns:[{key:"thumb",title:"分组名称",align:"left",render:function(t,e){return t("div",{class:"category"},[t("div",{class:"title"},[e.row.title])])}},{key:"option",title:"操作",align:"center",width:100,render:function(e,a){return e("p",{class:"option",style:"text-align:center;"},[e("span",{on:{click:function(){t.selectLink(a)}}},["替换"]),e("span",{on:{click:function(){t.delete(a)}}},["删除"])])}}]}},watch:{"componentData.data":{deep:!0,handler:function(){console.log("deep"),this.$emit("handleChange",this.componentData)}}},computed:{getCate:function(){if(!this.componentData.params.groupid)return[];var t=[{title:this.componentData.params.groupname,id:this.componentData.params.groupid}];return t}},created:function(){Array.isArray(this.currentInfo)||"object"!==(0,i.default)(this.currentInfo)||(this.componentData={params:{groupid:this.currentInfo.params.groupid||"",groupname:this.currentInfo.params.groupname||"",goodssort:this.currentInfo.params.goodssort||0},data:this.currentInfo.params.data||[]})},methods:{delete:function(){this.componentData={params:{groupid:"",groupname:"",goodssort:0},data:[]}},selectGroup:function(){var t,e,a,n,i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:null===(t=this.componentData.params)||void 0===t?void 0:t.groupid,name:null===(e=this.componentData.params)||void 0===e?void 0:e.groupname};if("goods"==(null===(a=this.errorInfo)||void 0===a?void 0:a.id)&&this.$emit("validateGoodsForm"),o.id){var s={0:{key:"",by:"desc"},1:{key:"sales",by:"desc"},2:{key:"price",by:"desc"},3:{key:"price",by:"asc"}};this.componentData.params.groupname=o.name,this.componentData.params.groupid=o.id;var r={pageCount:1,pagesize:50,status:1,group_id:null!==(n=null===o||void 0===o?void 0:o.id)&&void 0!==n?n:"",sort:s[this.componentData.params.goodssort].key,by:s[this.componentData.params.goodssort].by};this.$api.goodsApi.goodsList(r).then((function(t){0==t.error&&(i.componentData.data=t.list.map((function(t){return{thumb:t.thumb,price:t.price,productprice:t.original_price,sales:1*t.sales+1*t.real_sales,title:t.title,sub_title:t.sub_title,gid:t.id,bargain:0,credit:0,ctype:0}})))}))}else this.componentData.data=[]},selectLink:function(){this.$refs.groupSelector.setValue()}}};e.default=s}}]);