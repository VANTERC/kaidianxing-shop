(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[91],{"07ac":function(e,t,a){var n=a("23e7"),i=a("6f53").values;n({target:"Object",stat:!0},{values:function(e){return i(e)}})},"0fcd":function(e,t,a){"use strict";a("d33e")},4254:function(e,t,a){"use strict";a("9f055")},5639:function(e,t,a){"use strict";a.r(t);var n=a("6765"),i=a("8851");for(var l in i)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(l);a("4254");var s=a("2877"),o=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"70f3813a",null);t["default"]=o.exports},6765:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-content-bar",{scopedSlots:e._u([{key:"btn",fn:function(){return[a("Button",{staticClass:"primary-long",attrs:{disabled:e.noManagePerm},on:{click:e.submitData}},[e._v(" 提交 ")])]},proxy:!0}])},[a("div",{staticClass:"content"},[a("Tabs",{attrs:{animated:!1},model:{value:e.tabPoint,callback:function(t){e.tabPoint=t},expression:"tabPoint"}},[a("TabPane",{attrs:{label:"微信公众号 ",name:"tab1"}},[e.loaded?a("wechat-pay",{ref:"tab1",attrs:{setting:e.wechat,wechatTemp:e.wechatTemp,alipayTemp:e.alipayTemp,white_host:e.white_host,name:"wechat"},on:{submit:e.weChatSub,"on-refresh":e.handleRefresh}}):e._e()],1),a("TabPane",{attrs:{label:"微信小程序 ",name:"tab2"}},[e.loaded?a("wechat-pay",{ref:"tab2",attrs:{setting:e.wxapp,wechatTemp:e.wechatTemp,alipayTemp:e.alipayTemp,name:"wxapp"},on:{submit:e.wxappSub,"on-refresh":e.handleRefresh}}):e._e()],1),a("TabPane",{attrs:{label:"浏览器H5 支付 ",name:"tab3"}},[e.loaded?a("wechat-pay",{ref:"tab3",attrs:{setting:e.h5,wechatTemp:e.wechatTemp,alipayTemp:e.alipayTemp,name:"H5"},on:{submit:e.webSub,"on-refresh":e.handleRefresh}}):e._e()],1),a("TabPane",{attrs:{label:"头条/抖音小程序",name:"tab4"}},[e.loaded?a("wechat-pay",{ref:"tab4",attrs:{name:"byte_dance",setting:e.byte_dance,wechatTemp:e.wechatTemp,alipayTemp:e.alipayTemp},on:{submit:e.ttappSub,"on-refresh":e.handleRefresh}}):e._e()],1),a("TabPane",{attrs:{label:"PC商城",name:"tab5"}},[e.loaded?a("wechat-pay",{ref:"tab5",attrs:{setting:e.pc,wechatTemp:e.wechatTemp,alipayTemp:e.alipayTemp,white_host:e.white_host,name:"pc"},on:{submit:e.pcSub,"on-refresh":e.handleRefresh}}):e._e()],1)],1)],1)])},i=[]},"6f53":function(e,t,a){var n=a("83ab"),i=a("e330"),l=a("df75"),s=a("fc6a"),o=a("d1e7").f,d=i(o),r=i([].push),c=function(e){return function(t){var a,i=s(t),o=l(i),c=o.length,p=0,u=[];while(c>p)a=o[p++],n&&!d(i,a)||r(u,e?[a,i[a]]:i[a]);return u}};e.exports={entries:c(!0),values:c(!1)}},8470:function(e,t,a){"use strict";a.r(t);var n=a("c93c"),i=a("8b4d");for(var l in i)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(l);a("0fcd");var s=a("2877"),o=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,"ad8bf7d4",null);t["default"]=o.exports},8851:function(e,t,a){"use strict";a.r(t);var n=a("ec7e"),i=a.n(n);for(var l in n)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(l);t["default"]=i.a},"8b4d":function(e,t,a){"use strict";a.r(t);var n=a("b827"),i=a.n(n);for(var l in n)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(l);t["default"]=i.a},"9f055":function(e,t,a){},b827:function(e,t,a){var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("4de4"),a("d3b7"),a("b0c0");var i=n(a("5530")),l={name:"wxPay",props:{setting:{type:Object,default:function(){}},wechatTemp:{type:Array,default:function(){return[]}},alipayTemp:{type:Array,default:function(){return[]}},name:{type:String,default:""},white_host:{type:String,default:""}},computed:{noManagePerm:function(){return!this.$getPermMap("sysset.pay-type_set.manage")}},data:function(){return{rules:{"alipay.id":[{required:!0,message:"请选择支付宝模板"}],"wechat.id":[{required:!0,message:"请选择微信模板"}],"byte_dance.merchant_id":[{required:!0,message:"商户号必填"}],"byte_dance.salt":[{required:!0,message:"SALT必填"}],"byte_dance.token":[{required:!0,message:"Token必填"}],"balance.enable":[]},model:{wechat:{enable:"0",id:""},balance:{enable:"0",id:""},delivery:{enable:"0",id:""},alipay:{enable:"0",id:""},byte_dance:{enable:"0",id:""}}}},watch:{setting:{handler:function(e){this.model=(0,i.default)((0,i.default)({},this.model),e)},immediate:!0}},mounted:function(){var e=this.model,t=e.wechat,a=e.alipay;if("1"==t.enable){var n=this.wechatTemp.filter((function(e){return e.id==t.id}));0==n.length&&(t.id="")}if("1"==a.enable){var i=this.alipayTemp.filter((function(e){return e.id==a.id}));0==i.length&&(a.id="")}},methods:{validate:function(){var e=this,t=(0,i.default)({},this.model);"wxapp"===this.name&&t.alipay&&delete t.alipay,"H5"==this.name&&t.wechat&&delete t.wechat,"byte_dance"!=this.name||((null===t||void 0===t?void 0:t.wechat)&&delete t.wechat,(null===t||void 0===t?void 0:t.delivery)&&delete t.delivery,"0"!==t.byte_dance.enable)?this.$refs.form.validate((function(a){if(a){var n=["wechat","alipay"];n.forEach((function(e){t[e]&&"0"==t[e].enable&&delete t[e].id})),e.$emit("submit",t)}})):this.$emit("submit",t)},skipWx:function(){window.open("https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F")},skipSet:function(){window.open("https://".concat(location.host,"/web/index.php?c=profile&a=payment&"))},skipTT:function(){window.open("https://microapp.bytedance.com/")},skipManage:function(){this.$router.push("/setting/paymentSettings/mould/list")},handleRefresh:function(e){this.$emit("on-refresh",e)}}};t.default=l},c93c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{ref:"form",attrs:{"label-width":120,model:e.model,rules:e.rules}},["H5"!==e.name&&"byte_dance"!==e.name?n("div",{staticClass:"card-content"},[n("kdx-form-title",[e._v("微信支付")]),n("kdx-hint-alert",{staticClass:"alert",attrs:{"show-icon":!1}},[e._v(" 如果是微信用户，授权目录与“支付选项”中的说明不同，应在 微信商户后台->微信支付->公众号支付 追加一条支付授权目录："+e._s(e.white_host||"-")+" "),n("br"),e._v("特约商户一般没有申请订单或者充值余额退款权限，需要 "),n("Button",{attrs:{type:"text"},on:{click:e.skipWx}},[e._v("【点击跳转】")]),e._v("在这里申请一下 ")],1),n("FormItem",{attrs:{label:"微信支付:",prop:"wechat.enable"}},[n("RadioGroup",{model:{value:e.model.wechat.enable,callback:function(t){e.$set(e.model.wechat,"enable",t)},expression:"model.wechat.enable"}},[n("Radio",{attrs:{disabled:e.noManagePerm,label:"1"}},[n("span",[e._v("开启")])]),n("Radio",{attrs:{disabled:e.noManagePerm,label:"0"}},[n("span",[e._v("关闭")])])],1),"1"===e.model.wechat.enable?n("div",{staticClass:"pay-detail"},[n("FormItem",{attrs:{label:"微信支付:",prop:"wechat.id"}},[n("Select",{staticClass:"width-430",attrs:{placeholder:"请选择"},model:{value:e.model.wechat.id,callback:function(t){e.$set(e.model.wechat,"id",t)},expression:"model.wechat.id"}},e._l(e.wechatTemp,(function(e){return n("Option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),n("div",{staticClass:"right"},[n("Button",{staticClass:"refresh",attrs:{type:"text"},on:{click:function(t){return e.handleRefresh("wechat_template")}}},[e._v("刷新")]),n("Button",{staticClass:"create",attrs:{type:"text",to:"/setting/paymentSettings/mould/addMoulde?type=1",target:"_blank"}},[e._v("创建支付模板")])],1)],1):e._e()],1)],1):e._e(),"wxapp"!==e.name&&"byte_dance"!==e.name?n("div",{staticClass:"card-content"},[n("kdx-form-title",[e._v("支付宝支付")]),n("kdx-hint-alert",{staticClass:"alert",attrs:{"show-icon":!1}},[e._v(" 新版支付宝请到 "),n("Button",{attrs:{disabled:e.noManagePerm,type:"text"},on:{click:e.skipManage}},[e._v("【支付模板管理】")]),e._v("页面添加模板 ")],1),n("FormItem",{attrs:{label:"支付宝支付:"}},[n("RadioGroup",{model:{value:e.model.alipay.enable,callback:function(t){e.$set(e.model.alipay,"enable",t)},expression:"model.alipay.enable"}},[n("Radio",{attrs:{disabled:e.noManagePerm,label:"1"}},[n("span",[e._v("开启")])]),n("Radio",{attrs:{disabled:e.noManagePerm,label:"0"}},[n("span",[e._v("关闭")])])],1),"1"===e.model.alipay.enable?n("div",{staticClass:"pay-detail"},[n("FormItem",{attrs:{label:"新版支付宝：",prop:"alipay.id"}},[n("Select",{staticClass:"width-430",attrs:{placeholder:"请选择"},model:{value:e.model.alipay.id,callback:function(t){e.$set(e.model.alipay,"id",t)},expression:"model.alipay.id"}},e._l(e.alipayTemp,(function(e){return n("Option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),n("div",{staticClass:"right"},[n("Button",{staticClass:"refresh",attrs:{type:"text"},on:{click:function(t){return e.handleRefresh("alipay_template")}}},[e._v("刷新")]),n("Button",{staticClass:"create",attrs:{type:"text",to:"/setting/paymentSettings/mould/addMoulde?type=2",target:"_blank"}},[e._v("创建支付模板")])],1)],1):e._e()],1)],1):e._e(),"byte_dance"!==e.name?n("div",{staticClass:"card-content"},[n("kdx-form-title",[e._v("余额支付")]),n("kdx-hint-alert",{staticClass:"alert",attrs:{"show-icon":!1}},[e._v("开启后，粉丝可以用账户余额去商城消费.")]),n("FormItem",{attrs:{label:"余额支付:",prop:"balance.enable"}},[n("RadioGroup",{model:{value:e.model.balance.enable,callback:function(t){e.$set(e.model.balance,"enable",t)},expression:"model.balance.enable"}},[n("Radio",{attrs:{disabled:e.noManagePerm,label:"1"}},[n("span",[e._v("开启")])]),n("Radio",{attrs:{disabled:e.noManagePerm,label:"0"}},[n("span",[e._v("关闭")])])],1)],1)],1):e._e(),"byte_dance"!==e.name?n("div",{staticClass:"card-content"},[n("kdx-form-title",[e._v("货到付款")]),n("kdx-hint-alert",{staticClass:"alert",attrs:{"show-icon":!1}},[e._v("如果需支持货到付款，也需要将商品设置成货到付款.")]),n("FormItem",{attrs:{label:"货到付款:"}},[n("RadioGroup",{model:{value:e.model.delivery.enable,callback:function(t){e.$set(e.model.delivery,"enable",t)},expression:"model.delivery.enable"}},[n("Radio",{attrs:{disabled:e.noManagePerm,label:"1"}},[n("span",[e._v("开启")])]),n("Radio",{attrs:{disabled:e.noManagePerm,label:"0"}},[n("span",[e._v("关闭")])])],1)],1)],1):e._e(),"byte_dance"===e.name?n("div",{staticClass:"card-content"},[n("kdx-form-title",[e._v("字节跳动小程序担保支付")]),n("kdx-hint-alert",{staticClass:"alert",attrs:{"show-icon":!1}},[e._v(" 抖音/头条小程序支付需要在 "),n("Button",{attrs:{disabled:e.noManagePerm,type:"text"},on:{click:e.skipTT}},[e._v("【字节跳动小程序】")]),e._v("功能管理-支付版块开通担保交易， "),n("br"),e._v("开通担保交易后获得其“担保交易设置”版块的信息，填入下方 "),n("kdx-hint-tooltip",{attrs:{type:"image",image:a("e4c8")}})],1),n("FormItem",{attrs:{label:"字节担保支付:"}},[n("RadioGroup",{model:{value:e.model.byte_dance.enable,callback:function(t){e.$set(e.model.byte_dance,"enable",t)},expression:"model.byte_dance.enable"}},[n("Radio",{attrs:{disabled:e.noManagePerm,label:"1"}},[n("span",[e._v("开启")])]),n("Radio",{attrs:{disabled:e.noManagePerm,label:"0"}},[n("span",[e._v("关闭")])])],1),"1"===e.model.byte_dance.enable?n("div",{staticClass:"next-box"},[n("FormItem",{attrs:{label:"字节小程序商户号：","label-width":160,prop:"byte_dance.merchant_id"}},[n("Input",{staticClass:"width-430",attrs:{type:"text",placeholder:"请输入"},model:{value:e.model.byte_dance.merchant_id,callback:function(t){e.$set(e.model.byte_dance,"merchant_id",t)},expression:"model.byte_dance.merchant_id"}})],1),n("FormItem",{attrs:{label:"SALT：","label-width":160,prop:"byte_dance.salt"}},[n("Input",{staticClass:"width-430",attrs:{type:"text",placeholder:"请输入"},model:{value:e.model.byte_dance.salt,callback:function(t){e.$set(e.model.byte_dance,"salt",t)},expression:"model.byte_dance.salt"}})],1),n("FormItem",{attrs:{label:"Token(令牌)：","label-width":160,prop:"byte_dance.token"}},[n("Input",{staticClass:"width-430",attrs:{type:"text",placeholder:"请输入"},model:{value:e.model.byte_dance.token,callback:function(t){e.$set(e.model.byte_dance,"token",t)},expression:"model.byte_dance.token"}})],1)],1):e._e()],1)],1):e._e()])},i=[]},d33e:function(e,t,a){},e4c8:function(e,t,a){e.exports=a.p+"static/dist/shop/img/tt_pay.png"},ec7e:function(e,t,a){var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("d3b7"),a("159b"),a("07ac"),a("b64b");var i=n(a("8470")),l={name:"index",components:{WechatPay:i.default},data:function(){return{tabPoint:"tab1",h5:{},pc:{},wxapp:{},wechat:{},byte_dance:{},wechatTemp:[],alipayTemp:[],white_host:"",loaded:!1}},mounted:function(){this.getSetting()},computed:{noManagePerm:function(){return!this.$getPermMap("sysset.pay-type_set.manage")}},methods:{getSetting:function(){var e=this;this.$api.settingApi.getPaymengtSetting().then((function(t){if(0===t.error){var a=["wechat","wxapp","h5","byte_dance","pc"];a.forEach((function(a){e[a]=t[a]})),e.wechatTemp=t.wechat_template,e.alipayTemp=t.alipay_template,e.white_host=t.white_host,e.loaded=!0}}))},weChatSub:function(e){var t={wechat:e,wxapp:this.wxapp,h5:this.h5,byte_dance:this.byte_dance};this.postData(t)},pcSub:function(e){var t={wechat:this.wechat,wxapp:this.wxapp,h5:this.h5,byte_dance:this.byte_dance,pc:e};this.postData(t)},wxappSub:function(e){e.alipay&&delete e.alipay;var t={wechat:this.wechat,wxapp:e,h5:this.h5,byte_dance:this.byte_dance};this.postData(t)},webSub:function(e){var t={wechat:this.wechat,wxapp:this.wxapp,h5:e,byte_dance:this.byte_dance};this.postData(t)},ttappSub:function(e){var t={wechat:this.wechat,wxapp:this.wxapp,h5:this.h5,byte_dance:e};this.postData(t)},postData:function(e){var t=this;Object.values(e).forEach((function(e){Object.keys(e).forEach((function(t){"wechat"!=t&&"alipay"!=t||"null"!=e[t].id&&""!=e[t].id&&"0"!=e[t].enable||(delete e[t].id,e[t].enable="0")}))})),this.$api.settingApi.editPaymentSetting(e).then((function(e){0===e.error&&(t.$Message.success("操作成功"),t.getSetting())}))},submitData:function(){this.$refs[this.tabPoint].validate()},handleRefresh:function(e){var t=this;this.$api.settingApi.getPaymengtSetting().then((function(a){0===a.error&&("wechat_template"===e?t.wechatTemp=a.wechat_template:"alipay_template"===e&&(t.alipayTemp=a.alipay_template),t.$Message.success("获取模板列表成功"))}))}}};t.default=l}}]);