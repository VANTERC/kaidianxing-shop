(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{"003c":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"market-send-coupons-list"},[a("Table",{attrs:{columns:e.columns,data:e.data},scopedSlots:e._u([{key:"stock",fn:function(t){var a=t.row;return[e._v(" "+e._s("0"===a.stock_type?"不限制":parseInt(a.stock)-parseInt(a.get_total))+" ")]}}])})],1)},s=[]},"0c41c":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex activity-add-wrap"},[i("Preview",{attrs:{p_model:e.model,p_preview_credit:e.preview_credit,p_preview_balance:e.preview_balance,p_preview_redpacket:e.preview_redpacket,p_selector:e.selector}}),i("div",{staticClass:"right"},[i("kdx-content-bar",{staticClass:"content-bar-right",scopedSlots:e._u([{key:"btn",fn:function(){return[i("Button",{staticClass:"primary-long",attrs:{type:"primary",loading:e.loading,disabled:"add"!==e.type&&"edit"!==e.type},on:{click:e.handleSave}},[e._v(" 保存 ")]),i("Button",{staticClass:"default-long",attrs:{to:"/shoppingReward/activity/index"}},[e._v(" 取消 ")])]},proxy:!0}])},[i("div",{staticClass:"content"},[i("Form",{ref:"form",attrs:{model:e.model,"label-width":120,rules:e.rule}},[i("kdx-form-title",[e._v("基本信息")]),i("FormItem",{attrs:{label:"活动名称：",prop:"title"}},[i("i-input",{staticClass:"width-250",attrs:{placeholder:"请输入活动名称",disabled:"add"!==e.type},model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),i("FormItem",{staticStyle:{"margin-bottom":"0"},attrs:{label:"活动期限：",prop:"activity_time"}},[i("div",{staticClass:"flex"},[i("FormItem",{attrs:{label:"",prop:"start_time"}},[i("DatePicker",{staticClass:"width-250",attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择开始时间",disabled:"add"!==e.type},model:{value:e.model.start_time,callback:function(t){e.$set(e.model,"start_time",t)},expression:"model.start_time"}})],1),i("span",{staticStyle:{"padding-left":"10px","padding-right":"10px"}},[e._v(" ~ ")]),i("FormItem",{attrs:{label:"",prop:"end_time"}},[i("DatePicker",{staticClass:"width-250",attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择结束时间",disabled:"add"!==e.type&&"edit"!==e.type},model:{value:e.model.end_time,callback:function(t){e.$set(e.model,"end_time",t)},expression:"model.end_time"}})],1)],1)]),i("FormItem",{attrs:{label:"弹窗样式：",prop:"popup_type"}},[i("RadioGroup",{model:{value:e.model.popup_type,callback:function(t){e.$set(e.model,"popup_type",t)},expression:"model.popup_type"}},[i("Radio",{attrs:{label:"0",disabled:"add"!==e.type}},[e._v(" 样式一 ")]),i("Radio",{attrs:{label:"1",disabled:"add"!==e.type}},[e._v(" 样式二 ")])],1)],1),i("FormItem",{attrs:{label:"活动渠道：",prop:"client_type"}},[i("CheckboxGroup",{model:{value:e.model.client_type,callback:function(t){e.$set(e.model,"client_type",t)},expression:"model.client_type"}},[i("Checkbox",{attrs:{label:"20",disabled:"add"!==e.type}},[e._v(" 微信公众号 ")]),i("Checkbox",{attrs:{label:"21",disabled:"add"!==e.type}},[e._v(" 微信小程序 ")]),i("Checkbox",{attrs:{label:"10",disabled:"add"!==e.type}},[e._v(" 手机浏览器H5 ")])],1)],1),i("kdx-form-title",[e._v("规则设置")]),i("FormItem",{staticStyle:{"padding-top":"2px"},attrs:{label:"指定商品：",prop:"goods_type"}},[i("div",{staticClass:"next-box"},[i("div",[i("FormItem",{staticClass:"error-tip-nopadding",attrs:{label:"",prop:"goods_id"}},[i("div",[i("Button",{staticClass:"default-primary",attrs:{disabled:"add"!==e.type},on:{click:e.addGoods}},[e._v(" +添加商品 ")]),i("kdx-hint-text",[e._v("同一商品在同一时段内仅支持参与一个购物奖励活动")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedGoodsList.length>0,expression:"\n                                                selectedGoodsList.length > 0\n                                            "}],staticClass:"marginT-10",staticStyle:{"max-width":"610px"}},[i("shop-name-page-list",{ref:"shop_name_list",attrs:{list:e.selectedGoodsList,disabled:"add"!==e.type},on:{"on-delete":e.deleteGoods}})],1)],1)])],1)])]),i("FormItem",{attrs:{label:"适用人群：",prop:"member_type"}},[i("RadioGroup",{on:{"on-change":e.changeMemberType},model:{value:e.model.member_type,callback:function(t){e.$set(e.model,"member_type",t)},expression:"model.member_type"}},[i("Radio",{attrs:{label:"1",disabled:"add"!==e.type}},[e._v(" 会员等级 ")]),i("Radio",{attrs:{label:"2",disabled:"add"!==e.type}},[e._v(" 会员标签 ")]),i("Radio",{attrs:{label:"0",disabled:"add"!==e.type}},[e._v(" 全部会员 ")])],1),"0"!==e.model.member_type?i("div",{staticClass:"next-box"},[i("FormItem",{staticClass:"error-tip-nopadding",attrs:{prop:"member_info_id"}},[i("Button",{staticClass:"ivu-normal brand",attrs:{disabled:"add"!==e.type},on:{click:e.addMemberInfo}},[e._v(" +添加 ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedMemberList.length,expression:"selectedMemberList.length"}],staticClass:"label-list"},e._l(e.selectedMemberList,(function(t,a){return i("kdx-tag-label",{key:a,staticStyle:{margin:"0 10px 10px 0"},attrs:{type:t.level_name?"info":"warning",border:"",closable:"add"==e.type},on:{"on-close":function(t){return e.deleteMemberInfo(a)}}},[e._v(" "+e._s(t.level_name||t.group_name)+" ")])})),1)],1)],1):e._e()],1),i("FormItem",{attrs:{label:"发奖时间节点：",prop:"send_type"}},[i("RadioGroup",{model:{value:e.model.send_type,callback:function(t){e.$set(e.model,"send_type",t)},expression:"model.send_type"}},[i("Radio",{attrs:{label:"0",disabled:"add"!==e.type}},[e._v(" 下单支付成功 ")]),i("Radio",{attrs:{label:"1",disabled:"add"!==e.type}},[e._v(" 订单完成 ")])],1),i("kdx-hint-alert",{staticStyle:{"margin-top":"10px"}},[e._v(" 如果用户产生维权退款退货，已发放的奖励自动回收，如果奖励已使用则无法回收 "),i("br"),e._v(" 请注意购物奖励与消费奖励的活动同时进行时，如果用户同时满足两个活动的领取条件，弹窗提醒将重叠显示 ")])],1),i("FormItem",{attrs:{label:"优惠奖励：",prop:"reward"}},[i("CheckboxGroup",{model:{value:e.model.reward,callback:function(t){e.$set(e.model,"reward",t)},expression:"model.reward"}},[i("Checkbox",{attrs:{label:"1",disabled:"add"!==e.type}},[e._v(" 优惠券 ")]),i("Checkbox",{attrs:{label:"2",disabled:"add"!==e.type}},[e._v(" 积分 ")]),i("Checkbox",{attrs:{label:"3",disabled:"add"!==e.type}},[e._v(" 余额 ")]),i("Checkbox",{attrs:{label:"4",disabled:"add"!==e.type}},[e._v(" 红包（企业打款到零钱） ")])],1),e.model.reward.length?i("div",{staticClass:"next-box"},[new Set(e.model.reward).has("1")?i("FormItem",{attrs:{label:"优惠券选择：",prop:"coupon_ids"}},[i("Button",{staticClass:"default-primary",attrs:{disabled:"add"!==e.type},on:{click:e.showSelector}},[e._v(" "+e._s(3===e.selector.data.length?"重新选择优惠券":"+添加优惠券("+e.selector.data.length+"/3)")+" ")]),i("kdx-hint-alert",{staticStyle:{"margin-top":"10px","max-width":"610px","margin-left":"120px"}},[e._v(" 最多可选择3张优惠券且优惠券须是在有效期内 ")]),e.selector.data.length>0?i("div",{staticClass:"form-item-bg-box"},[i("div",{staticClass:"coupons-list"},[i("coupons-list",{attrs:{data:e.selector.data,showStock:!0,disabled:"add"!==e.type},on:{"on-delete":e.deleteCoupons}})],1)]):e._e()],1):e._e(),new Set(e.model.reward).has("2")?i("FormItem",{attrs:{label:"积分：",prop:"credit"}},[i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"积分",number:"",fixed:0,disabled:"add"!==e.type},model:{value:e.model.credit,callback:function(t){e.$set(e.model,"credit",t)},expression:"model.credit"}},[i("span",{attrs:{slot:"append"},slot:"append"},[e._v("积分")])])],1):e._e(),new Set(e.model.reward).has("3")?i("FormItem",{attrs:{label:"余额：",prop:"balance"}},[i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"余额",number:"",fixed:2,maxValue:9999999.99,disabled:"add"!==e.type},model:{value:e.model.balance,callback:function(t){e.$set(e.model,"balance",t)},expression:"model.balance"}},[i("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])])],1):e._e(),new Set(e.model.reward).has("4")?i("FormItem",{attrs:{label:"单个红包金额：",prop:"red_package.money"}},[i("kdx-rr-input",{staticClass:"width-160",attrs:{placeholder:"请输入",number:"",fixed:2,minValue:.3,maxValue:200,disabled:"add"!==e.type},model:{value:e.model.red_package.money,callback:function(t){e.$set(e.model.red_package,"money",t)},expression:"model.red_package.money"}},[i("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])]),i("kdx-hint-text",{staticStyle:{"margin-top":"10px","max-width":"610px","margin-left":"120px"}},[e._v(" 红包金额支持0.3-200元 ")]),i("kdx-hint-alert",{staticStyle:{"margin-top":"10px","max-width":"610px","margin-left":"120px"},attrs:{"show-icon":!1}},[e._v(" 使用发放红包功能需要商家在微信支付商户开通企业打款到零钱功能 "),i("br"),e._v("成功领取的红包将自动打款到会员的微信零钱 ")])],1):e._e(),new Set(e.model.reward).has("4")?i("FormItem",{staticClass:"redpacketTime",attrs:{label:"红包有效时间：",prop:"red_package.expiry"}},[i("div",{staticClass:"flex"},[i("span",[e._v("发放后")]),i("div",[i("kdx-rr-input",{staticClass:"width-160",staticStyle:{margin:"0 10px"},attrs:{number:"",fixed:0,"min-value":1,"max-value":30,placeholder:"请输入",disabled:"add"!==e.type},model:{value:e.model.red_package.expiry,callback:function(t){e.$set(e.model.red_package,"expiry",t)},expression:"model.red_package.expiry"}},[i("span",{attrs:{slot:"append"},slot:"append"},[e._v("天")])]),i("kdx-hint-text",{staticClass:"marginL-10"},[e._v("设置时间必须在1-30天")])],1),i("span",[e._v("内买家首次登陆商城时弹窗提示领取，过期不提示")])])]):e._e(),new Set(e.model.reward).has("4")?i("FormItem",{staticClass:"noRequired",attrs:{label:"红包祝福语：",prop:"red_package.blessing"}},[i("Input",{staticClass:"width-340",class:{"input-disabled":"add"!==e.type},attrs:{placeholder:"请输入祝福语",maxlength:"15","show-word-limit":"",disabled:"add"!==e.type},model:{value:e.model.red_package.blessing,callback:function(t){e.$set(e.model.red_package,"blessing",t)},expression:"model.red_package.blessing"}}),i("kdx-hint-tooltip",{attrs:{type:"image",image:a("71b0")}}),i("kdx-hint-text",{staticClass:"marginL-120"},[e._v("根据微信支付说明，请注意敏感词处理，否则设置敏感词会被转义成字符*")])],1):e._e()],1):e._e()],1),i("FormItem",{attrs:{label:"领取次数：",prop:"pick_times_type"}},[i("RadioGroup",{model:{value:e.model.pick_times_type,callback:function(t){e.$set(e.model,"pick_times_type",t)},expression:"model.pick_times_type"}},[i("Radio",{staticClass:"marginB-20",staticStyle:{"margin-top":"8px"},attrs:{label:"0",disabled:"add"!==e.type}},[e._v(" 不限制 ")]),i("div",{staticClass:"pick_times_type marginB-20"},[i("Radio",{attrs:{label:"1",disabled:"add"!==e.type}},[e._v(" 每人活动期间最多领取 ")]),i("FormItem",{attrs:{label:"",prop:"pick_times_limit_1"},on:{click:function(e){e.stopPropagation()}}},[i("Select",{staticClass:"width-100",attrs:{disabled:"add"!==e.type||"1"!==e.model.pick_times_type},model:{value:e.model.pick_times_limit_1,callback:function(t){e.$set(e.model,"pick_times_limit_1",t)},expression:"model.pick_times_limit_1"}},e._l(e.pickTimesList,(function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),e._v(" 次 ")],1),i("div",{staticClass:"pick_times_type"},[i("Radio",{attrs:{label:"2",disabled:"add"!==e.type}},[e._v(" 每人每天最多领取 ")]),i("FormItem",{attrs:{label:"",prop:"pick_times_limit_2"},on:{click:function(e){e.stopPropagation()}}},[i("Select",{staticClass:"width-100",attrs:{disabled:"add"!==e.type||"2"!==e.model.pick_times_type},model:{value:e.model.pick_times_limit_2,callback:function(t){e.$set(e.model,"pick_times_limit_2",t)},expression:"model.pick_times_limit_2"}},e._l(e.pickTimesList,(function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),e._v(" 次 ")],1)],1)],1)],1),i("goods-selector",{attrs:{multiple:!0,"current-list":e.selectedGoodsList,show_activity:1,is_shopping_reward:1},on:{"on-change":e.changeGoodsList,"on-cancel":e.closeGoodsSelector},model:{value:e.goodsSelector.value,callback:function(t){e.$set(e.goodsSelector,"value",t)},expression:"goodsSelector.value"}}),i("level-selector",{ref:"level_modal",attrs:{"current-list":e.selectedMemberList},on:{"on-change":e.changeMemberInfo}}),i("label-selector",{ref:"label_modal",attrs:{"current-list":e.selectedMemberList},on:{"on-change":e.changeMemberInfo}}),i("coupon-selector",{attrs:{multiple:!0,limit:3,pick_way:"4",currentList:e.selector.data},on:{"on-change":e.changeCouponList,"on-cancel":e.cancelSelector},model:{value:e.selector.value,callback:function(t){e.$set(e.selector,"value",t)},expression:"selector.value"}})],1)])],1)],1)},s=[]},"0d35":function(e,t,a){"use strict";a.r(t);var i=a("bb14"),s=a("6820");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("ea96");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"50bf1baf",null);t["default"]=o.exports},"1ab8":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("5530"));a("ac1f"),a("841c");var n=i(a("30ae")),l={components:{SearchHeader:n.default},data:function(){return{loading:!1,page:{pageSize:10,pageNumber:1},search:{activity_id:"",keyword:"",member_keyword:"",client_type:"",start_time:"",end_time:""},columns:[{title:"会员",slot:"nickname"},{title:"活动名称",key:"title"},{title:"领取时间",key:"created_at"},{title:"领取渠道",slot:"client_type"},{title:"奖励内容",slot:"reward"}],data:[],total:0}},created:function(){var e=this.$route.query,t=e.id,a=e.title;t&&a&&(this.search.activity_id=t,this.search.keyword=a),this.getShoppingRewardLog()},methods:{getShoppingRewardLog:function(){var e=this;this.loading=!0;var t=(0,s.default)((0,s.default)({},this.search),{},{pagesize:this.page.pageSize,page:this.page.pageNumber});this.$api.shoppingRewardApi.getShoppingRewardLog(t).then((function(t){e.loading=!1,0===t.error&&(e.data=t.list,e.total=t.total)}))},handleSearch:function(e){this.search.activity_id="",this.search=(0,s.default)((0,s.default)({},this.search),e),this.refreshTable()},changePage:function(e){this.page=e,this.getShoppingRewardLog()},refreshTable:function(){this.page={pageSize:10,pageNumber:1},this.$refs["page"].reset(),this.getShoppingRewardLog()}}};t.default=l},"1c3a":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("e9c4"),a("d3b7"),a("159b"),a("a434");var s=i(a("b85c")),n=i(a("2909")),l={name:"labelSelector",props:{currentList:{type:Array,default:function(){return[]}}},data:function(){return{value:!1,selectRows:[],list:[],loading:!1}},methods:{setValue:function(){this.value=!this.value,this.value&&(this.selectRows=(0,n.default)(this.currentList),this.getLabelData())},handleCancel:function(){this.setValue()},handleOk:function(){this.$emit("on-change",JSON.parse(JSON.stringify(this.selectRows))),this.setValue()},initDefaultChecked:function(){var e=this;this.selectRows.length>0&&this.list.forEach((function(t,a){var i,n=(0,s.default)(e.selectRows);try{for(n.s();!(i=n.n()).done;){var l=i.value;if(t.id===l.id){e.$set(e.list[a],"checked",!0);break}}}catch(o){n.e(o)}finally{n.f()}}))},setLabelChecked:function(e,t){var a=this;if(this.$set(this.list[e],"checked",t),t)this.selectRows.push(this.list[e]);else{var i=-1;this.selectRows.forEach((function(t,s){t.id===a.list[e].id&&(i=s)})),this.selectRows.splice(i,1)}},getLabelData:function(){var e=this;this.loading=!0,this.$api.memberApi.getGroupList({is_all:1}).then((function(t){e.loading=!1,0===t.error&&(e.list=t.list||[],e.initDefaultChecked())}))}}};t.default=l},"1e22":function(e,t,a){"use strict";a.r(t);var i=a("1c3a"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},"1ea7":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-modal-frame",{attrs:{title:"会员等级标签",loading:e.loading,"class-name":"shop-label-modal"},on:{"on-cancel":e.handleCancel,"on-ok":e.handleOk},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("div",{staticClass:"shop-label"},[a("div",{staticClass:"custom"},[e.list.length>0?a("div",{staticClass:"recommend"},[a("div",{staticClass:"label-content"},e._l(e.list,(function(t,i){return a("div",{key:i,staticClass:"shop-label-item",class:{checked:t.checked},on:{click:function(a){return e.setLabelChecked(i,!t.checked)}}},[a("span",[e._v(" "+e._s(t.level_name))]),a("kdx-svg-icon",{staticClass:"icon",attrs:{type:"icon-chenggong-shixin"}})],1)})),0)]):a("div",{staticStyle:{"text-align":"center"}},[e._v(" 暂无数据 ")])])])])},s=[]},"2a33":function(e,t,a){"use strict";a.r(t);var i=a("0c41c"),s=a("dad9");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("e627");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"d9ece428",null);t["default"]=o.exports},"2e52":function(e,t,a){"use strict";a.r(t);var i=a("e0a0"),s=a("cf30");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"35dc6e69",null);t["default"]=o.exports},"2ed5":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-header-bar",[a("Form",{ref:"form",attrs:{model:e.model,"label-width":100,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[a("FormItem",{attrs:{label:"活动名称："}},[a("i-input",{staticClass:"width-340",attrs:{type:"text",placeholder:"活动名称"},on:{"on-enter":e.handleSearch},model:{value:e.model.keyword,callback:function(t){e.$set(e.model,"keyword",t)},expression:"model.keyword"}})],1),a("FormItem",{attrs:{label:"会员："}},[a("i-input",{staticClass:"width-340",attrs:{type:"text",placeholder:"会员昵称/手机号/ID"},on:{"on-enter":e.handleSearch},model:{value:e.model.member_keyword,callback:function(t){e.$set(e.model,"member_keyword",t)},expression:"model.member_keyword"}})],1),a("FormItem",{attrs:{label:"领取渠道："}},[a("Select",{staticClass:"width-160",model:{value:e.model.client_type,callback:function(t){e.$set(e.model,"client_type",t)},expression:"model.client_type"}},e._l(e.clientTypeList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("FormItem",{attrs:{label:"领取时间："}},[a("DatePicker",{staticClass:"width-340",attrs:{type:"datetimerange",format:"yyyy-MM-dd HH:mm",placeholder:"活动时间"},on:{"on-change":e.changeDate},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),a("div",{staticClass:"ivu-form-item-btn"},[a("Button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)},s=[]},"30ae":function(e,t,a){"use strict";a.r(t);var i=a("2ed5"),s=a("a0a4");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"7b7b0f00",null);t["default"]=o.exports},"311c":function(e,t,a){},"334d":function(e,t,a){"use strict";a.r(t);var i=a("88ac"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},"389d":function(e,t,a){"use strict";a.r(t);var i=a("b20d"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},"3bde":function(e,t,a){},"40f7":function(e,t,a){"use strict";a.r(t);var i=a("9d00"),s=a("aebf");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("e171");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"3355e536",null);t["default"]=o.exports},"546c":function(e,t,a){"use strict";a("8935")},"5a19":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("5530")),n={data:function(){return{model:{keyword:"",status:"all",start_time:"",end_time:""},date:[],statusList:[{value:"all",label:"全部"},{value:"1",label:"进行中"},{value:"0",label:"未开始"},{value:"-1",label:"停止"},{value:"-2",label:"手动停止"}]}},methods:{addActivity:function(){this.$router.push({path:"/shoppingReward/activity/add",query:{}})},changeDate:function(e){this.model.start_time=e[0],this.model.end_time=e[1]},handleSearch:function(){var e=(0,s.default)({},this.model);"all"===this.model.status&&(e=(0,s.default)((0,s.default)({},e),{},{status:""})),this.$emit("on-search",e)},handleReset:function(){this.reset(),this.handleSearch()},reset:function(){this.model={keyword:"",status:"all",start_time:"",end_time:""},this.date=[]}}};t.default=n},"5c5b":function(e,t,a){},"61e0":function(e,t,a){"use strict";a.r(t);var i=a("1ab8"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},"626b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAeCAYAAAAGos/EAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAA4SURBVHgB3YsxDgAQEMDKIEZ+4MdGMYkf2iUOOa/QsU2RRuBgmWQpJCMVUfOwLDqOyO1qPOPDawNr1jQJbIusxQAAAABJRU5ErkJggg=="},6820:function(e,t,a){"use strict";a.r(t);var i=a("a7d8"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},"68d8":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("5530")),n={props:["p_model","p_preview_credit","p_preview_balance","p_selector","p_preview_redpacket"],data:function(){return{model:{title:"",activity_time:"1",start_time:"",end_time:"",client_type:[],goods_type:"0",goods_id:[],goods_cata_id:[],member_type:"0",member_info_id:[],member_level_id:[],member_group_id:[],send_type:"",reward:["1"],coupon_ids:"",credit:"",balance:"",pick_times_type:"0",pick_times_limit:"",pick_times_limit_1:"",pick_times_limit_2:"",redpacket:"",redpacket_time:""},selector:{value:!1,data:[]},preview_credit:{name:"购物奖励积分",number:"0"},preview_balance:{name:"购物奖励余额",number:"0.00"},preview_redpacket:{name:"购物奖励红包",number:"0.00"}}},watch:{p_model:{handler:function(e){this.model=(0,s.default)((0,s.default)({},this.model),e)},immediate:!0,deep:!0},p_preview_credit:{handler:function(e){this.preview_credit=(0,s.default)((0,s.default)({},this.preview_credit),e)},immediate:!0,deep:!0},p_preview_balance:{handler:function(e){this.preview_balance=(0,s.default)((0,s.default)({},this.preview_balance),e)},immediate:!0,deep:!0},p_selector:{handler:function(e){this.selector=(0,s.default)((0,s.default)({},this.selector),e)},immediate:!0,deep:!0},p_preview_redpacket:{handler:function(e){this.preview_redpacket=(0,s.default)((0,s.default)({},this.preview_redpacket),e)},immediate:!0,deep:!0}}};t.default=n},"69a7":function(e,t,a){},"6ae6":function(e,t,a){},"71b0":function(e,t,a){e.exports=a.p+"static/dist/shop/img/blessing.png"},"7c88":function(e,t,a){"use strict";a.r(t);var i=a("91a0"),s=a("61e0");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("9a22");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"1c860c04",null);t["default"]=o.exports},"83b0":function(e,t,a){"use strict";a.r(t);var i=a("1ea7"),s=a("389d");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("eec44");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"d1a95214",null);t["default"]=o.exports},"864a":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("5530")),n={props:["keyword"],computed:{noManagePerm:function(){return!this.$getPermMap("goods.index.manage")}},data:function(){return{model:{keyword:"",member_keyword:"",client_type:"all",start_time:"",end_time:""},date:[],clientTypeList:[{value:"all",label:"全部"},{value:"10",label:"手机浏览器H5"},{value:"20",label:"微信公众号"},{value:"21",label:"微信小程序"}]}},methods:{changeDate:function(e){this.model.start_time=e[0],this.model.end_time=e[1]},handleSearch:function(){var e=(0,s.default)({},this.model);"all"===this.model.client_type&&(e=(0,s.default)((0,s.default)({},e),{},{client_type:""})),this.$emit("on-search",e)},handleReset:function(){this.reset(),this.handleSearch()},reset:function(){this.model={keyword:"",member_keyword:"",client_type:"all",start_time:"",end_time:""},this.date=[]}},watch:{keyword:{handler:function(e){this.model.keyword=e},immediate:!0}}};t.default=n},"88ac":function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("ac1f"),a("841c");var s=i(a("5530")),n=i(a("2e52")),l={components:{SearchHeader:n.default},data:function(){return{loading:!1,page:{pageSize:10,pageNumber:1},search:{keyword:"",status:"",start_time:"",end_time:""},columns:[{title:"活动名称",key:"title"},{title:"活动时间",slot:"date"},{title:"停止时间",key:"stop_time"},{title:"已发放人数",slot:"send_count",width:120},{title:"活动状态",slot:"status",width:120},{title:"操作",slot:"action",width:200}],data:[],total:0}},created:function(){this.getShoppingRewardList()},methods:{getShoppingRewardList:function(){var e=this;this.loading=!0;var t=(0,s.default)((0,s.default)({},this.search),{},{pagesize:this.page.pageSize,page:this.page.pageNumber});this.$api.shoppingRewardApi.getShoppingRewardList(t).then((function(t){e.loading=!1,0===t.error&&(e.data=t.list,e.total=t.total)}))},handleSearch:function(e){this.search=(0,s.default)((0,s.default)({},this.search),e),this.refreshTable()},changePage:function(e){this.page=e,this.getShoppingRewardList()},jumpLog:function(e){this.$router.push({path:"/shoppingReward/log/index",query:{id:e.id,title:e.title}})},handleView:function(e){this.$router.push({path:"/shoppingReward/activity/view",query:{id:e}})},handleEdit:function(e){this.$router.push({path:"/shoppingReward/activity/edit",query:{id:e}})},handleStop:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确认要停该活动吗？停止后不可重新开启",onOk:function(){t.stopShoppingRewardActivity(e)},onCancel:function(){}})},stopShoppingRewardActivity:function(e){var t=this;this.$api.shoppingRewardApi.stopShoppingRewardActivity({id:e}).then((function(e){0===e.error&&(t.refreshTable(),t.$Message.success("操作成功"))}))},handleDelete:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确定要删除该活动？",onOk:function(){t.deleteShoppingRewardActivity(e)},onCancel:function(){}})},deleteShoppingRewardActivity:function(e){var t=this;this.$api.shoppingRewardApi.deleteShoppingRewardActivity({id:e}).then((function(e){0===e.error&&(t.refreshTable(),t.$Message.success("删除成功"))}))},refreshTable:function(){this.page={pageSize:10,pageNumber:1},this.$refs["page"].reset(),this.getShoppingRewardList()}}};t.default=l},"88c8":function(e,t,a){"use strict";a.r(t);var i=a("003c"),s=a("ac9f");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("cc09");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"ca8b90fc",null);t["default"]=o.exports},8935:function(e,t,a){},"8a81":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-modal-frame",{attrs:{title:"会员标签组",loading:e.loading,"class-name":"shop-label-modal"},on:{"on-cancel":e.handleCancel,"on-ok":e.handleOk},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("div",{staticClass:"shop-label"},[a("div",{staticClass:"custom"},[e.list.length>0?a("div",{staticClass:"recommend"},[a("div",{staticClass:"label-content"},e._l(e.list,(function(t,i){return a("div",{key:i,staticClass:"shop-label-item",class:{checked:t.checked},on:{click:function(a){return e.setLabelChecked(i,!t.checked)}}},[a("span",[e._v(" "+e._s(t.group_name))]),a("kdx-svg-icon",{staticClass:"icon",attrs:{type:"icon-chenggong-shixin-y"}})],1)})),0)]):a("div",{staticStyle:{"text-align":"center"}},[e._v(" 暂无数据 ")])])])])},s=[]},"91a0":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"activity-wrap"},[a("search-header",{ref:"search_header",attrs:{keyword:e.search.keyword},on:{"on-search":e.handleSearch}}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-list"},[a("Table",{ref:"table",attrs:{columns:e.columns,data:e.data},scopedSlots:e._u([{key:"nickname",fn:function(t){var i=t.row;return[a("div",{staticClass:"nickname"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.$media(i.avatar),alt:""},on:{error:function(t){return e.replaceImage(t,"avatar")}}})]),a("span",{staticClass:"text"},[e._v(e._s(i.nickname))])])]}},{key:"client_type",fn:function(t){var i=t.row;return[a("div",{staticClass:"client-type"},[a("span",{staticClass:"iconfont icon",class:{"icon-weixin":"20"===i.client_type,"icon-weixinxiaochengxu":"21"===i.client_type,"icon-H":"10"===i.client_type}}),a("span",{staticClass:"text"},[e._v(e._s(i.client_type_text))])])]}},{key:"reward",fn:function(t){var i=t.row;return[i.reward?a("div",{staticClass:"reward"},[i.reward.coupon_title&&i.reward.coupon_title.length?a("div",{staticClass:"reward-coupon mb"},e._l(i.reward.coupon_title,(function(t,i){return a("div",{key:i,staticClass:"coupon-item mb"},[e._v(" "+e._s(t)+" ")])})),0):e._e(),i.reward.red_package?a("div",{staticClass:"gifts-credit mb"},[e._v(" 红包：￥"+e._s(i.reward.red_package.money)+" ")]):e._e(),i.reward.credit?a("div",{staticClass:"reward-credit mb"},[e._v(" 积分："+e._s(i.reward.credit)+" ")]):e._e(),i.reward.balance?a("div",{staticClass:"reward-balance mb"},[e._v(" 余额：￥"+e._s(parseFloat(i.reward.balance))+" ")]):e._e()]):e._e()]}}])}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.data.length>0,expression:"data.length > 0"}],staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:e.total},on:{"on-change":e.changePage}})],1)],1),e._t("default")],2)},s=[]},"9a22":function(e,t,a){"use strict";a("6ae6")},"9c12":function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"CouponsList",props:{data:{type:Array,required:!0},disabled:{type:Boolean,default:!1},showStock:{type:Boolean,default:!1}},data:function(){return{columns:[]}},methods:{deleteCoupons:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确认删除该优惠券吗?",onOk:function(){t.$emit("on-delete",e)},onCancel:function(){}})}},watch:{showStock:{handler:function(e){var t=this;this.$createElement;this.columns=e?[{title:"优惠券名称",key:"coupon_name",minWidth:180,render:function(e,t){var i,s;return"2"===t.row.coupon_sale_type?s=[e("span","折扣券"),e("img",{attrs:{src:a("e7cd")}})]:"1"===t.row.coupon_sale_type&&(s=[e("span","满减券"),e("img",{attrs:{src:a("626b")}})]),e("div",{class:{"coupons-name":!0}},[e("div",{class:{"coupons-type":!0,deduction:"2"===t.row.coupon_sale_type,"full-reduction":"1"===t.row.coupon_sale_type}},s),e("div",{class:{"coupons-name-content":!0}},[e("p",{class:{name:!0}},t.row[t.column.key]),e("p",{class:{content:!0}},null===(i=t.row)||void 0===i?void 0:i.content)])])}},{title:"库存",slot:"stock",width:80},{title:"操作",key:"action",width:60,render:function(e,a){return e("Button",{attrs:{type:"text",disabled:t.disabled},on:{click:function(){t.deleteCoupons(a.index)}}},["删除"])}}]:[{title:"优惠券名称",key:"coupon_name",minWidth:180,render:function(e,t){var i,s;return"2"===t.row.coupon_sale_type?s=[e("span","折扣券"),e("img",{attrs:{src:a("e7cd")}})]:"1"===t.row.coupon_sale_type&&(s=[e("span","满减券"),e("img",{attrs:{src:a("626b")}})]),e("div",{class:{"coupons-name":!0}},[e("div",{class:{"coupons-type":!0,deduction:"2"===t.row.coupon_sale_type,"full-reduction":"1"===t.row.coupon_sale_type}},s),e("div",{class:{"coupons-name-content":!0}},[e("p",{class:{name:!0}},t.row[t.column.key]),e("p",{class:{content:!0}},null===(i=t.row)||void 0===i?void 0:i.content)])])}},{title:"操作",key:"action",width:60,render:function(e,a){return e("Button",{attrs:{type:"text",disabled:t.disabled},on:{click:function(){t.deleteCoupons(a.index)}}},["删除"])}}]},immediate:!0}}};t.default=i},"9d00":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"left"},[a("div",{staticClass:"preview-title"},[e._v("购物奖励预览")]),a("div",{staticClass:"preview-box"},[a("div",{staticClass:"mask"}),a("div",{staticClass:"coupon-box",class:"0"==e.p_model.popup_type?"":"newBg"},["0"==e.p_model.popup_type?a("div",{staticClass:"activity-name"},[e._v("购物奖励")]):e._e(),a("div",{staticClass:"coupon-box-content",class:"0"==e.p_model.popup_type?"":"newBg"},["0"==e.model.popup_type?a("div",{staticClass:"top-bg"}):e._e(),a("div",{staticClass:"scroll-box",class:"0"==e.model.popup_type?"":"newBg"},[new Set(e.model.reward).has("1")&&e.selector.data.length>0?a("ul",{staticClass:"coupon-list"},e._l(e.selector.data,(function(t,i){return a("li",{key:i,staticClass:"item",class:"0"==e.model.popup_type?"":"newBg"},[a("div",{staticClass:"item-left"},["1"===t.coupon_sale_type?a("span",{staticClass:"unit",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" ￥ ")]):e._e(),a("span",{staticClass:"price",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(parseFloat(t.discount_price))+" ")]),"2"===t.coupon_sale_type?a("span",{staticClass:"unit",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" 折 ")]):e._e()]),a("div",{staticClass:"item-right"},[a("div",{staticClass:"tit",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(t.coupon_name)+" ")]),a("div",{staticClass:"desc",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(t.content)+" ")])])])})),0):e._e(),new Set(e.model.reward).has("2")?a("div",{staticClass:"other"},[a("div",{staticClass:"other-tit",class:"0"==e.p_model.popup_type?"":"newBg"},["0"==e.p_model.popup_type?a("div",{staticClass:"line"},e._l(10,(function(e){return a("div",{key:e,staticClass:"line-item"})})),0):e._e(),"0"==e.p_model.popup_type?a("div",{staticClass:"text"},[e._v("积分奖励")]):e._e(),"0"==e.p_model.popup_type?a("div",{staticClass:"line"},e._l(10,(function(e){return a("div",{key:e,staticClass:"line-item"})})),0):e._e()]),a("div",{staticClass:"item",class:"0"==e.model.popup_type?"":"newBg"},[a("div",{staticClass:"item-left"},[a("span",{staticClass:"price",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(e.preview_credit.number)+" ")]),a("span",{staticClass:"unit",class:"0"==e.model.popup_type?"":"newBg"},[e._v("积分")])]),a("div",{staticClass:"item-right"},[a("div",{staticClass:"tit",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(e.preview_credit.name)+" ")])])])]):e._e(),new Set(e.model.reward).has("3")?a("div",{staticClass:"other"},[a("div",{staticClass:"other-tit",class:"0"==e.p_model.popup_type?"":"newBg"},["0"==e.p_model.popup_type?a("div",{staticClass:"line"},e._l(10,(function(e){return a("div",{key:e,staticClass:"line-item"})})),0):e._e(),"0"==e.p_model.popup_type?a("div",{staticClass:"text"},[e._v("余额奖励")]):e._e(),"0"==e.p_model.popup_type?a("div",{staticClass:"line"},e._l(10,(function(e){return a("div",{key:e,staticClass:"line-item"})})),0):e._e()]),a("div",{staticClass:"item",class:"0"==e.model.popup_type?"":"newBg"},[a("div",{staticClass:"item-left"},[a("span",{staticClass:"unit",class:"0"==e.model.popup_type?"":"newBg"},[e._v("￥")]),a("span",{staticClass:"price",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(parseFloat(e.preview_balance.number))+" ")])]),a("div",{staticClass:"item-right"},[a("div",{staticClass:"tit",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(e.preview_balance.name)+" ")])])])]):e._e(),new Set(e.model.reward).has("4")?a("div",{staticClass:"other"},[a("div",{staticClass:"other-tit",class:"0"==e.p_model.popup_type?"":"newBg"},["0"==e.model.popup_type?a("div",{staticClass:"line"},e._l(10,(function(e){return a("div",{key:e,staticClass:"line-item"})})),0):e._e(),"0"==e.model.popup_type?a("div",{staticClass:"text"},[e._v("红包奖励")]):e._e(),"0"==e.model.popup_type?a("div",{staticClass:"line"},e._l(10,(function(e){return a("div",{key:e,staticClass:"line-item"})})),0):e._e()]),a("div",{staticClass:"item",class:"0"==e.model.popup_type?"":"newBg"},[a("div",{staticClass:"item-left"},[a("span",{staticClass:"unit",class:"0"==e.model.popup_type?"":"newBg"},[e._v("￥")]),a("span",{staticClass:"price",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(parseFloat(e.preview_redpacket.number))+" ")])]),a("div",{staticClass:"item-right"},[a("div",{staticClass:"tit",class:"0"==e.model.popup_type?"":"newBg"},[e._v(" "+e._s(e.preview_redpacket.name)+" ")])])])]):e._e()])])])])])},s=[]},a0a4:function(e,t,a){"use strict";a.r(t);var i=a("864a"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},a7d8:function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("2909")),n=i(a("5530")),l=i(a("b85c"));a("a9e3"),a("4de4"),a("d3b7"),a("159b"),a("ac1f"),a("841c");var o={name:"CouponSelector",props:{value:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},current:{type:[String,Object]},currentList:{type:Array},limit:{type:Number},pick_way:{type:[String,Number],default:""},params:{type:Object,default:function(){}}},data:function(){var e=this;this.$createElement;return{search:{keyword:"",coupon_sale_type:""},columns:[{title:"类型",key:"coupon_sale_type",width:80,render:function(e,t){return"2"===t.row.coupon_sale_type?e("div",{class:"coupons-type coupons-type-blue"},[e("span",["折"]),e("img",{class:"coupons-img",attrs:{src:a("e7cd")}})]):e("div",{class:"coupons-type coupons-type-yellow"},[e("span",["减"]),e("img",{class:"coupons-img",attrs:{src:a("626b")}})])}},{title:"名称",key:"coupon_name"},{title:"优惠内容",key:"content"},{title:"剩余数量",key:"surplus",render:function(e,t){return"0"==t.row.stock_type?e("div",["不限制"]):e("div",[t.row[t.column.key]])}},{title:"创建时间",key:"created_at",render:function(e,t){return e("div",{style:"word-break: normal"},[t.row[t.column.key]])}},{title:" ",key:"action",width:100,render:function(t,a){return t("div",{class:"action"},[t("Button",{class:"default-primary",attrs:{disabled:1===a.row.is_select},style:{display:a.row.checked?"none":"block"},on:{click:function(){e.setChecked(a.index,!0)}}},["选择"]),t("Button",{attrs:{type:"primary"},style:{display:a.row.checked?"block":"none"},on:{click:function(){e.setChecked(a.index,!1)}}},["已选"])])}}],data:[],total:0,page:{pageSize:10,pageNumber:1},loading:!1,selectRows:[],selectRow:{}}},methods:{handleSearch:function(){this.resetPage(),this.getCouponList()},handlePageChange:function(e){this.page=e,this.getCouponList();try{this.$refs.scrollBox.scrollTop=0}catch(t){console.log(t)}},resetPage:function(){var e;this.page={pageSize:10,pageNumber:1},null===(e=this.$refs["page"])||void 0===e||e.reset()},setChecked:function(e,t){var a=this;if(this.multiple){if(this.limit&&this.selectRows.length===this.limit&&t)return void this.$Message.error("已超出最大可选数量");this.$set(this.data[e],"checked",t),0===this.selectRows.length||t?this.selectRows.push(this.data[e]):this.selectRows=this.selectRows.filter((function(t){return t.id!==a.data[e].id}))}else t?(this.data.forEach((function(e,t){a.$set(a.data[t],"checked",!1)})),this.$set(this.data[e],"checked",!0),this.selectRow=this.data[e]):(this.$set(this.data[e],"checked",!1),this.selectRow={})},defaultChecked:function(){var e=this;this.multiple?this.data.forEach((function(t,a){var i,s=(0,l.default)(e.selectRows);try{for(s.s();!(i=s.n()).done;){var n=i.value;if(n.id===t.id){e.$set(e.data[a],"checked",!0);break}}}catch(o){s.e(o)}finally{s.f()}})):this.data.forEach((function(t,a){e.selectRow&&t.id===e.selectRow.id?e.$set(e.data[a],"checked",!0):e.$set(e.data[a],"checked",!1)}))},getCouponList:function(){var e=this;this.loading=!0;var t=Object.assign({},this.search,{pick_way:this.pick_way});t.coupon_sale_type="all"===t.coupon_sale_type?"":t.coupon_sale_type;var a=Object.assign((0,n.default)({pagesize:this.page.pageSize,page:this.page.pageNumber},this.params),t);this.$api.marketApi.getCouponAllList(a).then((function(t){e.loading=!1,0===t.error&&(e.data=t.list,e.total=t.total,e.defaultChecked())}))},handleSave:function(){this.multiple?this.$emit("on-change",this.selectRows):this.$emit("on-change",this.selectRow),this.handleCancel()},handleCancel:function(){this.$emit("on-cancel")},resetSearch:function(){this.search={keyword:"",coupon_sale_type:"all"}}},watch:{value:{handler:function(e){e&&(this.multiple?this.selectRows=(0,s.default)(this.currentList)||[]:this.selectRow=this.current||{},this.resetSearch(),this.resetPage(),this.getCouponList())},immediate:!0}},mounted:function(){this.resetSearch()}};t.default=o},a9cc:function(e,t,a){},ac9f:function(e,t,a){"use strict";a.r(t);var i=a("9c12"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},aebf:function(e,t,a){"use strict";a.r(t);var i=a("68d8"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},b171:function(e,t,a){},b20d:function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("e9c4"),a("d3b7"),a("159b"),a("a434");var s=i(a("b85c")),n=i(a("2909")),l={name:"levelSelector",props:{currentList:{type:Array,default:function(){return[]}}},data:function(){return{value:!1,selectRows:[],list:[],loading:!1}},methods:{setValue:function(){this.value=!this.value,this.value&&(this.selectRows=(0,n.default)(this.currentList)||[],this.getLabelData())},handleCancel:function(){this.setValue()},handleOk:function(){this.$emit("on-change",JSON.parse(JSON.stringify(this.selectRows))),this.setValue()},initDefaultChecked:function(){var e=this;this.currentList.length>0&&this.list.forEach((function(t,a){var i,n=(0,s.default)(e.selectRows);try{for(n.s();!(i=n.n()).done;){var l=i.value;if(t.id===l.id){e.$set(e.list[a],"checked",!0);break}}}catch(o){n.e(o)}finally{n.f()}}))},setLabelChecked:function(e,t){var a=this;if(this.$set(this.list[e],"checked",t),t)this.selectRows.push(this.list[e]);else{var i=-1;this.selectRows.forEach((function(t,s){t.id===a.list[e].id&&(i=s)})),this.selectRows.splice(i,1)}},getLabelData:function(){var e=this;this.loading=!0,this.$api.memberApi.getLevelList({is_all:1}).then((function(t){e.loading=!1,0===t.error&&(e.list=t.list||[],e.initDefaultChecked())}))}}};t.default=l},bb14:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-modal-frame",{attrs:{value:e.value,title:"优惠券选择器",width:"1000","ok-text":"保存"},on:{"on-ok":e.handleSave,"on-cancel":e.handleCancel}},[a("div",{staticClass:"selector-link-discount-coupon"},[a("div",{ref:"scrollBox",staticClass:"coupon-content"},[a("div",{staticClass:"search"},[a("Input",{staticClass:"width-250",attrs:{search:"","enter-button":"搜索",placeholder:"请输入"},on:{"on-search":e.getCouponList,"on-enter":e.getCouponList},model:{value:e.search.keyword,callback:function(t){e.$set(e.search,"keyword",t)},expression:"search.keyword"}}),a("span",{staticClass:"label"},[e._v("优惠券类型：")]),a("Select",{staticClass:"width-160",on:{"on-change":e.handleSearch},model:{value:e.search.coupon_sale_type,callback:function(t){e.$set(e.search,"coupon_sale_type",t)},expression:"search.coupon_sale_type"}},[a("Option",{attrs:{value:"all"}},[e._v("全部")]),a("Option",{attrs:{value:"1"}},[e._v("满减券")]),a("Option",{attrs:{value:"2"}},[e._v("折扣券")])],1)],1),a("Table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{columns:e.columns,data:e.data}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.total>10,expression:"total>10"}],staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:e.total},on:{"on-change":e.handlePageChange}})],1)])])},s=[]},bf83:function(e,t,a){var i=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("5530")),n=i(a("2909"));a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("d81d"),a("ac1f"),a("1276"),a("a15b"),a("a434"),a("159b"),a("5319"),a("b680"),a("a9e3");var l=i(a("40f7")),o=i(a("416b")),r=i(a("0659")),d=i(a("c35a")),c=i(a("83b0")),u=i(a("88c8")),p=i(a("0d35")),m=a("d1be"),h={components:{Preview:l.default,ShopNamePageList:o.default,GoodsSelector:r.default,LabelSelector:d.default,LevelSelector:c.default,CouponsList:u.default,CouponSelector:p.default},data:function(){var e=this,t=function(t,a,i){""===a?i(new Error("开始时间必选")):(""!==e.model.end_time&&e.$refs.form.validateField("end_time"),i())},a=function(t,a,i){""===a?i(new Error("结束时间必选")):new Date(a).getTime()<=new Date(e.model.start_time).getTime()?i(new Error("结束时间须大于开始时间")):i()},i=function(t,a,i){"1"===e.model.pick_times_type&&""===a?i(new Error("次数必选")):i()},s=function(t,a,i){"2"===e.model.pick_times_type&&""===a?i(new Error("次数必选")):i()};return{model:{title:"",activity_time:"1",start_time:"",end_time:"",client_type:["20"],goods_type:"1",goods_id:[],goods_cate_id:[],member_type:"0",member_info_id:[],member_level_id:[],member_group_id:[],send_type:"0",reward:["1"],coupon_ids:"",credit:"",balance:"",pick_times_type:"0",pick_times_limit:"",pick_times_limit_1:"",pick_times_limit_2:"",red_package:{money:"",expiry:"",blessing:""},popup_type:"0"},rule:{title:[{required:!0,message:"活动名称必填"}],activity_time:[{required:!0,message:""}],start_time:[{validator:t}],end_time:[{validator:a}],client_type:[{required:!0,message:"活动渠道必选"}],goods_type:[{required:!0,message:"指定商品必选"}],goods_id:[{required:!0,message:"不能为空"}],goods_cate_id:[{required:!0,message:"不能为空"}],member_type:[{required:!0,message:"参与资格必选"}],member_info_id:[{required:!0,message:"不能为空"}],send_type:[{required:!0,message:"发放时间节点必选"}],reward:[{required:!0,message:"优惠奖励必选"}],coupon_ids:[{required:!0,message:"优惠券必选"}],credit:[{required:!0,message:"积分必填"}],balance:[{required:!0,message:"余额必填"}],pick_times_type:[{required:!0,message:"领取次数必选"}],pick_times_limit_1:[{validator:i}],pick_times_limit_2:[{validator:s}],"red_package.money":[{required:!0,message:"单个红包金额必填"}],"red_package.expiry":[{required:!0,message:"红包有效时间必填"}],popup_type:[{required:!0,message:"弹窗样式必填"}]},goodsSelector:{value:!1,allowList:[],limitList:[]},selectedGoodsList:[],goodsCateList:[],memberSelector:{levelList:[],labelList:[]},selectedMemberList:[],selector:{value:!1,data:[]},preview_credit:{name:"购物奖励积分",number:"0"},preview_balance:{name:"购物奖励余额",number:"0.00"},preview_redpacket:{name:"购物奖励红包",number:"0.00"},pickTimesList:[],loading:!1,id:"",type:""}},created:function(){this.getGoodsCateList();for(var e=1;e<11;e++)this.pickTimesList.push({value:"".concat(e),label:"".concat(e)});var t=this.$route.query.id,a=this.$route.params.type;this.id=t,this.type=a,this.id&&this.getShoppingRewardDetail()},methods:{getGoodsCateList:function(){var e=this;this.$api.goodsApi.goodClassifyList().then((function(t){0===t.error&&(e.goodsCateList=(0,m.dealClassifyList)(t.list))}))},getShoppingRewardDetail:function(){var e=this;this.$api.shoppingRewardApi.getShoppingRewardDetail({id:this.id}).then((function(t){if(0==t.error){var a,i;if(new Set(["1","2"]).has(t.data.goods_type)&&(e.selectedGoodsList=(0,n.default)(t.data.goods),e.model.goods_id=e.selectedGoodsList.map((function(e){return e.id}))),"1"===t.data.member_type?e.selectedMemberList=(0,n.default)(t.data.member_level):"2"===t.data.member_type&&(e.selectedMemberList=(0,n.default)(t.data.member_group)),e.model.member_info_id=e.selectedMemberList.map((function(e){return e.id})),t.data.reward=null===(a=t.data)||void 0===a?void 0:a.reward.split(","),new Set(t.data.reward).has("1")){e.selector.data=(0,n.default)(t.data.coupon_info);var l=e.selector.data.map((function(e){return e.id}));e.model.coupon_ids=l.join(",")}if(e.model=(0,s.default)((0,s.default)((0,s.default)({},e.model),t.data),{},{client_type:t.data.client_type.split(","),goods_cate_id:"3"===t.data.goods_type?t.data.goods_cate.map((function(e){return e.id})):[],pick_times_limit_1:"1"===t.data.pick_times_type?t.data.pick_times_limit:"",pick_times_limit_2:"2"===t.data.pick_times_type?t.data.pick_times_limit:""}),new Set(t.data.reward).has("4"))e.model.red_package=JSON.parse(null===(i=t.data)||void 0===i?void 0:i.red_package)}}))},changeGoodsLimit:function(){new Set(["1","2"]).has(this.model.goods_type)&&("1"===this.model.goods_type?this.selectedGoodsList=(0,n.default)(this.goodsSelector.allowList):this.selectedGoodsList=(0,n.default)(this.goodsSelector.limitList),this.model.goods_id=this.selectedGoodsList.map((function(e){return e.id})))},addGoods:function(){this.goodsSelector.value=!0},changeGoodsList:function(e){this.selectedGoodsList=(0,n.default)(e),"1"===this.model.goods_type?this.goodsSelector.allowList=(0,n.default)(e):"2"===this.model.goods_type&&(this.goodsSelector.limitList=(0,n.default)(e)),this.model.goods_id=e.map((function(e){return e.id})),this.closeGoodsSelector()},deleteGoods:function(e){this.selectedGoodsList.splice(e,1),"1"===this.model.goods_type?this.goodsSelector.allowList=(0,n.default)(this.selectedGoodsList):"2"===this.model.goods_type&&(this.goodsSelector.limitList=(0,n.default)(this.selectedGoodsList)),this.model.goods_id=this.selectedGoodsList.map((function(e){return e.id}))},closeGoodsSelector:function(){this.goodsSelector.value=!1},handleGoodsCateChange:function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(e)&&e.forEach((function(e){e.children&&e.children.length>0&&(e.indeterminate=e.children.some((function(e){return!0===e.checked})),t(e.children))}))}t(e),this.goodsCateList=e},changeMemberType:function(){new Set(["1","2"]).has(this.model.member_type)&&("1"===this.model.member_type?this.selectedMemberList=(0,n.default)(this.memberSelector.levelList):this.selectedMemberList=(0,n.default)(this.memberSelector.labelList),this.model.member_info_id=this.selectedMemberList.map((function(e){return e.id})))},addMemberInfo:function(){var e=this;"1"===this.model.member_type?(this.selectedMemberList=(0,n.default)(this.memberSelector.levelList),this.$nextTick((function(){e.$refs["level_modal"].setValue()}))):"2"===this.model.member_type&&(this.selectedMemberList=(0,n.default)(this.memberSelector.labelList),this.$nextTick((function(){e.$refs["label_modal"].setValue()})))},changeMemberInfo:function(e){"1"===this.model.member_type?(this.selectedMemberList=(0,n.default)(e),this.memberSelector.levelList=(0,n.default)(e)):"2"===this.model.member_type&&(this.selectedMemberList=(0,n.default)(e),this.memberSelector.labelList=(0,n.default)(e)),this.model.member_info_id=this.selectedMemberList.map((function(e){return e.id}))},deleteMemberInfo:function(e){var t=this,a="";"1"===this.model.member_type?a="是否删除该会员等级":"2"===this.model.member_type&&(a="是否删除该会员标签"),this.$Modal.confirm({title:"提示",content:a,onOk:function(){t.selectedMemberList.splice(e,1),"1"===t.model.member_type?t.memberSelector.levelList=(0,n.default)(t.selectedMemberList):"2"===t.model.member_type&&(t.memberSelector.labelList=(0,n.default)(t.selectedMemberList)),t.model.member_info_id=t.selectedMemberList.map((function(e){return e.id}))},onCancel:function(){}})},showSelector:function(){this.selector.value=!0},cancelSelector:function(){this.selector.value=!1},changeCouponList:function(e){this.selector.data=(0,n.default)(e);var t=this.selector.data.map((function(e){return e.id}));this.model.coupon_ids=t.join(","),this.cancelSelector()},deleteCoupons:function(e){if("add"===this.type){this.selector.data.splice(e,1);var t=this.selector.data.map((function(e){return e.id}));this.model.coupon_ids=t.join(",")}else this.$Message.error("不允许删除")},handleSave:function(){var e=this;this.$refs["form"].validate().then((function(t){t&&(e.loading=!0,e.id?e.editShoppingRewardActivity():e.addShoppingRewardActivity())}))},addShoppingRewardActivity:function(){var e=this,t=this.formatParams();this.$api.shoppingRewardApi.addShoppingRewardActivity((0,s.default)({},t)).then((function(t){e.loading=!1,0==t.error&&(e.$Message.success("保存成功"),e.$router.replace({path:"/shoppingReward/activity/index"}))}))},editShoppingRewardActivity:function(){var e=this,t=this.model.end_time,a={end_time:this.$utils.formatDate(new Date(t),"yyyy-MM-dd hh:mm:ss"),id:this.id};this.$api.shoppingRewardApi.editShoppingRewardActivity((0,s.default)({},a)).then((function(t){e.loading=!1,0==t.error&&(e.$Message.success("保存成功"),e.$router.replace({path:"/shoppingReward/activity/index"}))}))},formatParams:function(){var e=this.model,t=e.title,a=e.start_time,i=e.end_time,s=e.client_type,l=e.goods_type,o=e.goods_id,r=e.goods_cate_id,d=e.member_type,c=e.member_info_id,u=e.send_type,p=e.reward,m=e.coupon_ids,h=e.credit,f=e.balance,_=e.pick_times_type,v=e.pick_times_limit_1,b=e.pick_times_limit_2,g=e.popup_type,y={title:t,popup_type:g,start_time:this.$utils.formatDate(new Date(a),"yyyy-MM-dd hh:mm:ss"),end_time:this.$utils.formatDate(new Date(i),"yyyy-MM-dd hh:mm:ss"),client_type:s.join(","),goods_type:l,member_type:d,send_type:u,reward:p.join(","),pick_times_type:_};return new Set(["1","2"]).has(l)?y["goods_id"]=(0,n.default)(o):new Set(["3"]).has(l)&&(y["goods_cate_id"]=(0,n.default)(r)),"1"===d?y["member_level_id"]=(0,n.default)(c):"2"===d&&(y["member_group_id"]=(0,n.default)(c)),new Set(p).has("1")&&(y["coupon_ids"]=m),new Set(p).has("2")&&(y["credit"]=h),new Set(p).has("3")&&(y["balance"]=Number(f).toFixed(2)),new Set(this.model.reward).has("4")&&(y["red_package"]=this.model.red_package),"1"===_?y["pick_times_limit"]=v:"2"===_&&(y["pick_times_limit"]=b),y}},watch:{"model.credit":{handler:function(e){this.preview_credit.number=parseInt(e)||"0"},immediate:!0},"model.balance":{handler:function(e){this.preview_balance.number=e?parseFloat(e).toFixed(2):"0.00"},immediate:!0},"model.red_package.money":{handler:function(e){this.preview_redpacket.number=e?parseFloat(e).toFixed(2):"0.00"},immediate:!0}}};t.default=h},c35a:function(e,t,a){"use strict";a.r(t);var i=a("8a81"),s=a("1e22");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("546c");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"0360cf99",null);t["default"]=o.exports},cc09:function(e,t,a){"use strict";a("a9cc")},cf30:function(e,t,a){"use strict";a.r(t);var i=a("5a19"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},d1eb:function(e,t,a){"use strict";a.r(t);var i=a("fa4c"),s=a("334d");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("f5bae");var l=a("2877"),o=Object(l["a"])(s["default"],i["a"],i["b"],!1,null,"032375b5",null);t["default"]=o.exports},dad9:function(e,t,a){"use strict";a.r(t);var i=a("bf83"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},e0a0:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-header-bar",{scopedSlots:e._u([{key:"header",fn:function(){return[a("Button",{attrs:{type:"primary"},on:{click:e.addActivity}},[e._v(" +添加活动 ")])]},proxy:!0}])},[a("Form",{ref:"form",attrs:{model:e.model,"label-width":100,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[a("FormItem",{attrs:{label:"活动名称："}},[a("i-input",{staticClass:"width-340",attrs:{type:"text",placeholder:"活动名称"},on:{"on-enter":e.handleSearch},model:{value:e.model.keyword,callback:function(t){e.$set(e.model,"keyword",t)},expression:"model.keyword"}})],1),a("FormItem",{attrs:{label:"活动状态："}},[a("Select",{staticClass:"width-160",model:{value:e.model.status,callback:function(t){e.$set(e.model,"status",t)},expression:"model.status"}},e._l(e.statusList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("FormItem",{attrs:{label:"活动时间："}},[a("DatePicker",{staticClass:"width-340",attrs:{type:"datetimerange",format:"yyyy-MM-dd HH:mm",placeholder:"活动时间"},on:{"on-change":e.changeDate},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),a("div",{staticClass:"ivu-form-item-btn"},[a("Button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)},s=[]},e171:function(e,t,a){"use strict";a("311c")},e627:function(e,t,a){"use strict";a("3bde")},e7cd:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAeBAMAAAD0jNL3AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAPUExURTCI7yyH7y2M7y2N8S2M8GsgvRMAAAAEdFJOUwogoJ8q1PIiAAAAFUlEQVQI12NgYDBkcAFCBQYBBhLZAIgxBI7KasErAAAAAElFTkSuQmCC"},ea96:function(e,t,a){"use strict";a("69a7")},eec44:function(e,t,a){"use strict";a("5c5b")},f5bae:function(e,t,a){"use strict";a("b171")},fa4c:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"activity-wrap"},[a("search-header",{ref:"search_header",on:{"on-search":e.handleSearch}}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-list"},[a("Table",{ref:"table",attrs:{columns:e.columns,data:e.data},scopedSlots:e._u([{key:"date",fn:function(t){var i=t.row;return[a("div",{staticClass:"time"},[a("span",[e._v("起：")]),a("span",[e._v(e._s(i.start_time))])]),a("div",{staticClass:"time"},[a("span",[e._v("止：")]),a("span",[e._v(e._s(i.end_time))])])]}},{key:"send_count",fn:function(t){var i=t.row;return[a("Button",{attrs:{type:"text"},on:{click:function(t){return e.jumpLog(i)}}},[e._v(" "+e._s(i.send_count)+" ")])]}},{key:"status",fn:function(t){var i=t.row;return["1"===i.status?a("kdx-status-text",{attrs:{type:"success"}},[e._v(" 进行中 ")]):e._e(),"-1"===i.status?a("kdx-status-text",{attrs:{type:"danger"}},[e._v(" 停止 ")]):e._e(),"-2"===i.status?a("kdx-status-text",{attrs:{type:"danger"}},[e._v(" 手动停止 ")]):e._e(),"0"===i.status?a("kdx-status-text",{attrs:{type:"warning"}},[e._v(" 未开始 ")]):e._e()]}},{key:"action",fn:function(t){var i=t.row;return[a("div",{staticClass:"btn-box"},[a("Button",{attrs:{type:"text"},on:{click:function(t){return e.handleView(i.id)}}},[e._v(" 查看 ")]),a("Button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(i.id)}}},[e._v(" 编辑 ")]),a("Button",{attrs:{type:"text"},on:{click:function(t){return e.handleStop(i.id)}}},[e._v(" 停止 ")]),a("Button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(i.id)}}},[e._v(" 删除 ")])],1)]}}])}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.data.length>0,expression:"data.length > 0"}],staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:e.total},on:{"on-change":e.changePage}})],1)],1),e._t("default")],2)},s=[]}}]);