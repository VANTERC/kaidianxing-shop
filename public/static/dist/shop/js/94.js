(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[94],{"2d76":function(t,e,i){"use strict";i.r(e);var a=i("6cb3"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},4208:function(t,e,i){"use strict";i.r(e);var a=i("ad29"),n=i("2d76");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("9f6a");var c=i("2877"),o=Object(c["a"])(n["default"],a["a"],a["b"],!1,null,"d1c9896c",null);e["default"]=o.exports},"6cb3":function(t,e,i){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("5530")),s=i("3191"),c=a(i("903f")),o={created:function(){var t=this;this.$store.dispatch("channel/getWechatInfo").then((function(e){var i=e.isIdentifyService;t.isIdentifyService=i}))},components:{WechatEmpty:c.default},watch:{"$route.params.type":{immediate:!0,handler:function(t){console.log(t,"val------"),this.auth=t,this.getSyncLibItems()}}},computed:{noManagePerm:function(){return!this.$getPermMap("channel.wechat.manage")}},methods:{del:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$Modal.confirm({title:"提示",content:"确认删除吗?",onOk:function(){t.$api.homeApi.deleteByMediaId({media_id:e}).then((function(e){0==e.error&&(t.$Message.success("删除成功"),t.resetPage())}))}})},getSyncLibItems:function(){var t=this;this.$api.homeApi.getSyncLibItems((0,n.default)({type:this.auth},this.page)).then((function(e){t.total=e.total,t.list=e.list,t.lastSyncTime=e.last_sync_time||"",console.log(e,"@@@====>>>>")}))},changeThumb:function(){},handlePageChange:function(t){this.page.pagesize=t.pageSize,this.page.page=t.pageNumber,this.getSyncLibItems()},resetPage:function(){var t;this.page={pagesize:10,page:1},null===(t=this.$refs["page"])||void 0===t||t.reset(),this.getSyncLibItems()},syncLib:function(){var t=this;this.loadingTable=!0,this.$api.homeApi.syncLib({type:this.auth}).then((function(e){if(0==e.error){var i=function i(){t.$api.homeApi.syncLibStatus({task_id:e.task_id}).then((function(e){var a,n,s,c="";0==(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.status)?c="":1==(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status)?(c="成功",t.loadingTable=!1):2==(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.status)&&(c="失败",t.loadingTable=!1),""==c?setTimeout((function(){i()}),3e3):(t.resetPage(),t.$Message.success(c))}))};i()}}))},createLib:function(){this.resetPage()}},data:function(){var t=this,e=this.$createElement;return{weixinControl:{isHideMenu:!0,actionApi:{getList:function(){return t.$api.homeApi.getSyncLibItems},uploadFile:function(){return s.homeApi.uploadLib.api},deleteFile:function(){return t.$api.homeApi.deleteByMediaId},getTypeNameByMsgType:function(){return t.auth}}},lastSyncTime:"",dic:{image:"图片",video:"视频",voice:"音频",news:"图文"},isIdentifyService:!1,columns:[{title:"名称",key:"title",render:function(e,i){return e("div",{class:"vp"},[e("video",{attrs:{src:t.$media(i.row.url)}}),i.row.title])}},{title:"状态",key:"status",render:function(){return e("div",["-"])}},{title:"更新时间",key:"created_at"},{title:"操作",render:function(e,i){return e("Button",{class:"del",attrs:{disabled:t.noManagePerm,type:"text"},on:{click:function(){t.del(i.row.media_id)}}},["删除"])}}],data:[],page:{pagesize:10,page:1},total:0,list:[],loading:!1,loadingTable:!1,auth:""}}};e.default=o},7677:function(t,e,i){t.exports=i.p+"static/dist/shop/img/wechat-no-type.png"},"903f":function(t,e,i){"use strict";i.r(e);var a=i("9d65"),n=i("be1b");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("cfef");var c=i("2877"),o=Object(c["a"])(n["default"],a["a"],a["b"],!1,null,"29b9512d",null);e["default"]=o.exports},"9d65":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return n}));var a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wechat-empty"},[a("div",{staticClass:"empty-img"},[a("img",{attrs:{src:i("7677"),alt:""}}),a("div",{staticClass:"text"},[t._v(" 您的公众号类型为未认证服务号，暂不支持本功能 ")])])])}]},"9f6a":function(t,e,i){"use strict";i("ee9c")},a603:function(t,e,i){},ad29:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"fans-label"},[i("kdx-header-bar",{attrs:{type:"little"},scopedSlots:t._u([{key:"header",fn:function(){return[i("div",{staticClass:"header-btn"},["news"!=t.auth?i("kdx-image-video",{key:Math.random(),staticClass:"marginL-10 blk",staticStyle:{"margin-right":"20px"},attrs:{weixinControl:t.weixinControl,desc:"添加微信"+t.dic[t.auth]+"素材",videoName:"添加微信"+t.dic[t.auth]+"素材",type:t.auth,isReadonly:t.noManagePerm},on:{"on-change":t.createLib,"on-video-change":t.createLib}}):t._e(),i("Button",{staticClass:"btn",attrs:{disabled:t.noManagePerm},on:{click:t.syncLib}},[t._v("同步微信"+t._s(t.dic[t.auth])+"素材")])],1)]},proxy:!0}])}),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTable,expression:"loadingTable"}],staticClass:"table-list"},[i("div",{staticClass:"sync-time"},[t._v(" 上次同步时间："),i("span",{staticClass:"time"},[t._v(t._s(t.lastSyncTime||"00-00-00 00:00:00"))])]),i("div",{staticClass:"image-selector-modal"},[i("div",{staticClass:"image-selector-local"},[i("div",{staticClass:"image-content"},[i("div",{ref:"scrollBox",staticClass:"image-list"},["video"!=t.auth&&"news"!=t.auth?i("ul",t._l(t.list,(function(e){return i("li",{key:e.media_id},[["image","voice"].includes(e.type)?i("div",{staticClass:"image"},["image"==e.type?i("img",{attrs:{src:t.$utils.getWechatImg(e.url),alt:""},on:{error:t.replaceImage}}):"voice"==e.type?i("audio",{attrs:{src:t.$media(e.url)}}):t._e(),"voice"==e.type?i("div",{staticClass:"awp"},[t._v(" "+t._s(e.title)+" ")]):t._e(),i("div",{staticClass:"layer"},[t.noManagePerm?t._e():i("Icon",{staticClass:"close",attrs:{type:"ios-close-circle"},on:{click:function(i){return t.del(e.media_id)}}}),i("div",{staticClass:"image-size"},[t._v(" "+t._s(e.created_at)+" ")])],1)]):t._e()])})),0):t._e(),"news"==t.auth?i("div",{staticClass:"msg_sender",staticStyle:{"margin-bottom":"10px"}},[i("div",{staticClass:"ct"},t._l(t.list,(function(e){return i("div",{key:e.media_id,staticClass:"img_msg_wrap"},[i("div",{staticClass:"date"},[t._v("更新于 "+t._s(e.created_at))]),t._l(e.news_item,(function(e,a){return i("div",{key:e.id,staticClass:"lq",class:{im:a>0}},[i("div",{staticStyle:{width:"215px",overflow:"hidden"}},[i("img",{staticClass:"img",attrs:{src:t.$utils.getWechatImg(e.thumb_url)},on:{error:t.replaceImage}})]),i("div",{staticClass:"sub_title"},[t._v(" "+t._s(e.title||"-")+" ")])])})),i("div",{staticClass:"layer"},[i("Icon",{staticClass:"close",attrs:{type:"ios-close-circle"},on:{click:function(i){return t.del(e.media_id)}}})],1)],2)})),0)]):t._e(),"video"==t.auth?i("div",{staticStyle:{"margin-bottom":"10px"}},[i("Table",{attrs:{columns:t.columns,data:t.list}})],1):t._e()])])])]),"video"!=t.auth?i("div",{staticStyle:{"border-top":"1px solid #e9edef"}}):t._e(),i("kdx-page-component",{ref:"page",staticStyle:{"text-align":"center","margin-top":"20px"},attrs:{total:t.total,pageSize:t.page.pagesize},on:{"on-change":t.handlePageChange}})],1),t.isIdentifyService?t._e():i("wechat-empty")],1)},n=[]},be1b:function(t,e,i){"use strict";i.r(e);var a=i("c3d3"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},c3d3:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"WechatEmpty"};e.default=i},cfef:function(t,e,i){"use strict";i("a603")},ee9c:function(t,e,i){}}]);