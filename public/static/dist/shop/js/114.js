(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[114],{"25b9":function(t,e,n){},"50b2":function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("e9c4"),n("b0c0");var a={name:"ImportArticleModal",data:function(){return{value:!1,model:{name:""},rules:{name:[{required:!0,message:"分组名称必填"}]}}},methods:{setValue:function(){console.log(this.value),this.value=!this.value,this.value&&this.resetModel()},handleClose:function(){this.resetModel(),this.setValue()},handleOk:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.addGroup()}))},addGroup:function(){var t=this,e=JSON.stringify([{name:this.model.name,status:1}]);this.$api.articleApi.saveArticleGroup({data:e}).then((function(e){0===e.error&&(t.$emit("success"),t.handleClose())}))},resetModel:function(){this.$refs.form.resetFields()}}};e.default=a},"51b7":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("kdx-Modal-frame",{attrs:{title:"新增分组",width:700},on:{"on-cancel":t.handleClose,"on-ok":t.handleOk},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[n("Form",{ref:"form",staticClass:"import-form",attrs:{model:t.model,rules:t.rules,"label-width":120},nativeOn:{submit:function(t){t.preventDefault()}}},[n("FormItem",{attrs:{label:"分组名称：",prop:"name"}},[n("Input",{staticClass:"width-430",attrs:{maxlength:"4","show-word-limit":"",placeholder:"请输入分组名称"},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}})],1)],1)],1)},i=[]},"5aff":function(t,e,n){"use strict";n.r(e);var a=n("51b7"),i=n("8235");for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("da40");var o=n("2877"),r=Object(o["a"])(i["default"],a["a"],a["b"],!1,null,"0c1e729e",null);e["default"]=r.exports},8235:function(t,e,n){"use strict";n.r(e);var a=n("50b2"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a},9288:function(t,e,n){var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("a434"),n("d81d"),n("d3b7"),n("159b"),n("b0c0"),n("e9c4"),n("a9e3");var i=a(n("aa47")),s=a(n("5aff")),o={components:{addGroupModal:s.default},data:function(){return{load:!1,loading:!1,list:[]}},mounted:function(){var t=this;this.getGroupList().then((function(){t.list.length&&t.initSortable()}))},computed:{noManagePerm:function(){return!this.$getPermMap("article.group.manage")}},methods:{addGroup:function(){this.list.push({name:"",article_count:"0",status:"1"})},initSortable:function(){var t=this;this.$nextTick((function(){var e=t.$refs["draggle"];new i.default(e,{handle:".icon",dataIdAttr:"data-id",onEnd:t.endSortable,animation:150,ghostClass:"blue-background-class"})}))},endSortable:function(t){var e=this.list[t.oldIndex];this.list.splice(t.oldIndex,1),this.list.splice(t.newIndex,0,e);var n=this.list.map((function(t,e){return e})).reverse();this.list.forEach((function(t,e){t.display_order=n[e]}))},handleSave:function(){var t=this,e=!0;if(this.load=!0,this.list.forEach((function(n){if(""==n.name)return t.$Message.error("分组名称不能为空"),e=!1,void setTimeout((function(){t.load=!1}),2e3)})),e){var n=JSON.stringify(this.list);this.$api.articleApi.saveArticleGroup({data:n}).then((function(e){0===e.error&&(t.$Message.success("操作成功"),t.load=!1,t.getGroupList())})).finally((function(){setTimeout((function(){t.load=!1}),2e3)}))}},getGroupList:function(){var t=this;return this.loading=!0,this.$api.articleApi.getGroupList({get_article_count:1}).then((function(e){0===e.error&&(t.list=e.list)})).finally((function(){t.loading=!1}))},handleHide:function(t,e){var n=this,a="确认显示该分组吗？";console.log(e),"1"==e&&(a="确认隐藏该分组吗？"),this.$Modal.confirm({title:"提示",content:a,onOk:function(){n.changeStatus(t,e)},onCancel:function(){}})},changeStatus:function(t,e){var n=this,a=Number(!Number(e));this.$api.articleApi.changeHideArticleGroup({id:t,status:a}).then((function(t){0===t.error&&(n.$Message.success("操作成功"),n.getGroupList())}))},handleDelete:function(t,e){var n=this;this.$Modal.confirm({title:"提示",content:"确认删除该分组吗？",onOk:function(){n.deleteGroup(t,e)},onCancel:function(){}})},deleteGroup:function(t,e){var n=this;t?this.$api.articleApi.deleteArticleGroup({id:t}).then((function(t){0===t.error&&(n.$Message.success("操作成功"),n.getGroupList())})):this.list.splice(e,1)},refreshTable:function(){this.getGroupList()}}};e.default=o},9684:function(t,e,n){"use strict";n.r(e);var a=n("9288"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a},"98cb":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("kdx-content-bar",{scopedSlots:t._u([{key:"btn",fn:function(){return[n("div",{staticClass:"btn-bottom"},[n("Button",{staticClass:"primary-long",attrs:{disabled:t.noManagePerm,loading:t.load},on:{click:t.handleSave}},[t._v("保存")])],1)]},proxy:!0}])},[n("div",{staticClass:"good-classification"},[n("div",{staticClass:"header"},[n("Button",{attrs:{type:"primary",disabled:t.noManagePerm},on:{click:t.addGroup}},[t._v("+添加分组")])],1),n("div",{staticClass:"header-space"}),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content"},[n("div",{staticClass:"table-header"},[n("div",{staticClass:"name"},[t._v("分组名称")]),n("div",{staticClass:"count"},[t._v("专题文章数量")]),n("div",{staticClass:"status"},[t._v("状态")]),n("div",{staticClass:"action"},[t._v("操作")])]),t.list.length>0?n("div",[n("div",{staticClass:"grag-sort-list"},[n("div",{ref:"draggle"},t._l(t.list,(function(e,a){return n("div",{key:e.id},[n("div",{staticClass:"table-content"},[n("div",{staticClass:"icon"},[n("Icon",{attrs:{type:"md-menu"}})],1),n("div",{staticClass:"name"},[n("Input",{attrs:{"show-word-limit":"",maxlength:8},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}})],1),n("div",{staticClass:"count"},[t._v(t._s(e.article_count))]),n("div",{staticClass:"status"},[n("span",{class:{show:1==e.status,hide:1!=e.status}},[t._v(t._s(1==e.status?"显示":"隐藏"))])]),n("div",{staticClass:"action"},[n("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(n){return t.handleHide(e.id,e.status)}}},[t._v(t._s(1==e.status?"隐藏":"显示"))]),n("Button",{attrs:{type:"text",disabled:t.noManagePerm},on:{click:function(n){return t.handleDelete(e.id,a)}}},[t._v("删除")])],1)])])})),0)])]):n("div",[n("div",{staticStyle:{"text-align":"center"}},[t._v(" 暂无数据 ")])])])]),n("add-group-modal",{ref:"groupModal",on:{success:t.getGroupList}})],1)},i=[]},a22d:function(t,e,n){"use strict";n.r(e);var a=n("98cb"),i=n("9684");for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("c126");var o=n("2877"),r=Object(o["a"])(i["default"],a["a"],a["b"],!1,null,"5abeb630",null);e["default"]=r.exports},c126:function(t,e,n){"use strict";n("f1fd")},da40:function(t,e,n){"use strict";n("25b9")},f1fd:function(t,e,n){}}]);