(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[34],{"0021":function(e,t,a){},"02a8":function(e,t,a){"use strict";a("ae06")},"1b8f":function(e,t,a){"use strict";a.r(t);var n=a("a367"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"1d7c":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-temp",class:{has_hover:e.tempHover}},[a("div",{staticClass:"temp-img-content",style:{"background-image":"url("+e.$utils.media(e.info.thumb)+")"}},[a("div",{staticClass:"temp-action flex"},[a("div",{staticClass:"temp-action-btn primary",class:{"temp-action-btn-disabled":e.noManagePerm},on:{click:e.useTemp}},[e._v("使用模板")]),e.delabled?a("div",{staticClass:"temp-action-btn danger",class:{"temp-action-btn-disabled":e.noManagePerm},on:{click:e.delTemp}},[e._v("删除模板")]):e._e()])]),a("div",{staticClass:"temp-detail"},["0"==e.info.type?a("div",{staticClass:"price-tag custom"},[e._v("自定义")]):a("div",{staticClass:"price-tag free"},[e._v("免费使用")]),a("div",{staticClass:"line-hide temp-name"},[e._v(e._s(e.info.name))]),e.showUpdate?a("div",{staticClass:"temp-time"},[e._v("更新时间："+e._s(e.info.created_at))]):e._e()])])},i=[]},"2bbc":function(e,t,a){"use strict";a("0021")},"321b":function(e,t,a){"use strict";a("ec92")},"3248e":function(e,t,a){},"3cae":function(e,t,a){"use strict";a.r(t);var n=a("bb0f"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"4e5e":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadStatus,expression:"loadStatus"}],staticClass:"shop-system-page"},[a("search-header",{on:{"add-page":e.addPage,"on-change":e.handleSearch}}),a("div",{staticClass:"tab-content"},[a("page-list",{ref:"page_list",attrs:{data:e.table.data,total:e.table.total,loading:e.table.loading},on:{"on-preview":e.onPreview,"on-refresh":e.refreshTable,"on-page-change":e.changePage,"on-edit":e.editPage}})],1),a("select-page-type",{ref:"select_page_type",on:{"on-change":e.changeSelectPage}}),a("select-page-temp",{ref:"tempChoose",on:{"on-close":e.tempClose,"on-choose":e.chooseAgain,"on-use":e.useTemp,"on-del":e.delTemp}}),a("Modal",{staticClass:"preview-poster-modal",attrs:{title:"海报预览",styles:{width:"700px"},"mask-closable":!1},model:{value:e.preview,callback:function(t){e.preview=t},expression:"preview"}},[a("img",{staticClass:"poster-phone",attrs:{src:e.$utils.staticImg("decorate/poster-phone.png"),alt:""}}),a("img",{staticClass:"poster-img",attrs:{src:e.previewUrl,alt:""}})]),e._t("default")],2)},i=[]},5727:function(e,t,a){"use strict";a("d993")},"5aee":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={name:"SelectPageType",props:{codeList:{type:Array,default:function(){return["10","20"]}}},data:function(){return{type:"10",value:!1}},watch:{codeList:{handler:function(){this.type=this.codeList[0]},immediate:!0}},methods:{setValue:function(){this.value=!this.value},handleOk:function(){this.$emit("on-change",this.type),this.setValue()},handleCancel:function(){this.setValue()},selectPage:function(e){this.type=e},getPageSet:function(e){var t={10:{src:this.$utils.staticImg("decorate/poster/commission-good-poster1.png"),text:"商品海报",icon:"icon-shangpinleixing-shitishangpin-line"},20:{src:this.$utils.staticImg("decorate/poster/commission-poster1.png"),text:"分销海报",icon:"icon-fenxiao3"}};return t[e]}}};t.default=a},6120:function(e,t,a){"use strict";a("f4dd")},6834:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex page-temp blank-temp"},[a("i",{staticClass:"iconfont icon-tianjiakongbaimoban create-icon"}),a("span",{staticClass:"blank-desc"},[e._v("使用空白模板")])])}],s=(a("2bbc"),a("2877")),o={},c=Object(s["a"])(o,n,i,!1,null,"9d32602c",null);t["default"]=c.exports},"6b14":function(e,t,a){"use strict";a.r(t);var n=a("7a91"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"6cd2":function(e,t,a){"use strict";a.r(t);var n=a("f544"),i=a("3cae");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,null,null);t["default"]=c.exports},"7a91":function(e,t,a){var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("ac1f"),a("841c"),a("d3b7");var i=n(a("6cd2")),s=n(a("a2ff")),o=n(a("b3e8")),c=n(a("f490")),r={name:"index",inject:["returnToTop"],components:{SearchHeader:i.default,PageList:s.default,SelectPageType:o.default,SelectPageTemp:c.default},data:function(){return{tab:{name:"0",data:[]},pageList:{data:[]},table:{data:[],loading:!1,total:0},page:{pageSize:10,pageNumber:1},goodsId:"",tempType:"10",loadStatus:!1,fistLoad:!0,preview:!1,previewUrl:"",search:{keyword:"",type:""}}},methods:{delTemp:function(e){this.$Modal.confirm({title:"提示",content:"确定删除该模板吗?",onOk:function(){console.log(e)},onCancel:function(){}})},onPreview:function(e){this.preview=!0,this.previewUrl=e.previewUrl},editPage:function(e){var t;"10"==e.type?t="/decorate/poster/goodposter":"20"==e.type?t="/decorate/poster/commissionposter":"30"==e.type&&(t="/decorate/poster/followposter"),this.$router.push({path:t,query:{id:e.id,type:"edit"}})},handleSearch:function(e){this.search=e,this.refreshTable()},clickTab:function(){this.refreshTable()},addPage:function(){this.$refs["select_page_type"].setValue()},changeSelectPage:function(e){this.tempType=e,this.$refs.tempChoose.setValue(e)},tempChagne:function(){this.$refs.tempChoose.setValue(this.tempType)},tempClose:function(){this.$refs.tempChoose.setValue(this.tempType)},useTemp:function(e){var t,a=e.id;"10"==this.tempType?t="/decorate/poster/goodposter":"20"==this.tempType?t="/decorate/poster/commissionposter":"30"==this.tempType&&(t="/decorate/poster/followposter"),this.$router.push({path:t,query:{id:a,type:"add"}})},changePage:function(e){this.page=e,this.getList()},refreshTable:function(){this.page={pageSize:10,pageNumber:1},this.$refs["page_list"].reset(),this.getList(),this.getPageTotal()},getList:function(){var e=this;this.returnToTop(),this.fistLoad&&(this.loadStatus=!0),this.table.loading=!0;var t=Object.assign({pagesize:this.page.pageSize,page:this.page.pageNumber},this.search);this.$api.posterApi.posterList(t).then((function(t){var a;(e.table.loading=!1,0===t.error)&&(e.table.data=(null===(a=t.data)||void 0===a?void 0:a.list)||[],e.table.total=t.data.total)})).finally((function(){e.fistLoad=!1,e.loadStatus=!1}))},getPageTotal:function(){var e=this;this.fistLoad&&(this.loadStatus=!0),this.$api.posterApi.usingPosterList().then((function(t){0===t.error&&(e.pageList.data=t.data.list)})).finally((function(){e.fistLoad=!1,e.loadStatus=!1}))},getRanGoodsId:function(){var e=this;this.$api.goodsApi.getGoodsRanId().then((function(t){0===t.error&&(e.goodsId=t.goods_id)}))},chooseAgain:function(){this.$refs.tempChoose.setValue(this.tempType),this.$refs["select_page_type"].setValue()}},mounted:function(){this.getList(),this.getPageTotal()},beforeMount:function(){this.getRanGoodsId()}};t.default=r},"802b":function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("a9e3");var n={name:"PageList",props:{data:{type:Array,default:function(){return[]}},total:{type:Number,default:0},loading:{type:Boolean,default:!1},goodsId:{type:String,default:"0"}},data:function(){var e=this;this.$createElement;return{columns:[{title:"海报名称",key:"name",minWidth:200,render:function(e,t){return e("div",{class:"page-title"},[e("span",{class:"title"},[t.row[t.column.key]]),e("span",{class:"default",style:{display:"1"===t.row.is_default?"inline-block":"none"}},["默认"])])}},{title:"海报类型",key:"type",render:function(e,t){var a;return"10"==t.row.type?a=e("i",{class:"iconfont icon-shangpinleixing-shitishangpin-line"}):"20"==t.row.type?a=e("i",{class:"iconfont icon-fenxiao3"}):"30"==t.row.type&&(a=e("i",{class:"iconfont icon-guanzhu"})),t.row.type_text?e("div",{class:"page-type poster".concat(t.row.type)},[a,e("span",{class:"page-name"},[t.row.type_text])]):e("div",["-"])}},{title:"关键词",key:"keyword"},{title:"扫码数",key:"scans"},{title:"关注数",key:"follows"},{title:"状态",key:"status",render:function(e,t){return"1"==t.row[t.column.key]?e("kdx-tag-label",{attrs:{type:"success"}},["已启用"]):e("kdx-tag-label",{attrs:{type:"disabled"}},["未启用"])}},{title:"操作",key:"action",minWidth:80,render:function(t,a){return t("div",{class:"action"},[t("Button",{attrs:{type:"text"},on:{click:function(){e.operate("check",a)}}},["查看"]),t("Button",{attrs:{type:"text"},on:{click:function(){e.operate("edit",a)}}},["编辑"]),t("Button",{attrs:{type:"text"},on:{click:function(){e.operate("use",a)}}},[0==a.row.status?"启用":"禁用"]),t("Button",{attrs:{type:"text"},on:{click:function(){e.operate("del",a)}}},["删除"])])}}]}},computed:{noManagePerm:function(){return!this.$getPermMap("diypage.page.list.manage")}},methods:{handlePageChange:function(e){this.$emit("on-page-change",e)},editPage:function(e){this.$emit("on-edit",e)},operate:function(e,t){switch(console.log(e,t),e){case"check":this.$emit("on-preview",{previewUrl:this.$utils.media(t.row.thumb)});break;case"edit":this.$emit("on-edit",t.row);break;case"use":this.handleStatusChange(t.row);break;case"del":this.handleDelete(t.row);break}},handleStatusChange:function(e){var t=this,a=e.status,n=null;n=0==a?this.$api.posterApi.enablePoster:this.$api.posterApi.forbiddenPoster,n({id:e.id}).then((function(e){0==e.error&&(t.$Message.success("操作成功"),t.handleRefresh())}))},handleDelete:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确认彻底删除此页面？",onOk:function(){t.$api.posterApi.delPoster({id:e.id}).then((function(e){0===e.error&&(t.$Message.success("该海报删除成功"),t.handleRefresh())}))},onCancel:function(){}})},handleRefresh:function(){this.$emit("on-refresh"),this.reset()},reset:function(){this.$refs["page"].reset()},getPreviewUrl:function(e){var t=e.id,a=e.status,n=e.type,i={};return 0==a?i.previewId=t:"0"===n&&(i.pageId=t),this.$utils.addQueryParams(this.$store.state.setting.wap_url,i)}}};t.default=n},"83fa":function(e,t,a){"use strict";a.r(t);var n=a("4e5e"),i=a("6b14");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("5727"),a("b5c2");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"622eb590",null);t["default"]=c.exports},"8abb":function(e,t,a){"use strict";a("b8f6")},"9c0b":function(e,t,a){"use strict";a.r(t);var n=a("5aee"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"9c8b":function(e,t,a){"use strict";a.r(t);var n=a("802b"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},a2ff:function(e,t,a){"use strict";a.r(t);var n=a("a4b8"),i=a("9c8b");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("6120");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"548c8dad",null);t["default"]=c.exports},a367:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={props:{info:{type:Object,default:function(){}},tempHover:{type:Boolean,default:!1},delabled:{type:Boolean,default:!0},showUpdate:{type:Boolean,default:!0}},computed:{noManagePerm:function(){return!1}},methods:{delTemp:function(){this.$emit("on-delete",this.info)},useTemp:function(){this.$emit("on-use",this.info)}}};t.default=a},a4b8:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"shop-page-list"},[a("Table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{columns:e.columns,data:e.data}}),a("div",{staticClass:"footer-page"},[a("kdx-page-component",{ref:"page",attrs:{total:e.total},on:{"on-change":e.handlePageChange}})],1)],1)},i=[]},ae06:function(e,t,a){},b3e8:function(e,t,a){"use strict";a.r(t);var n=a("d15a"),i=a("9c0b");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("321b");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"2915bcb4",null);t["default"]=c.exports},b5c2:function(e,t,a){"use strict";a("3248e")},b8f6:function(e,t,a){},bb0f:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={name:"SearchHeader",data:function(){return{model:{keyword:"",type:" "},type:[{id:"all",name:"全部"},{id:"10",name:"商品海报"},{id:"20",name:"分销海报"}]}},computed:{noManagePerm:function(){return!this.$getPermMap("poster.manage")}},methods:{changeType:function(){},handleSearch:function(){var e=Object.assign({},this.model);e.type="all"===e.type?"":e.type,this.$emit("on-change",e)},handleReset:function(){this.$emit("on-change",{}),this.reset()},reset:function(){this.model={keyword:"",type:"all"}},addPage:function(){this.$emit("add-page")}},mounted:function(){this.reset()}};t.default=a},cf92:function(e,t,a){var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("d063")),s=n(a("6834")),o={components:{PageTemp:i.default,BlankTemp:s.default},data:function(){return{value:!1,typeList:[{id:"0",name:"我的模板"}],checkType:"0",page:1,total:0,lists:[],tempType:10}},watch:{checkType:function(){this.page=1,this.getList()},value:function(){this.value&&this.getList()}},methods:{getList:function(){var e=this;"0"==this.checkType?this.$api.posterApi.getSysTempList({type:this.tempType,pagesize:10,page:this.page}).then((function(t){var a=t.error,n=t.list,i=t.total;0===a&&(e.page=e.page+1,e.lists=n,e.total=i)})):this.$api.posterApi.getSysTempList({type:this.tempType,pagesize:10,page:this.page}).then((function(t){var a=t.error,n=t.list,i=t.total;0===a&&(e.page=e.page+1,e.lists=n,e.total=i)}))},changeTempList:function(){this.checkType="1"},clickItem:function(e){this.$emit("on-use",e)},delItem:function(e){this.$emit("on-del",e)},handleCancel:function(){this.$emit("on-close")},chooseAgain:function(){this.$emit("on-choose")},pageChange:function(e){this.page=e,this.getList()},setValue:function(e){this.tempType=e,this.page=1,this.value=!this.value}}};t.default=o},d063:function(e,t,a){"use strict";a.r(t);var n=a("1d7c"),i=a("1b8f");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("02a8");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"18c98199",null);t["default"]=c.exports},d15a:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-modal-frame",{attrs:{title:"选择海报类型",width:1e3,"class-name":"select-page-type-modal","ok-text":"确认选择"},on:{"on-cancel":e.handleCancel,"on-ok":e.handleOk},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("div",{staticClass:"select-page-type"},[a("div",{staticClass:"type-content"},e._l(e.codeList,(function(t,n){return a("div",{key:n,staticClass:"type-item",class:{"item-checked":e.type===t},on:{click:function(a){return e.selectPage(t)}}},[e.type===t?a("i",{staticClass:"iconfont icon-yes1 check-icon"}):e._e(),a("div",{staticClass:"type-container"},[a("div",{staticClass:"type-mask"}),a("div",{staticClass:"image"},[a("img",{attrs:{src:e.getPageSet(t).src,alt:""}})]),a("div",{staticClass:"radio",class:{checked:e.type===t}},[a("p",{staticClass:"poster-title"},[a("i",{staticClass:"iconfont page-icon",class:e.getPageSet(t).icon}),a("span",{staticClass:"name"},[e._v(e._s(e.getPageSet(t).text))])])])])])})),0)])])},i=[]},d993:function(e,t,a){},e7c4:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-modal-frame",{staticClass:"select-page-temp",attrs:{width:1e3},on:{"on-cancel":e.handleCancel},scopedSlots:e._u([{key:"header",fn:function(){return[a("div",{staticClass:"flex modal-header"},[a("div",{staticClass:"back",on:{click:e.chooseAgain}},[a("i",{staticClass:"iconfont icon-line-left back-icon"}),a("span",{staticClass:"back-text"},[e._v("返回")])]),a("div",{staticClass:"header-title"},[e._v("选择模板")])])]},proxy:!0},{key:"footer",fn:function(){return[a("div",{staticClass:"modal-footer flex"},[a("Page",{attrs:{total:e.total,"page-size":10,"show-total":"","show-elevator":"",transfer:""},on:{"on-change":e.pageChange}})],1)]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[a("div",{staticClass:"tab-content"},[a("Tabs",{attrs:{animated:!1},model:{value:e.checkType,callback:function(t){e.checkType=t},expression:"checkType"}},e._l(e.typeList,(function(t){return a("TabPane",{key:t.id,attrs:{label:t.name,name:t.id}},[e.lists.length||"0"===e.tempType&&"0"==e.checkType?a("div",{staticClass:"flex temp-content"},[a("div",{staticClass:"flex",staticStyle:{"flex-wrap":"wrap"}},["0"===e.tempType?a("blank-temp",{attrs:{tempHover:""},nativeOn:{click:function(t){return e.clickItem(0)}}}):e._e(),e._l(e.lists,(function(t){return a("page-temp",{key:t.id,attrs:{delabled:!1,info:t,showUpdate:"0"==e.checkType,tempHover:""},on:{"on-use":e.clickItem,"on-delete":e.delItem}})}))],2)]):a("div",{staticClass:"flex temp-content"},[a("div",{staticClass:"empty-data"},[a("i",{staticClass:"iconfont icon-fenxiao-leijiyongjin- empty-icon"}),"1"==e.checkType?a("div",{staticClass:"empty-text"},[e._v("暂无模板")]):a("div",{staticClass:"empty-text"},[e._v(" 暂无可使用的模板 ")])])])])})),1)],1)])},i=[]},ec92:function(e,t,a){},f490:function(e,t,a){"use strict";a.r(t);var n=a("e7c4"),i=a("fc33");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("8abb");var o=a("2877"),c=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"5ca2fbab",null);t["default"]=c.exports},f4dd:function(e,t,a){},f544:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kdx-header-bar",{attrs:{type:"little"},scopedSlots:e._u([{key:"header",fn:function(){return[a("Button",{attrs:{type:"primary",disabled:e.noManagePerm},on:{click:e.addPage}},[e._v("+新建页面")])]},proxy:!0}])},[a("Form",{ref:"form",attrs:{model:e.model,"label-width":100,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[a("FormItem",{attrs:{label:"海报名称："}},[a("Input",{staticClass:"width-250",attrs:{type:"text",placeholder:"海报名称"},on:{"on-enter":e.handleSearch},model:{value:e.model.keyword,callback:function(t){e.$set(e.model,"keyword",t)},expression:"model.keyword"}})],1),a("FormItem",{attrs:{label:"海报类型："}},[a("Select",{staticClass:"width-250",on:{"on-change":e.changeType},model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},e._l(e.type,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1),a("div",{staticClass:"ivu-form-item-btn"},[a("Button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{attrs:{type:"text"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)},i=[]},fc33:function(e,t,a){"use strict";a.r(t);var n=a("cf92"),i=a.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a}}]);